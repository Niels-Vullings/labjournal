<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Niels Vullings" />


<title>Results - Goodness of Fit</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>

<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="tweaks.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Journal
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="cheat_sheet.html">Buddy's first markdown file</a>
    </li>
    <li>
      <a href="Week1.html">Week 1</a>
    </li>
    <li>
      <a href="Week2.html">Week 2</a>
    </li>
    <li>
      <a href="Week3-webscraping.html">Week 3</a>
    </li>
    <li>
      <a href="Week4.html">Week 4</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 5</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="Week5.html">Logic of SAOM</a>
        </li>
        <li>
          <a href="Week5_RSiena.html">RSiena</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="Week6.html">Week 6</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Preparation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Data_exploration.html">Data Exploration</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Data Manipulation</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="Data_preparation.html">Data Prep (Old)</a>
        </li>
        <li>
          <a href="Data_preparation_2.html">Data Prep (New)</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Paper (draft)
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Introduction2-1.html">Introduction</a>
    </li>
    <li>
      <a href="Theory.html">Theory</a>
    </li>
    <li>
      <a href="Data.html">Data</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Results</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="Descriptives.html">Descriptive Results</a>
        </li>
        <li>
          <a href="Siena_Results_final.html">RSiena Models</a>
        </li>
        <li>
          <a href="Siena_GOF.html">RSiena GoF</a>
        </li>
        <li>
          <a href="Siena_Behavior.html">Rsiena Behavior</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="Conclusion.html">Conclusion</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Niels-Vullings/labjournal">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Results - Goodness of Fit</h1>
<h4 class="author">Niels Vullings</h4>

</div>


<div id="load-udf" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Load UDF</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>colorize <span class="ot">&lt;-</span> <span class="cf">function</span>(x, color) {<span class="fu">sprintf</span>(<span class="st">&quot;&lt;span style=&#39;color: %s;&#39;&gt;%s&lt;/span&gt;&quot;</span>, color, x) }</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>fpackage.check <span class="ot">&lt;-</span> <span class="cf">function</span>(packages) {</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="fu">lapply</span>(packages, <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>      <span class="fu">install.packages</span>(x, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>      <span class="fu">library</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    }</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  })</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>}</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>fsave <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">file =</span> <span class="cn">NULL</span>, <span class="at">location =</span> <span class="st">&quot;./results/processed/&quot;</span>) {</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">&quot;results&quot;</span>), <span class="fu">dir.create</span>(<span class="st">&quot;data&quot;</span>), <span class="cn">FALSE</span>)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">&quot;results/processed&quot;</span>), <span class="fu">dir.create</span>(<span class="st">&quot;results/processed&quot;</span>), <span class="cn">FALSE</span>)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(file))</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>    file <span class="ot">=</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(x))</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  datename <span class="ot">&lt;-</span> <span class="fu">substr</span>(<span class="fu">gsub</span>(<span class="st">&quot;[:-]&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">Sys.time</span>()), <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  totalname <span class="ot">&lt;-</span> <span class="fu">paste</span>(location, datename, file, <span class="st">&quot;.rda&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  <span class="fu">save</span>(x, <span class="at">file =</span> totalname)  <span class="co">#need to fix if file is reloaded as input name, not as x. </span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>}</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>fload <span class="ot">&lt;-</span> <span class="cf">function</span>(filename) {</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>  <span class="fu">load</span>(filename)</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>  <span class="fu">get</span>(<span class="fu">ls</span>()[<span class="fu">ls</span>() <span class="sc">!=</span> <span class="st">&quot;filename&quot;</span>])</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>}</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>fshowdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(x, <span class="at">digits =</span> <span class="dv">2</span>, <span class="st">&quot;html&quot;</span>, ...) <span class="sc">%&gt;%</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>, <span class="at">height =</span> <span class="st">&quot;300px&quot;</span>)</span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>}</span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a><span class="co">#---- Extract Simulated Networks ----</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>getNet <span class="ot">&lt;-</span> <span class="cf">function</span>(N, edgeList) { <span class="co"># get simulated network from SIENA</span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a>  </span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a>  <span class="co"># N = number of nodes</span></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a>  </span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a>  <span class="co"># edgeList = edgelist that is returned by siena07(...)$sims</span></span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a>  </span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a>  simNet <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,N)</span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a>  </span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(edgeList)) {</span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a>    </span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a>    simNet[edgeList[i,<span class="dv">1</span>],edgeList[i,<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-45"><a href="#cb1-45" tabindex="-1"></a>    </span>
<span id="cb1-46"><a href="#cb1-46" tabindex="-1"></a>  }</span>
<span id="cb1-47"><a href="#cb1-47" tabindex="-1"></a>  </span>
<span id="cb1-48"><a href="#cb1-48" tabindex="-1"></a>  <span class="fu">return</span>(simNet)</span>
<span id="cb1-49"><a href="#cb1-49" tabindex="-1"></a>  </span>
<span id="cb1-50"><a href="#cb1-50" tabindex="-1"></a>}</span></code></pre></div>
<div id="custom-dyad-triad-census-function" class="section level2"
number="1.1">
<h2><span class="header-section-number">1.1</span> Custom Dyad &amp;
Triad census function</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#---- Dyad census ----</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>ts_dyads_evo <span class="ot">&lt;-</span> <span class="cf">function</span> (sims, net1, <span class="at">simtype =</span> <span class="st">&quot;notypespecified&quot;</span>, <span class="at">forplot =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.list</span>(sims) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    nsims <span class="ot">&lt;-</span> <span class="fu">length</span>(sims)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  }</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    nsims <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  }</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  df <span class="ot">&lt;-</span> foreach<span class="sc">::</span><span class="fu">foreach</span>(<span class="dv">1</span><span class="sc">:</span>nsims, <span class="at">i =</span> iterators<span class="sc">::</span><span class="fu">icount</span>(), </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>                         <span class="at">.combine =</span> <span class="st">&quot;rbind&quot;</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>                           </span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>                           <span class="cf">if</span> (<span class="fu">is.list</span>(sims) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>                             net2 <span class="ot">&lt;-</span> sims[[i]]</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>                             </span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>                           }</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>                           <span class="cf">else</span> {</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>                             net2 <span class="ot">&lt;-</span> sims</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>                           }</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>                           <span class="fu">diag</span>(net1) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>                           <span class="fu">diag</span>(net2) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>                           flips <span class="ot">&lt;-</span> net1 <span class="sc">+</span> <span class="fu">t</span>(net2) <span class="sc">-</span> net2</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>                           jumpst1 <span class="ot">&lt;-</span> net1 <span class="sc">+</span> <span class="fu">t</span>(net1)</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>                           stablet1 <span class="ot">&lt;-</span> jumpst1</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>                           jumpst1[<span class="fu">lower.tri</span>(jumpst1)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>                           jumpst2 <span class="ot">&lt;-</span> net2 <span class="sc">+</span> <span class="fu">t</span>(net2)</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>                           stablet2 <span class="ot">&lt;-</span> jumpst2</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>                           jumpst2[<span class="fu">lower.tri</span>(jumpst2)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>                           stable00 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(jumpst1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> jumpst2 <span class="sc">==</span> </span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>                                                             <span class="dv">0</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>                           stable01 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(flips <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> stablet1 <span class="sc">==</span> </span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>                                                             <span class="dv">1</span> <span class="sc">&amp;</span> stablet2 <span class="sc">==</span> <span class="dv">1</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>                           stable11 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(jumpst1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> jumpst2 <span class="sc">==</span> </span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>                                                             <span class="dv">2</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>                           Null_Assym <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(jumpst1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> stablet2 <span class="sc">==</span> </span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>                                                               <span class="dv">1</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>                           Assym_Null <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(flips <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> stablet1 <span class="sc">==</span> </span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>                                                               <span class="dv">1</span> <span class="sc">&amp;</span> stablet2 <span class="sc">==</span> <span class="dv">0</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a>                           Assym_Mut <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(stablet1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> jumpst2 <span class="sc">==</span> </span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a>                                                              <span class="dv">2</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a>                           Mut_Assym <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(jumpst1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> jumpst2 <span class="sc">==</span> </span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a>                                                              <span class="dv">1</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a>                           flip <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(flips <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> stablet1 <span class="sc">!=</span> </span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a>                                                         <span class="dv">2</span> <span class="sc">&amp;</span> stablet2 <span class="sc">!=</span> <span class="dv">2</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a>                           jump02 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(jumpst1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> jumpst2 <span class="sc">==</span> </span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a>                                                           <span class="dv">2</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a>                           jump20 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(jumpst1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> jumpst2 <span class="sc">==</span> </span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a>                                                           <span class="dv">0</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a>                           table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">nrow</span>(stable00), <span class="fu">nrow</span>(stable01), <span class="fu">nrow</span>(stable11), </span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a>                                          <span class="fu">nrow</span>(Null_Assym), <span class="fu">nrow</span>(Assym_Null), <span class="fu">nrow</span>(Assym_Mut), </span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a>                                          <span class="fu">nrow</span>(Mut_Assym), <span class="fu">nrow</span>(flip), <span class="fu">nrow</span>(jump02), <span class="fu">nrow</span>(jump20))</span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a>                           <span class="fu">colnames</span>(table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Null &gt; Null&quot;</span>, <span class="st">&quot;Assym &gt; Assym&quot;</span>, <span class="st">&quot;Mutual &gt; Mutual&quot;</span>, </span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a>                                                <span class="st">&quot;Null &gt; Assym&quot;</span>, <span class="st">&quot;Assym &gt; Null&quot;</span>, <span class="st">&quot;Assym &gt; Mutual&quot;</span>, <span class="st">&quot;Mutual &gt; Assym&quot;</span>, </span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a>                                                <span class="st">&quot;Tie flip&quot;</span>, <span class="st">&quot;Null &gt; Mutual&quot;</span>, <span class="st">&quot;Mutual &gt; Null&quot;</span>)</span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a>                           simnet <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a>                           <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">simnet =</span> i, table))</span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a>                         }</span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a>  type <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a>  df<span class="sc">$</span>type <span class="ot">&lt;-</span> simtype</span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a>  <span class="cf">if</span> (forplot <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a>    df <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(df, <span class="at">cols =</span> <span class="sc">!</span><span class="fu">c</span>(simnet, type), </span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a>                              <span class="at">names_to =</span> <span class="st">&quot;x&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a>  }</span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a>}</span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a></span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a><span class="co">#---- Triad census ----</span></span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a>ts_triads_evo <span class="ot">&lt;-</span> <span class="cf">function</span> (sims, net1, <span class="at">simtype =</span> <span class="st">&quot;notypespecified&quot;</span>, <span class="at">forplot =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a>  </span>
<span id="cb2-72"><a href="#cb2-72" tabindex="-1"></a>  </span>
<span id="cb2-73"><a href="#cb2-73" tabindex="-1"></a>  x <span class="ot">&lt;-</span> j <span class="ot">&lt;-</span> k <span class="ot">&lt;-</span> a1 <span class="ot">&lt;-</span> a2 <span class="ot">&lt;-</span> a3 <span class="ot">&lt;-</span> tie_change <span class="ot">&lt;-</span> Freq <span class="ot">&lt;-</span> simnet <span class="ot">&lt;-</span> type <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-74"><a href="#cb2-74" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.list</span>(sims) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-75"><a href="#cb2-75" tabindex="-1"></a>    nsims <span class="ot">&lt;-</span> <span class="fu">length</span>(sims)</span>
<span id="cb2-76"><a href="#cb2-76" tabindex="-1"></a>  }</span>
<span id="cb2-77"><a href="#cb2-77" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb2-78"><a href="#cb2-78" tabindex="-1"></a>    nsims <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-79"><a href="#cb2-79" tabindex="-1"></a>  }</span>
<span id="cb2-80"><a href="#cb2-80" tabindex="-1"></a>  df <span class="ot">&lt;-</span> foreach<span class="sc">::</span><span class="fu">foreach</span>(<span class="dv">1</span><span class="sc">:</span>nsims, <span class="at">x =</span> iterators<span class="sc">::</span><span class="fu">icount</span>(),<span class="at">.combine =</span> <span class="st">&quot;rbind&quot;</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb2-81"><a href="#cb2-81" tabindex="-1"></a>    </span>
<span id="cb2-82"><a href="#cb2-82" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.list</span>(sims) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-83"><a href="#cb2-83" tabindex="-1"></a>      net2 <span class="ot">&lt;-</span> sims[[x]]</span>
<span id="cb2-84"><a href="#cb2-84" tabindex="-1"></a>      </span>
<span id="cb2-85"><a href="#cb2-85" tabindex="-1"></a>      <span class="co">#find which values in the matrix are missing</span></span>
<span id="cb2-86"><a href="#cb2-86" tabindex="-1"></a>      N_NA <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(net1) <span class="sc">|</span> <span class="fu">is.na</span>(net2), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) <span class="co"># Identify normal NA values</span></span>
<span id="cb2-87"><a href="#cb2-87" tabindex="-1"></a>      S_NA <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(<span class="fu">which</span>(net1 <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> net2 <span class="sc">==</span> <span class="dv">10</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>])) <span class="co"># Identify Structural NAs</span></span>
<span id="cb2-88"><a href="#cb2-88" tabindex="-1"></a>      S_NA <span class="ot">&lt;-</span> <span class="fu">which</span>(S_NA<span class="sc">$</span>Freq <span class="sc">==</span> <span class="fu">nrow</span>(net1))</span>
<span id="cb2-89"><a href="#cb2-89" tabindex="-1"></a>      NA_rows <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.vector</span>(N_NA), <span class="fu">as.vector</span>(S_NA)) <span class="co"># save all actors in 1 vector</span></span>
<span id="cb2-90"><a href="#cb2-90" tabindex="-1"></a>      </span>
<span id="cb2-91"><a href="#cb2-91" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(NA_rows)<span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb2-92"><a href="#cb2-92" tabindex="-1"></a>        </span>
<span id="cb2-93"><a href="#cb2-93" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="fu">ncol</span>(net1)<span class="sc">-</span> <span class="fu">length</span>(NA_rows),<span class="st">&quot; actors will be analysed due to missing values. Following &quot;</span>, <span class="fu">length</span>(NA_rows), <span class="st">&quot; actors have been listwise deleted: &quot;</span>,<span class="fu">paste</span>(NA_rows, <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>))</span>
<span id="cb2-94"><a href="#cb2-94" tabindex="-1"></a>        <span class="co"># Delete both rows and columns of actors that are missing (NA)</span></span>
<span id="cb2-95"><a href="#cb2-95" tabindex="-1"></a>        net1 <span class="ot">&lt;-</span> net1[<span class="sc">-</span>NA_rows,<span class="sc">-</span>NA_rows]</span>
<span id="cb2-96"><a href="#cb2-96" tabindex="-1"></a>        </span>
<span id="cb2-97"><a href="#cb2-97" tabindex="-1"></a>        net2 <span class="ot">&lt;-</span> net2[<span class="sc">-</span>NA_rows,<span class="sc">-</span>NA_rows]</span>
<span id="cb2-98"><a href="#cb2-98" tabindex="-1"></a>        </span>
<span id="cb2-99"><a href="#cb2-99" tabindex="-1"></a>      }</span>
<span id="cb2-100"><a href="#cb2-100" tabindex="-1"></a>      </span>
<span id="cb2-101"><a href="#cb2-101" tabindex="-1"></a>    }</span>
<span id="cb2-102"><a href="#cb2-102" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb2-103"><a href="#cb2-103" tabindex="-1"></a>      net2 <span class="ot">&lt;-</span> sims</span>
<span id="cb2-104"><a href="#cb2-104" tabindex="-1"></a>      </span>
<span id="cb2-105"><a href="#cb2-105" tabindex="-1"></a>      <span class="co">#find which values in the matrix are missing</span></span>
<span id="cb2-106"><a href="#cb2-106" tabindex="-1"></a>      NA_row <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(net1) <span class="sc">|</span> <span class="fu">is.na</span>(net2), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) </span>
<span id="cb2-107"><a href="#cb2-107" tabindex="-1"></a>      </span>
<span id="cb2-108"><a href="#cb2-108" tabindex="-1"></a>      <span class="co">#find which values in the matrix are missing</span></span>
<span id="cb2-109"><a href="#cb2-109" tabindex="-1"></a>      N_NA <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(net1) <span class="sc">|</span> <span class="fu">is.na</span>(net2), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) <span class="co"># Identify normal NA values</span></span>
<span id="cb2-110"><a href="#cb2-110" tabindex="-1"></a>      S_NA <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(<span class="fu">which</span>(net1 <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> net2 <span class="sc">==</span> <span class="dv">10</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>])) <span class="co"># Identify Structural NAs</span></span>
<span id="cb2-111"><a href="#cb2-111" tabindex="-1"></a>      S_NA <span class="ot">&lt;-</span> <span class="fu">which</span>(S_NA<span class="sc">$</span>Freq <span class="sc">==</span> <span class="fu">nrow</span>(net1))</span>
<span id="cb2-112"><a href="#cb2-112" tabindex="-1"></a>      NA_rows <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.vector</span>(N_NA), <span class="fu">as.vector</span>(S_NA)) <span class="co"># save all actors in 1 vector</span></span>
<span id="cb2-113"><a href="#cb2-113" tabindex="-1"></a>      </span>
<span id="cb2-114"><a href="#cb2-114" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(NA_rows)<span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb2-115"><a href="#cb2-115" tabindex="-1"></a>        </span>
<span id="cb2-116"><a href="#cb2-116" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="fu">ncol</span>(net1)<span class="sc">-</span> <span class="fu">length</span>(NA_rows),<span class="st">&quot; actors will be analysed due to missing values. Following &quot;</span>, <span class="fu">length</span>(NA_rows), <span class="st">&quot; actors have been listwise deleted: &quot;</span>,<span class="fu">paste</span>(NA_rows, <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>))</span>
<span id="cb2-117"><a href="#cb2-117" tabindex="-1"></a>        <span class="co"># Delete both rows and columns of actors that are missing (NA)</span></span>
<span id="cb2-118"><a href="#cb2-118" tabindex="-1"></a>        net1 <span class="ot">&lt;-</span> net1[<span class="sc">-</span>NA_rows,<span class="sc">-</span>NA_rows]</span>
<span id="cb2-119"><a href="#cb2-119" tabindex="-1"></a>        </span>
<span id="cb2-120"><a href="#cb2-120" tabindex="-1"></a>        net2 <span class="ot">&lt;-</span> net2[<span class="sc">-</span>NA_rows,<span class="sc">-</span>NA_rows]</span>
<span id="cb2-121"><a href="#cb2-121" tabindex="-1"></a>        </span>
<span id="cb2-122"><a href="#cb2-122" tabindex="-1"></a>      }</span>
<span id="cb2-123"><a href="#cb2-123" tabindex="-1"></a>    }</span>
<span id="cb2-124"><a href="#cb2-124" tabindex="-1"></a>    </span>
<span id="cb2-125"><a href="#cb2-125" tabindex="-1"></a>    triads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X003&quot;</span>, <span class="st">&quot;X012&quot;</span>, <span class="st">&quot;X102&quot;</span>, <span class="st">&quot;X021D&quot;</span>, <span class="st">&quot;X021U&quot;</span>, </span>
<span id="cb2-126"><a href="#cb2-126" tabindex="-1"></a>                <span class="st">&quot;X021C&quot;</span>, <span class="st">&quot;X111D&quot;</span>, <span class="st">&quot;X111U&quot;</span>, <span class="st">&quot;X030T&quot;</span>, <span class="st">&quot;X030C&quot;</span>, <span class="st">&quot;X201&quot;</span>, </span>
<span id="cb2-127"><a href="#cb2-127" tabindex="-1"></a>                <span class="st">&quot;X120D&quot;</span>, <span class="st">&quot;X120U&quot;</span>, <span class="st">&quot;X120C&quot;</span>, <span class="st">&quot;X210&quot;</span>, <span class="st">&quot;X300&quot;</span>)</span>
<span id="cb2-128"><a href="#cb2-128" tabindex="-1"></a>    </span>
<span id="cb2-129"><a href="#cb2-129" tabindex="-1"></a>    df <span class="ot">&lt;-</span> foreach<span class="sc">::</span><span class="fu">foreach</span>(<span class="at">a1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(net1), <span class="at">i =</span> iterators<span class="sc">::</span><span class="fu">icount</span>(),<span class="at">.combine =</span> <span class="st">&quot;rbind&quot;</span>) <span class="sc">%:%</span> </span>
<span id="cb2-130"><a href="#cb2-130" tabindex="-1"></a>      foreach<span class="sc">::</span><span class="fu">foreach</span>(<span class="at">a2 =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(net1), <span class="at">j =</span> iterators<span class="sc">::</span><span class="fu">icount</span>(), <span class="at">.combine =</span> <span class="st">&quot;rbind&quot;</span>) <span class="sc">%:%</span> </span>
<span id="cb2-131"><a href="#cb2-131" tabindex="-1"></a>      foreach<span class="sc">::</span><span class="fu">foreach</span>(<span class="at">a3 =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(net1), <span class="at">k =</span> iterators<span class="sc">::</span><span class="fu">icount</span>(),<span class="at">.combine =</span> <span class="st">&quot;rbind&quot;</span>) <span class="sc">%do%</span> {</span>
<span id="cb2-132"><a href="#cb2-132" tabindex="-1"></a>        <span class="cf">if</span> (i <span class="sc">&gt;</span> j <span class="sc">&amp;</span> j <span class="sc">&gt;</span> k) {</span>
<span id="cb2-133"><a href="#cb2-133" tabindex="-1"></a>          <span class="fu">data.frame</span>(<span class="at">i =</span> i, <span class="at">j =</span> j, <span class="at">k =</span> k, </span>
<span id="cb2-134"><a href="#cb2-134" tabindex="-1"></a>                     <span class="at">t1_ij =</span> <span class="fu">as.character</span>(net1[a1,a2]), <span class="at">t1_ji =</span> <span class="fu">as.character</span>(net1[a2, a1]), </span>
<span id="cb2-135"><a href="#cb2-135" tabindex="-1"></a>                     <span class="at">t1_ik =</span> <span class="fu">as.character</span>(net1[a1,a3]), <span class="at">t1_ki =</span> <span class="fu">as.character</span>(net1[a3, a1]), </span>
<span id="cb2-136"><a href="#cb2-136" tabindex="-1"></a>                     <span class="at">t1_jk =</span> <span class="fu">as.character</span>(net1[a2,a3]), <span class="at">t1_kj =</span> <span class="fu">as.character</span>(net1[a3, a2]), </span>
<span id="cb2-137"><a href="#cb2-137" tabindex="-1"></a>                     <span class="at">typeT1 =</span> triads[<span class="fu">which</span>(sna<span class="sc">::</span><span class="fu">triad.census</span>(net1[<span class="fu">c</span>(a1,a2, a3), <span class="fu">c</span>(a1, a2, a3)]) <span class="sc">==</span> <span class="dv">1</span>)], </span>
<span id="cb2-138"><a href="#cb2-138" tabindex="-1"></a>                     <span class="at">t2_ij =</span> <span class="fu">as.character</span>(net2[a1, a2]), <span class="at">t2_ji =</span> <span class="fu">as.character</span>(net2[a2, a1]), </span>
<span id="cb2-139"><a href="#cb2-139" tabindex="-1"></a>                     <span class="at">t2_ik =</span> <span class="fu">as.character</span>(net2[a1, a3]), <span class="at">t2_ki =</span> <span class="fu">as.character</span>(net2[a3, a1]), </span>
<span id="cb2-140"><a href="#cb2-140" tabindex="-1"></a>                     <span class="at">t2_jk =</span> <span class="fu">as.character</span>(net2[a2, a3]), <span class="at">t2_kj =</span> <span class="fu">as.character</span>(net2[a3, a2]), </span>
<span id="cb2-141"><a href="#cb2-141" tabindex="-1"></a>                     <span class="at">typeT2 =</span> triads[<span class="fu">which</span>(sna<span class="sc">::</span><span class="fu">triad.census</span>(net2[<span class="fu">c</span>(a1, a2, a3), <span class="fu">c</span>(a1, a2, a3)]) <span class="sc">==</span> <span class="dv">1</span>)], </span>
<span id="cb2-142"><a href="#cb2-142" tabindex="-1"></a>                     <span class="at">tie_change =</span> <span class="fu">sum</span>(<span class="fu">c</span>(net1[a1, a2], net1[a2, a1], net1[a1, a3], net1[a3, a1], net1[a2, a3], net1[a3, a2]) <span class="sc">!=</span> <span class="fu">c</span>(net2[a1, a2], net2[a2, a1], net2[a1, a3], net2[a3, a1], net2[a2, a3], net2[a3, a2])))</span>
<span id="cb2-143"><a href="#cb2-143" tabindex="-1"></a>        }</span>
<span id="cb2-144"><a href="#cb2-144" tabindex="-1"></a>      }</span>
<span id="cb2-145"><a href="#cb2-145" tabindex="-1"></a>    </span>
<span id="cb2-146"><a href="#cb2-146" tabindex="-1"></a>    </span>
<span id="cb2-147"><a href="#cb2-147" tabindex="-1"></a>    df<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(df<span class="sc">$</span>i, <span class="st">&quot;.&quot;</span>, df<span class="sc">$</span>j, <span class="st">&quot;.&quot;</span>, df<span class="sc">$</span>k)</span>
<span id="cb2-148"><a href="#cb2-148" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">subset</span>(df, <span class="at">select =</span> <span class="fu">c</span>(tie_change))</span>
<span id="cb2-149"><a href="#cb2-149" tabindex="-1"></a>    </span>
<span id="cb2-150"><a href="#cb2-150" tabindex="-1"></a>    <span class="co">#---- !!NEW!! Assign levels to counter missing columns ----</span></span>
<span id="cb2-151"><a href="#cb2-151" tabindex="-1"></a>    df<span class="sc">$</span>tie_change <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>tie_change)</span>
<span id="cb2-152"><a href="#cb2-152" tabindex="-1"></a>    <span class="fu">levels</span>(df<span class="sc">$</span>tie_change) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>,<span class="st">&quot;6&quot;</span>)</span>
<span id="cb2-153"><a href="#cb2-153" tabindex="-1"></a>    <span class="co">#---- Fixes issues with simulated networks ----</span></span>
<span id="cb2-154"><a href="#cb2-154" tabindex="-1"></a>    </span>
<span id="cb2-155"><a href="#cb2-155" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">simnet =</span> x, <span class="fu">table</span>(df))</span>
<span id="cb2-156"><a href="#cb2-156" tabindex="-1"></a>    df <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(df, <span class="at">names_from =</span> tie_change,</span>
<span id="cb2-157"><a href="#cb2-157" tabindex="-1"></a>                             <span class="at">values_from =</span> Freq)</span>
<span id="cb2-158"><a href="#cb2-158" tabindex="-1"></a>    </span>
<span id="cb2-159"><a href="#cb2-159" tabindex="-1"></a>  }</span>
<span id="cb2-160"><a href="#cb2-160" tabindex="-1"></a>  </span>
<span id="cb2-161"><a href="#cb2-161" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb2-162"><a href="#cb2-162" tabindex="-1"></a>  df<span class="sc">$</span>type <span class="ot">&lt;-</span> simtype</span>
<span id="cb2-163"><a href="#cb2-163" tabindex="-1"></a>  </span>
<span id="cb2-164"><a href="#cb2-164" tabindex="-1"></a>  <span class="cf">if</span> (forplot <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-165"><a href="#cb2-165" tabindex="-1"></a>    df <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(df, <span class="at">cols =</span> <span class="sc">!</span><span class="fu">c</span>(simnet, type), </span>
<span id="cb2-166"><a href="#cb2-166" tabindex="-1"></a>                              <span class="at">names_to =</span> <span class="st">&quot;x&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb2-167"><a href="#cb2-167" tabindex="-1"></a>  }</span>
<span id="cb2-168"><a href="#cb2-168" tabindex="-1"></a>  </span>
<span id="cb2-169"><a href="#cb2-169" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb2-170"><a href="#cb2-170" tabindex="-1"></a>  </span>
<span id="cb2-171"><a href="#cb2-171" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="load-packages" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Load Packages</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;tidyverse&quot;</span>, <span class="st">&quot;sna&quot;</span>, <span class="st">&quot;igraph&quot;</span>, <span class="st">&quot;RSiena&quot;</span>, <span class="st">&quot;iterators&quot;</span>, <span class="st">&quot;doParallel&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">fpackage.check</span>(packages)</span></code></pre></div>
</div>
<div id="set-up-parallel-cluster" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Set up parallel
cluster</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>no_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>mycl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="fu">rep</span>(<span class="st">&quot;localhost&quot;</span>, no_cores))</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(mycl, <span class="fu">library</span>(RsienaTwoStep))</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">registerDoParallel</span>(mycl)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co"># stopCluster(mycl)</span></span></code></pre></div>
<hr />
</div>
<div id="load-data" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Load Data</h1>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>df_ego <span class="ot">&lt;-</span> <span class="fu">fload</span>(<span class="st">&quot;./data/processed/RU_UU_ego.RData&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>soc_data <span class="ot">&lt;-</span> <span class="fu">fload</span>(<span class="st">&quot;./data/processed/soc_data_raw.RData&quot;</span>)</span></code></pre></div>
<div id="extract-networks-for-better-memory-usage"
class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Extract networks for
better memory usage</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>wave_1 <span class="ot">&lt;-</span> soc_data<span class="sc">$</span>nets[<span class="dv">1</span>,,]</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>wave_2 <span class="ot">&lt;-</span> soc_data<span class="sc">$</span>nets[<span class="dv">2</span>,,]</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">rm</span>(soc_data)</span></code></pre></div>
</div>
</div>
<div id="load-models" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Load Models</h1>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>ans_M0 <span class="ot">&lt;-</span> <span class="fu">fload</span>(<span class="st">&quot;./results/processed/20241024-ans_M0.rda&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>ans_M1 <span class="ot">&lt;-</span> <span class="fu">fload</span>(<span class="st">&quot;./results/processed/20241024-ans_M1_2.rda&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>ans_M2 <span class="ot">&lt;-</span> <span class="fu">fload</span>(<span class="st">&quot;./results/processed/20241024-ans_M2_2.rda&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>ans_M2<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">fload</span>(<span class="st">&quot;./results/processed/20241024-ans_M2.5.rda&quot;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>ans_M3 <span class="ot">&lt;-</span> <span class="fu">fload</span>(<span class="st">&quot;./results/processed/20241029-ans_M3.rda&quot;</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>ans_M4 <span class="ot">&lt;-</span> <span class="fu">fload</span>(<span class="st">&quot;./results/processed/20241024-ans_M4.rda&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>ans_M5 <span class="ot">&lt;-</span> <span class="fu">fload</span>(<span class="st">&quot;./results/processed/20241029-ans_M5.rda&quot;</span>)</span></code></pre></div>
</div>
<div id="rsiena---goodness-of-fit" class="section level1 tabset"
number="6">
<h1 class="tabset"><span class="header-section-number">6</span> RSiena -
Goodness of Fit</h1>
<p>Apart from the convergence of the model and the significance of the
estimates, the Goodness of Fit plays a critical role in assessing
whether a model estimated in RSiena is representative of the observed
data. As RSiena is a method that uses simulation, it is important to
check whether the structure of the simulated networks resembles the
changes visible in the observed network <span class="citation">(Ripley
et al. 2011)</span>. While many auxiliary functions are available to
test the Goodness of fit of a model, I chose to use two types: the
distribution of indegrees and a dyad evolution census. The indegree
distribution is available in RSiena and measures the extent to which the
simulated networks follow the indegree distribution of the observed
network. The dyad evolution census is function that is written by
myself, as part of the RsienaTwoStep-project <span
class="citation">(Tolsma 2024)</span>. Using the R package ggplot2, it
is create a Goodness of Fit plot for this census. The grey violinplot is
the distribution of the simulated networks for a specific triad
transition from wave 1 to wave 2. The red point including the tails is
the mean of the simulated network census including the confidence
intervals (<span class="math inline">\(\mu \pm 1.96* \sigma\)</span>).
The green point is the observed value for a specific transition.
Logically, the closer the red and green points are to each other, the
better this transition was estimated in the simulations. When the green
point is within the tails, it is significant for a alpha of 0.05. Below
I will assess the Goodness of Fit of each model and its consequences for
the results.</p>
<div id="model-0" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Model 0</h2>
<p>The Goodness of Fit for the indegree distribution is 0, indicating
very a significant deviation between the expected and observed indegree
distribution. The amount of actors with 0 or 1 observed indegrees is
(severly) underestimated. The amount of actors with 2 indegrees is quite
accurately estimated. Actors with 3 or more indegrees are all
overestimated. Given the fact that this model does not include any
structural effects apart from the standard network statistics in RSiena,
this makes sense.<br />
 Regarding the dyad census, most observed transitions are within 1.96
the standard deviation of the simulated networks. However, the
transition <em>Null &gt; Assym</em> and <em>Assym &gt; Null</em> are
in the lower bounds of the distribution, which indicates that there is
room for improvement. The observed transitions for stable mutual
dyads<em>Mutual &gt; Mutual</em> is overestimated, while the
transition <em>Mutual &gt; Assym</em> and <em>Tie flips</em> are
both underestimated in this model.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>simNets <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  simNets[[i]] <span class="ot">=</span> <span class="fu">getNet</span>(<span class="dv">100</span>, ans_M0<span class="sc">$</span>sims[[i]][[<span class="st">&quot;Data1&quot;</span>]][[<span class="st">&quot;net&quot;</span>]][[<span class="st">&quot;1&quot;</span>]])</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  </span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>GOF_M0 <span class="ot">&lt;-</span> <span class="fu">sienaGOF</span>(ans_M0, IndegreeDistribution, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">join =</span> <span class="cn">TRUE</span>, <span class="at">varName =</span> <span class="st">&quot;net&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">plot</span>(GOF_M0, <span class="at">main =</span> <span class="st">&quot;Indegree Distribution Model 0&quot;</span>)</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>GOF_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(simNets, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(simnet) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y))</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>OBS_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(wave_2, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y,stand)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>GOF_plot_M0 <span class="ot">&lt;-</span> GOF_dyads <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(OBS_dyads, <span class="at">by =</span> <span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>p_M0 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(GOF_plot_M0, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.x) ) <span class="sc">+</span> </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>               <span class="at">fun.max =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x),</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>               <span class="at">fun.min =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x),</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>               <span class="at">width=</span>.<span class="dv">1</span>,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  <span class="fu">stat_summary</span>( <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.y), <span class="at">fun =</span> mean,</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Dyad Census&quot;</span>, <span class="at">y =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>  <span class="co"># scale_x_discrete(guide = guide_axis(n.dodge = 2)) +</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,  <span class="at">vjust =</span> <span class="fl">0.5</span>,)) <span class="sc">+</span>   </span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>p_M0</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-12-1.png" width="864" /></p>
</div>
<div id="model-1" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Model 1</h2>
<p>Model 1, which includes the structural effects, has a Goodness of Fit
- value for the indegree distribution of 0.016. The inclusion of the
IsolateNet statistic decreased the overestimation of the isolates, but
the amount of actors with 0 indegrees is still underestimated. The
amount of actors with 1 indegrees is similarly underestimated, while
actors with 2 or more indegrees is overestimated. The GOF of the dyad
census is similar to the GOF of Model 0, indicating the not much changed
between these models, which is also visible by the small increase in the
p-value of the indegree distribution plot.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>simNets <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  simNets[[i]] <span class="ot">=</span> <span class="fu">getNet</span>(<span class="dv">100</span>, ans_M1<span class="sc">$</span>sims[[i]][[<span class="st">&quot;Data1&quot;</span>]][[<span class="st">&quot;net&quot;</span>]][[<span class="st">&quot;1&quot;</span>]])</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  </span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>GOF_M1 <span class="ot">&lt;-</span> <span class="fu">sienaGOF</span>(ans_M1, IndegreeDistribution, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">join =</span> <span class="cn">TRUE</span>, <span class="at">varName =</span> <span class="st">&quot;net&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">plot</span>(GOF_M1, <span class="at">main =</span> <span class="st">&quot;Indegree Distribution Model 1&quot;</span>)</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>GOF_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(simNets, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(simnet) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y))</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>OBS_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(wave_2, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y,stand)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>GOF_plot_M1 <span class="ot">&lt;-</span> GOF_dyads <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(OBS_dyads, <span class="at">by =</span> <span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>p_M1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(GOF_plot_M1, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.x) ) <span class="sc">+</span> </span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>               <span class="at">fun.max =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x),</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>               <span class="at">fun.min =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x),</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>               <span class="at">width=</span>.<span class="dv">1</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>  <span class="fu">stat_summary</span>( <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.y, <span class="at">group =</span> <span class="dv">1</span>), <span class="at">fun =</span> mean,</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Dyad Census&quot;</span>, <span class="at">y =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>  <span class="co"># scale_x_discrete(guide = guide_axis(n.dodge = 2)) +</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">60</span>,  <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span>   </span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>p_M1</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-16-1.png" width="864" /></p>
</div>
<div id="model-2" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Model 2</h2>
<p>Model 2 shows some increase in the p-value of the indegree
distribution (p = 0.184), indicating that the GOF is improving. This is
mainly visible for actors with 2 or more indegrees, who are not as
overestimated as in the previous models. The GOF for the dyad census is
similar to the other models in terms of the differences between the
observed and expected transitions. However, the violin plots are getting
smaller, indicating there there is less variability between the
simulations.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>simNets <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  </span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  simNets[[i]] <span class="ot">=</span> <span class="fu">getNet</span>(<span class="dv">100</span>, ans_M2<span class="sc">$</span>sims[[i]][[<span class="st">&quot;Data1&quot;</span>]][[<span class="st">&quot;net&quot;</span>]][[<span class="st">&quot;1&quot;</span>]])</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  </span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>GOF_M2 <span class="ot">&lt;-</span> <span class="fu">sienaGOF</span>(ans_M2, IndegreeDistribution, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">join =</span> <span class="cn">TRUE</span>, <span class="at">varName =</span> <span class="st">&quot;net&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">plot</span>(GOF_M2, <span class="at">main =</span> <span class="st">&quot;Indegree Distribution Model 2&quot;</span>)</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>GOF_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(simNets, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(simnet) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y))</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>OBS_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(wave_2, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y,stand)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>GOF_plot_M2 <span class="ot">&lt;-</span> GOF_dyads <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(OBS_dyads, <span class="at">by =</span> <span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>p_M2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(GOF_plot_M2, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.x) ) <span class="sc">+</span> </span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>               <span class="at">fun.max =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x),</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>               <span class="at">fun.min =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x),</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>               <span class="at">width=</span>.<span class="dv">1</span>,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>  <span class="fu">stat_summary</span>( <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.y), <span class="at">fun =</span> mean,</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Dyad Census&quot;</span>, <span class="at">y =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>  <span class="co"># scale_x_discrete(guide = guide_axis(n.dodge = 2)) +</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,  <span class="at">vjust =</span> <span class="fl">0.5</span>,)) <span class="sc">+</span>   </span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>p_M2</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-20-1.png" width="864" /></p>
</div>
<div id="model-2.5" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Model 2.5</h2>
<p>As stated in the result section, Model 2.5 has a significant increase
in the GOF, due to the indegree popularity squared parameter, which is
known to have a better fit than the normal version <span
class="citation">(Ripley et al. 2011)</span>. This model has a p-value
of 0.891 for the indegree distribution, with all actors with 1 or more
indegrees being estimated correctly (or at least within Q1-Q3). The only
exception are the isolates, which are still underestimated. However, it
should be noted that the difference between the observed and expected
isolates is much lower than the previous models.<br />
 Model 2.5 is less accurate with regard to the GOF of the dyad census.
Apart from the transition <em>Assym &gt; Assym</em> and <em>Mutual
&gt; Null</em>, all observed dyadic transitions are not within 1
standard deviation of the simulated transitions. The model is
particularly bad at estimating the transition from <em>Assym &gt;
Null</em> and <em>Null &gt; Assym,</em> which are both overestimated
compared to the observed transistions<em>.</em></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>simNets <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  </span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  simNets[[i]] <span class="ot">=</span> <span class="fu">getNet</span>(<span class="dv">100</span>, ans_M2<span class="fl">.5</span><span class="sc">$</span>sims[[i]][[<span class="st">&quot;Data1&quot;</span>]][[<span class="st">&quot;net&quot;</span>]][[<span class="st">&quot;1&quot;</span>]])</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  </span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>GOF_M2<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">sienaGOF</span>(ans_M2<span class="fl">.5</span>, IndegreeDistribution, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">join =</span> <span class="cn">TRUE</span>, <span class="at">varName =</span> <span class="st">&quot;net&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">plot</span>(GOF_M2<span class="fl">.5</span>, <span class="at">main =</span> <span class="st">&quot;Indegree Distribution Model 2.5&quot;</span>)</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>GOF_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(simNets, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(simnet) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y))</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>OBS_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(wave_2, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y,stand)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>GOF_plot_M2<span class="fl">.5</span> <span class="ot">&lt;-</span> GOF_dyads <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(OBS_dyads, <span class="at">by =</span> <span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>p_M2<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(GOF_plot_M2<span class="fl">.5</span>, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.x) ) <span class="sc">+</span> </span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>               <span class="at">fun.max =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x),</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>               <span class="at">fun.min =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x),</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>               <span class="at">width=</span>.<span class="dv">1</span>,</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>  <span class="fu">stat_summary</span>( <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.y), <span class="at">fun =</span> mean,</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Dyad Census&quot;</span>, <span class="at">y =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>  <span class="co"># scale_x_discrete(guide = guide_axis(n.dodge = 2)) +</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,  <span class="at">vjust =</span> <span class="fl">0.5</span>,)) <span class="sc">+</span>   </span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a>p_M2<span class="fl">.5</span></span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-24-1.png" width="864" /></p>
</div>
<div id="model-3" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Model 3</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>simNets <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  </span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  simNets[[i]] <span class="ot">=</span> <span class="fu">getNet</span>(<span class="dv">100</span>, ans_M3<span class="sc">$</span>sims[[i]][[<span class="st">&quot;Data1&quot;</span>]][[<span class="st">&quot;net&quot;</span>]][[<span class="st">&quot;1&quot;</span>]])</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  </span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>GOF_M3 <span class="ot">&lt;-</span> <span class="fu">sienaGOF</span>(ans_M3, IndegreeDistribution, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">join =</span> <span class="cn">TRUE</span>, <span class="at">varName =</span> <span class="st">&quot;net&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="fu">plot</span>(GOF_M3, <span class="at">main =</span> <span class="st">&quot;Indegree Distribution Model 3&quot;</span>)</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>GOF_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(simNets, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(simnet) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y))</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>OBS_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(wave_2, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y,stand)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>GOF_plot_M3 <span class="ot">&lt;-</span> GOF_dyads <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(OBS_dyads, <span class="at">by =</span> <span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>p_M3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(GOF_plot_M3, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.x) ) <span class="sc">+</span> </span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>               <span class="at">fun.max =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x),</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>               <span class="at">fun.min =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x),</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>               <span class="at">width=</span>.<span class="dv">1</span>,</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>  <span class="fu">stat_summary</span>( <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.y), <span class="at">fun =</span> mean,</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Dyad Census&quot;</span>, <span class="at">y =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>  <span class="co"># scale_x_discrete(guide = guide_axis(n.dodge = 2)) +</span></span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>,)) <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a>p_M3</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-28-1.png" width="864" /></p>
</div>
<div id="model-4" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Model 4</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>simNets <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  </span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  simNets[[i]] <span class="ot">=</span> <span class="fu">getNet</span>(<span class="dv">100</span>, ans_M4<span class="sc">$</span>sims[[i]][[<span class="st">&quot;Data1&quot;</span>]][[<span class="st">&quot;net&quot;</span>]][[<span class="st">&quot;1&quot;</span>]])</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  </span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>GOF_M4 <span class="ot">&lt;-</span> <span class="fu">sienaGOF</span>(ans_M4, IndegreeDistribution, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">join =</span> <span class="cn">TRUE</span>, <span class="at">varName =</span> <span class="st">&quot;net&quot;</span>)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="fu">plot</span>(GOF_M4, <span class="at">main =</span> <span class="st">&quot;Indegree Distribution Model 4&quot;</span>)</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>GOF_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(simNets, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(simnet) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y))</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>OBS_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(wave_2, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y,stand)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>GOF_plot_M4 <span class="ot">&lt;-</span> GOF_dyads <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(OBS_dyads, <span class="at">by =</span> <span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>p_M4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(GOF_plot_M4, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.x) ) <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>               <span class="at">fun.max =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x),</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>               <span class="at">fun.min =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x),</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>               <span class="at">width=</span>.<span class="dv">1</span>,</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  <span class="fu">stat_summary</span>( <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.y), <span class="at">fun =</span> mean,</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Dyad Census&quot;</span>, <span class="at">y =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>  <span class="co"># scale_x_discrete(guide = guide_axis(n.dodge = 2)) +</span></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,  <span class="at">vjust =</span> <span class="fl">0.5</span>,)) <span class="sc">+</span>   </span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>p_M4</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-32-1.png" width="864" /></p>
</div>
<div id="model-5" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Model 5</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>simNets <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>  </span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  simNets[[i]] <span class="ot">=</span> <span class="fu">getNet</span>(<span class="dv">100</span>, ans_M5<span class="sc">$</span>sims[[i]][[<span class="st">&quot;Data1&quot;</span>]][[<span class="st">&quot;net&quot;</span>]][[<span class="st">&quot;1&quot;</span>]])</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  </span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>GOF_M5 <span class="ot">&lt;-</span> <span class="fu">sienaGOF</span>(ans_M5, IndegreeDistribution, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">join =</span> <span class="cn">TRUE</span>, <span class="at">varName =</span> <span class="st">&quot;net&quot;</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="fu">plot</span>(GOF_M5, <span class="at">main =</span> <span class="st">&quot;Indegree Distribution Model 5&quot;</span>)</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>GOF_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(simNets, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(simnet) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y))</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>OBS_dyads <span class="ot">&lt;-</span> <span class="fu">ts_dyads_evo</span>(wave_2, wave_1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">&quot;Null...Null&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stand =</span> y<span class="sc">/</span><span class="fu">sum</span>(y)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y,stand)</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>GOF_plot_M5 <span class="ot">&lt;-</span> GOF_dyads <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(OBS_dyads, <span class="at">by =</span> <span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>p_M5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(GOF_plot_M5, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.x) ) <span class="sc">+</span> </span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>               <span class="at">fun.max =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x),</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>               <span class="at">fun.min =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x),</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>               <span class="at">width=</span>.<span class="dv">1</span>,</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>  <span class="fu">stat_summary</span>( <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.y), <span class="at">fun =</span> mean,</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Dyad Census&quot;</span>, <span class="at">y =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>  <span class="co"># scale_x_discrete(guide = guide_axis(n.dodge = 2)) +</span></span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,  <span class="at">vjust =</span> <span class="fl">0.5</span>,)) <span class="sc">+</span>   </span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a>p_M5</span></code></pre></div>
<p><img src="Siena_GOF_files/figure-html/unnamed-chunk-36-1.png" width="864" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># </span><span class="al">TEST</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="co"># p_M1 &lt;- ggplot(GOF_plot, aes(x=x, y=y.x) ) + </span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="co">#   geom_violin(fill = &quot;grey&quot;, position=position_dodge(.8)) +</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a><span class="co">#   stat_summary(fun = mean,</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a><span class="co">#                geom = &quot;errorbar&quot;,</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="co">#                fun.max = function(x) mean(x) + sd(x),</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a><span class="co">#                fun.min = function(x) mean(x) - sd(x),</span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="co">#                width=.1,</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a><span class="co">#                color=&quot;red&quot;, position=position_dodge(.8)) + </span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a><span class="co">#   stat_summary( aes(x=x, y=y.x, group = 1), fun = mean,</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a><span class="co">#                geom = &quot;line&quot;,</span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="co">#                color=&quot;red&quot;, position=position_dodge(.8)) + </span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a><span class="co">#   stat_summary( aes(x=x, y=y.y, group = 1), fun = mean,</span></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a><span class="co">#                 geom = &quot;line&quot;,</span></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a><span class="co">#                 color=&quot;green&quot;, shape=10, position=position_dodge(.8)) + </span></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a><span class="co">#   labs(x = &quot;Dyad Census&quot;, y = &quot;N&quot;) +</span></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a><span class="co">#   # scale_x_discrete(guide = guide_axis(n.dodge = 2)) +</span></span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(angle = 60,  vjust = 0.5)) +   </span></span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a><span class="co"># p_M1</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent"
entry-spacing="0">
<div id="ref-ripley2011manual" class="csl-entry">
Ripley, Ruth M, Tom AB Snijders, Zsfia Boda, Andrs Vrs, and Paulina
Preciado. 2011. <span>Manual for RSIENA.</span> <em>University of
Oxford, Department of Statistics, Nuffield College</em> 1: 2011.
</div>
<div id="ref-tolsma2024twostep" class="csl-entry">
Tolsma, Jochem. 2024. <em>RsienaTwoStep: Simulate Network Evolution
Allowing Two Tie Changes Simultaneously</em>. <a
href="https://github.com/JochemTolsma/RsienaTwoStep">https://github.com/JochemTolsma/RsienaTwoStep</a>.
</div>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIlJlc3VsdHMgLSBHb29kbmVzcyBvZiBGaXQiDQojYmlibGlvZ3JhcGh5OiByZWZlcmVuY2VzLmJpYg0KYXV0aG9yOiAiTmllbHMgVnVsbGluZ3MiDQpiaWJsaW9ncmFwaHk6IHJlZmVyZW5jZXMuYmliDQotLS0NCg0KYGBge3IsIGVjaG89RkFMU0V9DQpybShsaXN0ID0gbHMoKSkNCmBgYA0KDQojIExvYWQgVURGDQoNCmBgYHtyfQ0KY29sb3JpemUgPC0gZnVuY3Rpb24oeCwgY29sb3IpIHtzcHJpbnRmKCI8c3BhbiBzdHlsZT0nY29sb3I6ICVzOyc+JXM8L3NwYW4+IiwgY29sb3IsIHgpIH0NCg0KZnBhY2thZ2UuY2hlY2sgPC0gZnVuY3Rpb24ocGFja2FnZXMpIHsNCiAgbGFwcGx5KHBhY2thZ2VzLCBGVU4gPSBmdW5jdGlvbih4KSB7DQogICAgaWYgKCFyZXF1aXJlKHgsIGNoYXJhY3Rlci5vbmx5ID0gVFJVRSkpIHsNCiAgICAgIGluc3RhbGwucGFja2FnZXMoeCwgZGVwZW5kZW5jaWVzID0gVFJVRSkNCiAgICAgIGxpYnJhcnkoeCwgY2hhcmFjdGVyLm9ubHkgPSBUUlVFKQ0KICAgIH0NCiAgfSkNCn0NCg0KZnNhdmUgPC0gZnVuY3Rpb24oeCwgZmlsZSA9IE5VTEwsIGxvY2F0aW9uID0gIi4vcmVzdWx0cy9wcm9jZXNzZWQvIikgew0KICBpZmVsc2UoIWRpci5leGlzdHMoInJlc3VsdHMiKSwgZGlyLmNyZWF0ZSgiZGF0YSIpLCBGQUxTRSkNCiAgaWZlbHNlKCFkaXIuZXhpc3RzKCJyZXN1bHRzL3Byb2Nlc3NlZCIpLCBkaXIuY3JlYXRlKCJyZXN1bHRzL3Byb2Nlc3NlZCIpLCBGQUxTRSkNCiAgaWYgKGlzLm51bGwoZmlsZSkpDQogICAgZmlsZSA9IGRlcGFyc2Uoc3Vic3RpdHV0ZSh4KSkNCiAgZGF0ZW5hbWUgPC0gc3Vic3RyKGdzdWIoIls6LV0iLCAiIiwgU3lzLnRpbWUoKSksIDEsIDgpDQogIHRvdGFsbmFtZSA8LSBwYXN0ZShsb2NhdGlvbiwgZGF0ZW5hbWUsIGZpbGUsICIucmRhIiwgc2VwID0gIiIpDQogIHNhdmUoeCwgZmlsZSA9IHRvdGFsbmFtZSkgICNuZWVkIHRvIGZpeCBpZiBmaWxlIGlzIHJlbG9hZGVkIGFzIGlucHV0IG5hbWUsIG5vdCBhcyB4LiANCn0NCg0KZmxvYWQgPC0gZnVuY3Rpb24oZmlsZW5hbWUpIHsNCiAgbG9hZChmaWxlbmFtZSkNCiAgZ2V0KGxzKClbbHMoKSAhPSAiZmlsZW5hbWUiXSkNCn0NCg0KZnNob3dkZiA8LSBmdW5jdGlvbih4LCAuLi4pIHsNCiAga25pdHI6OmthYmxlKHgsIGRpZ2l0cyA9IDIsICJodG1sIiwgLi4uKSAlPiUNCiAgICBrYWJsZUV4dHJhOjprYWJsZV9zdHlsaW5nKGJvb3RzdHJhcF9vcHRpb25zID0gYygic3RyaXBlZCIsICJob3ZlciIpKSAlPiUNCiAgICBrYWJsZUV4dHJhOjpzY3JvbGxfYm94KHdpZHRoID0gIjEwMCUiLCBoZWlnaHQgPSAiMzAwcHgiKQ0KfQ0KDQojLS0tLSBFeHRyYWN0IFNpbXVsYXRlZCBOZXR3b3JrcyAtLS0tDQpnZXROZXQgPC0gZnVuY3Rpb24oTiwgZWRnZUxpc3QpIHsgIyBnZXQgc2ltdWxhdGVkIG5ldHdvcmsgZnJvbSBTSUVOQQ0KICANCiAgIyBOID0gbnVtYmVyIG9mIG5vZGVzDQogIA0KICAjIGVkZ2VMaXN0ID0gZWRnZWxpc3QgdGhhdCBpcyByZXR1cm5lZCBieSBzaWVuYTA3KC4uLikkc2ltcw0KICANCiAgc2ltTmV0IDwtIG1hdHJpeCgwLE4sTikNCiAgDQogIGZvciAoaSBpbiAxOm5yb3coZWRnZUxpc3QpKSB7DQogICAgDQogICAgc2ltTmV0W2VkZ2VMaXN0W2ksMV0sZWRnZUxpc3RbaSwyXV0gPC0gMQ0KICAgIA0KICB9DQogIA0KICByZXR1cm4oc2ltTmV0KQ0KICANCn0NCg0KYGBgDQoNCiMjIEN1c3RvbSBEeWFkICYgVHJpYWQgY2Vuc3VzIGZ1bmN0aW9uDQoNCmBgYHtyfQ0KIy0tLS0gRHlhZCBjZW5zdXMgLS0tLQ0KdHNfZHlhZHNfZXZvIDwtIGZ1bmN0aW9uIChzaW1zLCBuZXQxLCBzaW10eXBlID0gIm5vdHlwZXNwZWNpZmllZCIsIGZvcnBsb3QgPSBUUlVFKSB7DQogIA0KICANCiAgaWYgKGlzLmxpc3Qoc2ltcykgPT0gVFJVRSkgew0KICAgIG5zaW1zIDwtIGxlbmd0aChzaW1zKQ0KICB9DQogIGVsc2Ugew0KICAgIG5zaW1zIDwtIDENCiAgfQ0KICBkZiA8LSBmb3JlYWNoOjpmb3JlYWNoKDE6bnNpbXMsIGkgPSBpdGVyYXRvcnM6Omljb3VudCgpLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAuY29tYmluZSA9ICJyYmluZCIpICVkb3BhciUgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXMubGlzdChzaW1zKSA9PSBUUlVFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldDIgPC0gc2ltc1tbaV1dDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldDIgPC0gc2ltcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlhZyhuZXQxKSA8LSBOQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlhZyhuZXQyKSA8LSBOQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxpcHMgPC0gbmV0MSArIHQobmV0MikgLSBuZXQyDQogICAgICAgICAgICAgICAgICAgICAgICAgICBqdW1wc3QxIDwtIG5ldDEgKyB0KG5ldDEpDQogICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFibGV0MSA8LSBqdW1wc3QxDQogICAgICAgICAgICAgICAgICAgICAgICAgICBqdW1wc3QxW2xvd2VyLnRyaShqdW1wc3QxKV0gPC0gTkENCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGp1bXBzdDIgPC0gbmV0MiArIHQobmV0MikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWJsZXQyIDwtIGp1bXBzdDINCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGp1bXBzdDJbbG93ZXIudHJpKGp1bXBzdDIpXSA8LSBOQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhYmxlMDAgPC0gYXMuZGF0YS5mcmFtZSh3aGljaChqdW1wc3QxID09IDAgJiBqdW1wc3QyID09IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAsIGFyci5pbmQgPSBUUlVFKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWJsZTAxIDwtIGFzLmRhdGEuZnJhbWUod2hpY2goZmxpcHMgPT0gMCAmIHN0YWJsZXQxID09IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEgJiBzdGFibGV0MiA9PSAxLCBhcnIuaW5kID0gVFJVRSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFibGUxMSA8LSBhcy5kYXRhLmZyYW1lKHdoaWNoKGp1bXBzdDEgPT0gMiAmIGp1bXBzdDIgPT0gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMiwgYXJyLmluZCA9IFRSVUUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgTnVsbF9Bc3N5bSA8LSBhcy5kYXRhLmZyYW1lKHdoaWNoKGp1bXBzdDEgPT0gMCAmIHN0YWJsZXQyID09IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSwgYXJyLmluZCA9IFRSVUUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgQXNzeW1fTnVsbCA8LSBhcy5kYXRhLmZyYW1lKHdoaWNoKGZsaXBzID09IDAgJiBzdGFibGV0MSA9PSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEgJiBzdGFibGV0MiA9PSAwLCBhcnIuaW5kID0gVFJVRSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICBBc3N5bV9NdXQgPC0gYXMuZGF0YS5mcmFtZSh3aGljaChzdGFibGV0MSA9PSAxICYganVtcHN0MiA9PSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMiwgYXJyLmluZCA9IFRSVUUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgTXV0X0Fzc3ltIDwtIGFzLmRhdGEuZnJhbWUod2hpY2goanVtcHN0MSA9PSAyICYganVtcHN0MiA9PSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSwgYXJyLmluZCA9IFRSVUUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxpcCA8LSBhcy5kYXRhLmZyYW1lKHdoaWNoKGZsaXBzID09IDIgJiBzdGFibGV0MSAhPSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIgJiBzdGFibGV0MiAhPSAyLCBhcnIuaW5kID0gVFJVRSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICBqdW1wMDIgPC0gYXMuZGF0YS5mcmFtZSh3aGljaChqdW1wc3QxID09IDAgJiBqdW1wc3QyID09IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyLCBhcnIuaW5kID0gVFJVRSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICBqdW1wMjAgPC0gYXMuZGF0YS5mcmFtZSh3aGljaChqdW1wc3QxID09IDIgJiBqdW1wc3QyID09IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwLCBhcnIuaW5kID0gVFJVRSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZSA8LSBjYmluZChucm93KHN0YWJsZTAwKSwgbnJvdyhzdGFibGUwMSksIG5yb3coc3RhYmxlMTEpLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5yb3coTnVsbF9Bc3N5bSksIG5yb3coQXNzeW1fTnVsbCksIG5yb3coQXNzeW1fTXV0KSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBucm93KE11dF9Bc3N5bSksIG5yb3coZmxpcCksIG5yb3coanVtcDAyKSwgbnJvdyhqdW1wMjApKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sbmFtZXModGFibGUpIDwtIGMoIk51bGwgPiBOdWxsIiwgIkFzc3ltID4gQXNzeW0iLCAiTXV0dWFsID4gTXV0dWFsIiwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTnVsbCA+IEFzc3ltIiwgIkFzc3ltID4gTnVsbCIsICJBc3N5bSA+IE11dHVhbCIsICJNdXR1YWwgPiBBc3N5bSIsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRpZSBmbGlwIiwgIk51bGwgPiBNdXR1YWwiLCAiTXV0dWFsID4gTnVsbCIpDQogICAgICAgICAgICAgICAgICAgICAgICAgICBzaW1uZXQgPC0gTlVMTA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuKGRhdGEuZnJhbWUoc2ltbmV0ID0gaSwgdGFibGUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgZGYgPC0gYXMuZGF0YS5mcmFtZShkZikNCiAgdHlwZSA8LSBOVUxMDQogIGRmJHR5cGUgPC0gc2ltdHlwZQ0KICBpZiAoZm9ycGxvdCA9PSBUUlVFKSB7DQogICAgZGYgPC0gdGlkeXI6OnBpdm90X2xvbmdlcihkZiwgY29scyA9ICFjKHNpbW5ldCwgdHlwZSksIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXNfdG8gPSAieCIsIHZhbHVlc190byA9ICJ5IikNCiAgfQ0KICByZXR1cm4oZGYpDQp9DQoNCiMtLS0tIFRyaWFkIGNlbnN1cyAtLS0tDQp0c190cmlhZHNfZXZvIDwtIGZ1bmN0aW9uIChzaW1zLCBuZXQxLCBzaW10eXBlID0gIm5vdHlwZXNwZWNpZmllZCIsIGZvcnBsb3QgPSBUUlVFKSB7DQogIA0KICANCiAgeCA8LSBqIDwtIGsgPC0gYTEgPC0gYTIgPC0gYTMgPC0gdGllX2NoYW5nZSA8LSBGcmVxIDwtIHNpbW5ldCA8LSB0eXBlIDwtIE5VTEwNCiAgaWYgKGlzLmxpc3Qoc2ltcykgPT0gVFJVRSkgew0KICAgIG5zaW1zIDwtIGxlbmd0aChzaW1zKQ0KICB9DQogIGVsc2Ugew0KICAgIG5zaW1zIDwtIDENCiAgfQ0KICBkZiA8LSBmb3JlYWNoOjpmb3JlYWNoKDE6bnNpbXMsIHggPSBpdGVyYXRvcnM6Omljb3VudCgpLC5jb21iaW5lID0gInJiaW5kIikgJWRvcGFyJSB7DQogICAgDQogICAgaWYgKGlzLmxpc3Qoc2ltcykgPT0gVFJVRSkgew0KICAgICAgbmV0MiA8LSBzaW1zW1t4XV0NCiAgICAgIA0KICAgICAgI2ZpbmQgd2hpY2ggdmFsdWVzIGluIHRoZSBtYXRyaXggYXJlIG1pc3NpbmcNCiAgICAgIE5fTkEgPC0gdW5pcXVlKHdoaWNoKGlzLm5hKG5ldDEpIHwgaXMubmEobmV0MiksIGFyci5pbmQgPSBUUlVFKVssMV0pICMgSWRlbnRpZnkgbm9ybWFsIE5BIHZhbHVlcw0KICAgICAgU19OQSA8LSBhcy5kYXRhLmZyYW1lKHRhYmxlKHdoaWNoKG5ldDEgPT0gMTAgfCBuZXQyID09IDEwLCBhcnIuaW5kID0gVFJVRSlbLDFdKSkgIyBJZGVudGlmeSBTdHJ1Y3R1cmFsIE5Bcw0KICAgICAgU19OQSA8LSB3aGljaChTX05BJEZyZXEgPT0gbnJvdyhuZXQxKSkNCiAgICAgIE5BX3Jvd3MgPC0gYyhhcy52ZWN0b3IoTl9OQSksIGFzLnZlY3RvcihTX05BKSkgIyBzYXZlIGFsbCBhY3RvcnMgaW4gMSB2ZWN0b3INCiAgICAgIA0KICAgICAgaWYobGVuZ3RoKE5BX3Jvd3MpPiAwKXsNCiAgICAgICAgDQogICAgICAgIHdhcm5pbmcobmNvbChuZXQxKS0gbGVuZ3RoKE5BX3Jvd3MpLCIgYWN0b3JzIHdpbGwgYmUgYW5hbHlzZWQgZHVlIHRvIG1pc3NpbmcgdmFsdWVzLiBGb2xsb3dpbmcgIiwgbGVuZ3RoKE5BX3Jvd3MpLCAiIGFjdG9ycyBoYXZlIGJlZW4gbGlzdHdpc2UgZGVsZXRlZDogIixwYXN0ZShOQV9yb3dzLCBjb2xsYXBzZT0iLCIpKQ0KICAgICAgICAjIERlbGV0ZSBib3RoIHJvd3MgYW5kIGNvbHVtbnMgb2YgYWN0b3JzIHRoYXQgYXJlIG1pc3NpbmcgKE5BKQ0KICAgICAgICBuZXQxIDwtIG5ldDFbLU5BX3Jvd3MsLU5BX3Jvd3NdDQogICAgICAgIA0KICAgICAgICBuZXQyIDwtIG5ldDJbLU5BX3Jvd3MsLU5BX3Jvd3NdDQogICAgICAgIA0KICAgICAgfQ0KICAgICAgDQogICAgfQ0KICAgIGVsc2Ugew0KICAgICAgbmV0MiA8LSBzaW1zDQogICAgICANCiAgICAgICNmaW5kIHdoaWNoIHZhbHVlcyBpbiB0aGUgbWF0cml4IGFyZSBtaXNzaW5nDQogICAgICBOQV9yb3cgPC0gdW5pcXVlKHdoaWNoKGlzLm5hKG5ldDEpIHwgaXMubmEobmV0MiksIGFyci5pbmQgPSBUUlVFKVssMV0pIA0KICAgICAgDQogICAgICAjZmluZCB3aGljaCB2YWx1ZXMgaW4gdGhlIG1hdHJpeCBhcmUgbWlzc2luZw0KICAgICAgTl9OQSA8LSB1bmlxdWUod2hpY2goaXMubmEobmV0MSkgfCBpcy5uYShuZXQyKSwgYXJyLmluZCA9IFRSVUUpWywxXSkgIyBJZGVudGlmeSBub3JtYWwgTkEgdmFsdWVzDQogICAgICBTX05BIDwtIGFzLmRhdGEuZnJhbWUodGFibGUod2hpY2gobmV0MSA9PSAxMCB8IG5ldDIgPT0gMTAsIGFyci5pbmQgPSBUUlVFKVssMV0pKSAjIElkZW50aWZ5IFN0cnVjdHVyYWwgTkFzDQogICAgICBTX05BIDwtIHdoaWNoKFNfTkEkRnJlcSA9PSBucm93KG5ldDEpKQ0KICAgICAgTkFfcm93cyA8LSBjKGFzLnZlY3RvcihOX05BKSwgYXMudmVjdG9yKFNfTkEpKSAjIHNhdmUgYWxsIGFjdG9ycyBpbiAxIHZlY3Rvcg0KICAgICAgDQogICAgICBpZihsZW5ndGgoTkFfcm93cyk+IDApew0KICAgICAgICANCiAgICAgICAgd2FybmluZyhuY29sKG5ldDEpLSBsZW5ndGgoTkFfcm93cyksIiBhY3RvcnMgd2lsbCBiZSBhbmFseXNlZCBkdWUgdG8gbWlzc2luZyB2YWx1ZXMuIEZvbGxvd2luZyAiLCBsZW5ndGgoTkFfcm93cyksICIgYWN0b3JzIGhhdmUgYmVlbiBsaXN0d2lzZSBkZWxldGVkOiAiLHBhc3RlKE5BX3Jvd3MsIGNvbGxhcHNlPSIsIikpDQogICAgICAgICMgRGVsZXRlIGJvdGggcm93cyBhbmQgY29sdW1ucyBvZiBhY3RvcnMgdGhhdCBhcmUgbWlzc2luZyAoTkEpDQogICAgICAgIG5ldDEgPC0gbmV0MVstTkFfcm93cywtTkFfcm93c10NCiAgICAgICAgDQogICAgICAgIG5ldDIgPC0gbmV0MlstTkFfcm93cywtTkFfcm93c10NCiAgICAgICAgDQogICAgICB9DQogICAgfQ0KICAgIA0KICAgIHRyaWFkcyA8LSBjKCJYMDAzIiwgIlgwMTIiLCAiWDEwMiIsICJYMDIxRCIsICJYMDIxVSIsIA0KICAgICAgICAgICAgICAgICJYMDIxQyIsICJYMTExRCIsICJYMTExVSIsICJYMDMwVCIsICJYMDMwQyIsICJYMjAxIiwgDQogICAgICAgICAgICAgICAgIlgxMjBEIiwgIlgxMjBVIiwgIlgxMjBDIiwgIlgyMTAiLCAiWDMwMCIpDQogICAgDQogICAgZGYgPC0gZm9yZWFjaDo6Zm9yZWFjaChhMSA9IDE6bnJvdyhuZXQxKSwgaSA9IGl0ZXJhdG9yczo6aWNvdW50KCksLmNvbWJpbmUgPSAicmJpbmQiKSAlOiUgDQogICAgICBmb3JlYWNoOjpmb3JlYWNoKGEyID0gMTpucm93KG5ldDEpLCBqID0gaXRlcmF0b3JzOjppY291bnQoKSwgLmNvbWJpbmUgPSAicmJpbmQiKSAlOiUgDQogICAgICBmb3JlYWNoOjpmb3JlYWNoKGEzID0gMTpucm93KG5ldDEpLCBrID0gaXRlcmF0b3JzOjppY291bnQoKSwuY29tYmluZSA9ICJyYmluZCIpICVkbyUgew0KICAgICAgICBpZiAoaSA+IGogJiBqID4gaykgew0KICAgICAgICAgIGRhdGEuZnJhbWUoaSA9IGksIGogPSBqLCBrID0gaywgDQogICAgICAgICAgICAgICAgICAgICB0MV9paiA9IGFzLmNoYXJhY3RlcihuZXQxW2ExLGEyXSksIHQxX2ppID0gYXMuY2hhcmFjdGVyKG5ldDFbYTIsIGExXSksIA0KICAgICAgICAgICAgICAgICAgICAgdDFfaWsgPSBhcy5jaGFyYWN0ZXIobmV0MVthMSxhM10pLCB0MV9raSA9IGFzLmNoYXJhY3RlcihuZXQxW2EzLCBhMV0pLCANCiAgICAgICAgICAgICAgICAgICAgIHQxX2prID0gYXMuY2hhcmFjdGVyKG5ldDFbYTIsYTNdKSwgdDFfa2ogPSBhcy5jaGFyYWN0ZXIobmV0MVthMywgYTJdKSwgDQogICAgICAgICAgICAgICAgICAgICB0eXBlVDEgPSB0cmlhZHNbd2hpY2goc25hOjp0cmlhZC5jZW5zdXMobmV0MVtjKGExLGEyLCBhMyksIGMoYTEsIGEyLCBhMyldKSA9PSAxKV0sIA0KICAgICAgICAgICAgICAgICAgICAgdDJfaWogPSBhcy5jaGFyYWN0ZXIobmV0MlthMSwgYTJdKSwgdDJfamkgPSBhcy5jaGFyYWN0ZXIobmV0MlthMiwgYTFdKSwgDQogICAgICAgICAgICAgICAgICAgICB0Ml9payA9IGFzLmNoYXJhY3RlcihuZXQyW2ExLCBhM10pLCB0Ml9raSA9IGFzLmNoYXJhY3RlcihuZXQyW2EzLCBhMV0pLCANCiAgICAgICAgICAgICAgICAgICAgIHQyX2prID0gYXMuY2hhcmFjdGVyKG5ldDJbYTIsIGEzXSksIHQyX2tqID0gYXMuY2hhcmFjdGVyKG5ldDJbYTMsIGEyXSksIA0KICAgICAgICAgICAgICAgICAgICAgdHlwZVQyID0gdHJpYWRzW3doaWNoKHNuYTo6dHJpYWQuY2Vuc3VzKG5ldDJbYyhhMSwgYTIsIGEzKSwgYyhhMSwgYTIsIGEzKV0pID09IDEpXSwgDQogICAgICAgICAgICAgICAgICAgICB0aWVfY2hhbmdlID0gc3VtKGMobmV0MVthMSwgYTJdLCBuZXQxW2EyLCBhMV0sIG5ldDFbYTEsIGEzXSwgbmV0MVthMywgYTFdLCBuZXQxW2EyLCBhM10sIG5ldDFbYTMsIGEyXSkgIT0gYyhuZXQyW2ExLCBhMl0sIG5ldDJbYTIsIGExXSwgbmV0MlthMSwgYTNdLCBuZXQyW2EzLCBhMV0sIG5ldDJbYTIsIGEzXSwgbmV0MlthMywgYTJdKSkpDQogICAgICAgIH0NCiAgICAgIH0NCiAgICANCiAgICANCiAgICBkZiRuYW1lIDwtIHBhc3RlMChkZiRpLCAiLiIsIGRmJGosICIuIiwgZGYkaykNCiAgICBkZiA8LSBzdWJzZXQoZGYsIHNlbGVjdCA9IGModGllX2NoYW5nZSkpDQogICAgDQogICAgIy0tLS0gISFORVchISBBc3NpZ24gbGV2ZWxzIHRvIGNvdW50ZXIgbWlzc2luZyBjb2x1bW5zIC0tLS0NCiAgICBkZiR0aWVfY2hhbmdlIDwtIGFzLmZhY3RvcihkZiR0aWVfY2hhbmdlKQ0KICAgIGxldmVscyhkZiR0aWVfY2hhbmdlKSA8LSBjKCIwIiwgIjEiLCIyIiwgIjMiLCI0IiwgIjUiLCI2IikNCiAgICAjLS0tLSBGaXhlcyBpc3N1ZXMgd2l0aCBzaW11bGF0ZWQgbmV0d29ya3MgLS0tLQ0KICAgIA0KICAgIGRmIDwtIGRhdGEuZnJhbWUoc2ltbmV0ID0geCwgdGFibGUoZGYpKQ0KICAgIGRmIDwtIHRpZHlyOjpwaXZvdF93aWRlcihkZiwgbmFtZXNfZnJvbSA9IHRpZV9jaGFuZ2UsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc19mcm9tID0gRnJlcSkNCiAgICANCiAgfQ0KICANCiAgZGYgPC0gYXMuZGF0YS5mcmFtZShkZikNCiAgZGYkdHlwZSA8LSBzaW10eXBlDQogIA0KICBpZiAoZm9ycGxvdCA9PSBUUlVFKSB7DQogICAgZGYgPC0gdGlkeXI6OnBpdm90X2xvbmdlcihkZiwgY29scyA9ICFjKHNpbW5ldCwgdHlwZSksIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXNfdG8gPSAieCIsIHZhbHVlc190byA9ICJ5IikNCiAgfQ0KICANCiAgcmV0dXJuKGRmKQ0KICANCn0NCg0KYGBgDQoNCiMgTG9hZCBQYWNrYWdlcw0KDQpgYGB7ciwgd2FybmluZz1GQUxTRSwgcmVzdWx0cz0naGlkZScsIG1lc3NhZ2U9RkFMU0V9DQpwYWNrYWdlcyA8LSBjKCJ0aWR5dmVyc2UiLCAic25hIiwgImlncmFwaCIsICJSU2llbmEiLCAiaXRlcmF0b3JzIiwgImRvUGFyYWxsZWwiKQ0KDQpmcGFja2FnZS5jaGVjayhwYWNrYWdlcykNCmBgYA0KDQojIFNldCB1cCBwYXJhbGxlbCBjbHVzdGVyDQoNCmBgYHtyLCByZXN1bHRzPSdoaWRlJ30NCm5vX2NvcmVzIDwtIGRldGVjdENvcmVzKCkgLSAxDQpteWNsIDwtIG1ha2VDbHVzdGVyKHJlcCgibG9jYWxob3N0Iiwgbm9fY29yZXMpKQ0KY2x1c3RlckV2YWxRKG15Y2wsIGxpYnJhcnkoUnNpZW5hVHdvU3RlcCkpDQpyZWdpc3RlckRvUGFyYWxsZWwobXljbCkNCiMgc3RvcENsdXN0ZXIobXljbCkNCg0KYGBgDQoNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQojIExvYWQgRGF0YQ0KDQpgYGB7cn0NCmRmX2VnbyA8LSBmbG9hZCgiLi9kYXRhL3Byb2Nlc3NlZC9SVV9VVV9lZ28uUkRhdGEiKQ0Kc29jX2RhdGEgPC0gZmxvYWQoIi4vZGF0YS9wcm9jZXNzZWQvc29jX2RhdGFfcmF3LlJEYXRhIikNCmBgYA0KDQojIyBFeHRyYWN0IG5ldHdvcmtzIGZvciBiZXR0ZXIgbWVtb3J5IHVzYWdlDQoNCmBgYHtyfQ0Kd2F2ZV8xIDwtIHNvY19kYXRhJG5ldHNbMSwsXQ0Kd2F2ZV8yIDwtIHNvY19kYXRhJG5ldHNbMiwsXQ0KDQpybShzb2NfZGF0YSkNCmBgYA0KDQojIExvYWQgTW9kZWxzDQoNCmBgYHtyfQ0KYW5zX00wIDwtIGZsb2FkKCIuL3Jlc3VsdHMvcHJvY2Vzc2VkLzIwMjQxMDI0LWFuc19NMC5yZGEiKQ0KYW5zX00xIDwtIGZsb2FkKCIuL3Jlc3VsdHMvcHJvY2Vzc2VkLzIwMjQxMDI0LWFuc19NMV8yLnJkYSIpDQphbnNfTTIgPC0gZmxvYWQoIi4vcmVzdWx0cy9wcm9jZXNzZWQvMjAyNDEwMjQtYW5zX00yXzIucmRhIikNCmFuc19NMi41IDwtIGZsb2FkKCIuL3Jlc3VsdHMvcHJvY2Vzc2VkLzIwMjQxMDI0LWFuc19NMi41LnJkYSIpDQphbnNfTTMgPC0gZmxvYWQoIi4vcmVzdWx0cy9wcm9jZXNzZWQvMjAyNDEwMjktYW5zX00zLnJkYSIpDQphbnNfTTQgPC0gZmxvYWQoIi4vcmVzdWx0cy9wcm9jZXNzZWQvMjAyNDEwMjQtYW5zX000LnJkYSIpDQphbnNfTTUgPC0gZmxvYWQoIi4vcmVzdWx0cy9wcm9jZXNzZWQvMjAyNDEwMjktYW5zX001LnJkYSIpDQpgYGANCg0KIyBSU2llbmEgLSBHb29kbmVzcyBvZiBGaXQgey50YWJzZXR9DQoNCkFwYXJ0IGZyb20gdGhlIGNvbnZlcmdlbmNlIG9mIHRoZSBtb2RlbCBhbmQgdGhlIHNpZ25pZmljYW5jZSBvZiB0aGUgZXN0aW1hdGVzLCB0aGUgR29vZG5lc3Mgb2YgRml0IHBsYXlzIGEgY3JpdGljYWwgcm9sZSBpbiBhc3Nlc3Npbmcgd2hldGhlciBhIG1vZGVsIGVzdGltYXRlZCBpbiBSU2llbmEgaXMgcmVwcmVzZW50YXRpdmUgb2YgdGhlIG9ic2VydmVkIGRhdGEuIEFzIFJTaWVuYSBpcyBhIG1ldGhvZCB0aGF0IHVzZXMgc2ltdWxhdGlvbiwgaXQgaXMgaW1wb3J0YW50IHRvIGNoZWNrIHdoZXRoZXIgdGhlIHN0cnVjdHVyZSBvZiB0aGUgc2ltdWxhdGVkIG5ldHdvcmtzIHJlc2VtYmxlcyB0aGUgY2hhbmdlcyB2aXNpYmxlIGluIHRoZSBvYnNlcnZlZCBuZXR3b3JrIFtAcmlwbGV5MjAxMW1hbnVhbF0uIFdoaWxlIG1hbnkgYXV4aWxpYXJ5IGZ1bmN0aW9ucyBhcmUgYXZhaWxhYmxlIHRvIHRlc3QgdGhlIEdvb2RuZXNzIG9mIGZpdCBvZiBhIG1vZGVsLCBJIGNob3NlIHRvIHVzZSB0d28gdHlwZXM6IHRoZSBkaXN0cmlidXRpb24gb2YgaW5kZWdyZWVzIGFuZCBhIGR5YWQgZXZvbHV0aW9uIGNlbnN1cy4gVGhlIGluZGVncmVlIGRpc3RyaWJ1dGlvbiBpcyBhdmFpbGFibGUgaW4gUlNpZW5hIGFuZCBtZWFzdXJlcyB0aGUgZXh0ZW50IHRvIHdoaWNoIHRoZSBzaW11bGF0ZWQgbmV0d29ya3MgZm9sbG93IHRoZSBpbmRlZ3JlZSBkaXN0cmlidXRpb24gb2YgdGhlIG9ic2VydmVkIG5ldHdvcmsuIFRoZSBkeWFkIGV2b2x1dGlvbiBjZW5zdXMgaXMgZnVuY3Rpb24gdGhhdCBpcyB3cml0dGVuIGJ5IG15c2VsZiwgYXMgcGFydCBvZiB0aGUgUnNpZW5hVHdvU3RlcC1wcm9qZWN0IFtAdG9sc21hMjAyNHR3b3N0ZXBdLiBVc2luZyB0aGUgUiBwYWNrYWdlIGdncGxvdDIsIGl0IGlzIGNyZWF0ZSBhIEdvb2RuZXNzIG9mIEZpdCBwbG90IGZvciB0aGlzIGNlbnN1cy4gVGhlIGdyZXkgdmlvbGlucGxvdCBpcyB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSBzaW11bGF0ZWQgbmV0d29ya3MgZm9yIGEgc3BlY2lmaWMgdHJpYWQgdHJhbnNpdGlvbiBmcm9tIHdhdmUgMSB0byB3YXZlIDIuIFRoZSByZWQgcG9pbnQgaW5jbHVkaW5nIHRoZSB0YWlscyBpcyB0aGUgbWVhbiBvZiB0aGUgc2ltdWxhdGVkIG5ldHdvcmsgY2Vuc3VzIGluY2x1ZGluZyB0aGUgY29uZmlkZW5jZSBpbnRlcnZhbHMgKCRcbXUgXHBtIDEuOTYqIFxzaWdtYSQpLiBUaGUgZ3JlZW4gcG9pbnQgaXMgdGhlIG9ic2VydmVkIHZhbHVlIGZvciBhIHNwZWNpZmljIHRyYW5zaXRpb24uIExvZ2ljYWxseSwgdGhlIGNsb3NlciB0aGUgcmVkIGFuZCBncmVlbiBwb2ludHMgYXJlIHRvIGVhY2ggb3RoZXIsIHRoZSBiZXR0ZXIgdGhpcyB0cmFuc2l0aW9uIHdhcyBlc3RpbWF0ZWQgaW4gdGhlIHNpbXVsYXRpb25zLiBXaGVuIHRoZSBncmVlbiBwb2ludCBpcyB3aXRoaW4gdGhlIHRhaWxzLCBpdCBpcyBzaWduaWZpY2FudCBmb3IgYSBhbHBoYSBvZiAwLjA1LiBCZWxvdyBJIHdpbGwgYXNzZXNzIHRoZSBHb29kbmVzcyBvZiBGaXQgb2YgZWFjaCBtb2RlbCBhbmQgaXRzIGNvbnNlcXVlbmNlcyBmb3IgdGhlIHJlc3VsdHMuDQoNCiMjIE1vZGVsIDANCg0KVGhlIEdvb2RuZXNzIG9mIEZpdCBmb3IgdGhlIGluZGVncmVlIGRpc3RyaWJ1dGlvbiBpcyAwLCBpbmRpY2F0aW5nIHZlcnkgYSBzaWduaWZpY2FudCBkZXZpYXRpb24gYmV0d2VlbiB0aGUgZXhwZWN0ZWQgYW5kIG9ic2VydmVkIGluZGVncmVlIGRpc3RyaWJ1dGlvbi4gVGhlIGFtb3VudCBvZiBhY3RvcnMgd2l0aCAwIG9yIDEgb2JzZXJ2ZWQgaW5kZWdyZWVzIGlzIChzZXZlcmx5KSB1bmRlcmVzdGltYXRlZC4gVGhlIGFtb3VudCBvZiBhY3RvcnMgd2l0aCAyIGluZGVncmVlcyBpcyBxdWl0ZSBhY2N1cmF0ZWx5IGVzdGltYXRlZC4gQWN0b3JzIHdpdGggMyBvciBtb3JlIGluZGVncmVlcyBhcmUgYWxsIG92ZXJlc3RpbWF0ZWQuIEdpdmVuIHRoZSBmYWN0IHRoYXQgdGhpcyBtb2RlbCBkb2VzIG5vdCBpbmNsdWRlIGFueSBzdHJ1Y3R1cmFsIGVmZmVjdHMgYXBhcnQgZnJvbSB0aGUgc3RhbmRhcmQgbmV0d29yayBzdGF0aXN0aWNzIGluIFJTaWVuYSwgdGhpcyBtYWtlcyBzZW5zZS4gXA0KJmVtc3A7IFJlZ2FyZGluZyB0aGUgZHlhZCBjZW5zdXMsIG1vc3Qgb2JzZXJ2ZWQgdHJhbnNpdGlvbnMgYXJlIHdpdGhpbiAxLjk2IHRoZSBzdGFuZGFyZCBkZXZpYXRpb24gb2YgdGhlIHNpbXVsYXRlZCBuZXR3b3Jrcy4gSG93ZXZlciwgdGhlIHRyYW5zaXRpb24gIipOdWxsIFw+IEFzc3ltKiIgYW5kICIqQXNzeW0gXD4gTnVsbCIqIGFyZSBpbiB0aGUgbG93ZXIgYm91bmRzIG9mIHRoZSBkaXN0cmlidXRpb24sIHdoaWNoIGluZGljYXRlcyB0aGF0IHRoZXJlIGlzIHJvb20gZm9yIGltcHJvdmVtZW50LiBUaGUgb2JzZXJ2ZWQgdHJhbnNpdGlvbnMgZm9yIHN0YWJsZSBtdXR1YWwgZHlhZHMgIipNdXR1YWwgXD4gTXV0dWFsKiIgaXMgb3ZlcmVzdGltYXRlZCwgd2hpbGUgdGhlIHRyYW5zaXRpb24gIipNdXR1YWwgXD4gQXNzeW0qIiBhbmQgIipUaWUgZmxpcHMiKiBhcmUgYm90aCB1bmRlcmVzdGltYXRlZCBpbiB0aGlzIG1vZGVsLg0KDQpgYGB7cn0NCg0Kc2ltTmV0cyA8LSBsaXN0KCkNCmZvciAoaSBpbiAxOjEwMDApIHsNCiAgDQogIHNpbU5ldHNbW2ldXSA9IGdldE5ldCgxMDAsIGFuc19NMCRzaW1zW1tpXV1bWyJEYXRhMSJdXVtbIm5ldCJdXVtbIjEiXV0pDQogIA0KfQ0KDQpgYGANCg0KYGBge3J9DQpHT0ZfTTAgPC0gc2llbmFHT0YoYW5zX00wLCBJbmRlZ3JlZURpc3RyaWJ1dGlvbiwgdmVyYm9zZSA9IEZBTFNFLCBqb2luID0gVFJVRSwgdmFyTmFtZSA9ICJuZXQiKQ0KDQpwbG90KEdPRl9NMCwgbWFpbiA9ICJJbmRlZ3JlZSBEaXN0cmlidXRpb24gTW9kZWwgMCIpDQoNCmBgYA0KDQpgYGB7cn0NCg0KR09GX2R5YWRzIDwtIHRzX2R5YWRzX2V2byhzaW1OZXRzLCB3YXZlXzEpICU+JSBmaWx0ZXIoeCAhPSAiTnVsbC4uLk51bGwiKSAlPiUgZ3JvdXBfYnkoc2ltbmV0KSAlPiUgbXV0YXRlKHN0YW5kID0geS9zdW0oeSkpDQoNCk9CU19keWFkcyA8LSB0c19keWFkc19ldm8od2F2ZV8yLCB3YXZlXzEpICU+JSBmaWx0ZXIoeCAhPSAiTnVsbC4uLk51bGwiKSAlPiUgbXV0YXRlKHN0YW5kID0geS9zdW0oeSkpICU+JSBzZWxlY3QoeCx5LHN0YW5kKQ0KDQoNCkdPRl9wbG90X00wIDwtIEdPRl9keWFkcyAlPiUgbGVmdF9qb2luKE9CU19keWFkcywgYnkgPSAieCIpDQpgYGANCg0KYGBge3IsIGZpZy53aWR0aD05fQ0KDQpwX00wIDwtIGdncGxvdChHT0ZfcGxvdF9NMCwgYWVzKHg9eCwgeT15LngpICkgKyANCiAgZ2VvbV92aW9saW4oZmlsbCA9ICJncmV5IiwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArDQogIHN0YXRfc3VtbWFyeShmdW4gPSBtZWFuLA0KICAgICAgICAgICAgICAgZ2VvbSA9ICJlcnJvcmJhciIsDQogICAgICAgICAgICAgICBmdW4ubWF4ID0gZnVuY3Rpb24oeCkgbWVhbih4KSArIHNkKHgpLA0KICAgICAgICAgICAgICAgZnVuLm1pbiA9IGZ1bmN0aW9uKHgpIG1lYW4oeCkgLSBzZCh4KSwNCiAgICAgICAgICAgICAgIHdpZHRoPS4xLA0KICAgICAgICAgICAgICAgY29sb3I9InJlZCIsIHBvc2l0aW9uPXBvc2l0aW9uX2RvZGdlKC44KSkgKyANCiAgc3RhdF9zdW1tYXJ5KGZ1biA9IG1lYW4sDQogICAgICAgICAgICAgICBnZW9tID0gInBvaW50IiwNCiAgICAgICAgICAgICAgIGNvbG9yPSJyZWQiLCBwb3NpdGlvbj1wb3NpdGlvbl9kb2RnZSguOCkpICsgDQogIHN0YXRfc3VtbWFyeSggYWVzKHg9eCwgeT15LnkpLCBmdW4gPSBtZWFuLA0KICAgICAgICAgICAgICAgIGdlb20gPSAicG9pbnQiLA0KICAgICAgICAgICAgICAgIGNvbG9yPSJncmVlbiIsIHNpemUgPSAzLCBzaGFwZT0xMCwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArIA0KICBsYWJzKHggPSAiRHlhZCBDZW5zdXMiLCB5ID0gIk4iKSArDQogICMgc2NhbGVfeF9kaXNjcmV0ZShndWlkZSA9IGd1aWRlX2F4aXMobi5kb2RnZSA9IDIpKSArDQogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsICB2anVzdCA9IDAuNSwpKSArICAgDQogIHRoZW1lX21pbmltYWwoKQ0KDQpwX00wDQoNCmBgYA0KDQojIyBNb2RlbCAxDQoNCk1vZGVsIDEsIHdoaWNoIGluY2x1ZGVzIHRoZSBzdHJ1Y3R1cmFsIGVmZmVjdHMsIGhhcyBhIEdvb2RuZXNzIG9mIEZpdCAtIHZhbHVlIGZvciB0aGUgaW5kZWdyZWUgZGlzdHJpYnV0aW9uIG9mIDAuMDE2LiBUaGUgaW5jbHVzaW9uIG9mIHRoZSBJc29sYXRlTmV0IHN0YXRpc3RpYyBkZWNyZWFzZWQgdGhlIG92ZXJlc3RpbWF0aW9uIG9mIHRoZSBpc29sYXRlcywgYnV0IHRoZSBhbW91bnQgb2YgYWN0b3JzIHdpdGggMCBpbmRlZ3JlZXMgaXMgc3RpbGwgdW5kZXJlc3RpbWF0ZWQuIFRoZSBhbW91bnQgb2YgYWN0b3JzIHdpdGggMSBpbmRlZ3JlZXMgaXMgc2ltaWxhcmx5IHVuZGVyZXN0aW1hdGVkLCB3aGlsZSBhY3RvcnMgd2l0aCAyIG9yIG1vcmUgaW5kZWdyZWVzIGlzIG92ZXJlc3RpbWF0ZWQuIFRoZSBHT0Ygb2YgdGhlIGR5YWQgY2Vuc3VzIGlzIHNpbWlsYXIgdG8gdGhlIEdPRiBvZiBNb2RlbCAwLCBpbmRpY2F0aW5nIHRoZSBub3QgbXVjaCBjaGFuZ2VkIGJldHdlZW4gdGhlc2UgbW9kZWxzLCB3aGljaCBpcyBhbHNvIHZpc2libGUgYnkgdGhlIHNtYWxsIGluY3JlYXNlIGluIHRoZSBwLXZhbHVlIG9mIHRoZSBpbmRlZ3JlZSBkaXN0cmlidXRpb24gcGxvdC4NCg0KYGBge3J9DQoNCnNpbU5ldHMgPC0gbGlzdCgpDQpmb3IgKGkgaW4gMToxMDAwKSB7DQogIA0KICBzaW1OZXRzW1tpXV0gPSBnZXROZXQoMTAwLCBhbnNfTTEkc2ltc1tbaV1dW1siRGF0YTEiXV1bWyJuZXQiXV1bWyIxIl1dKQ0KICANCn0NCg0KYGBgDQoNCmBgYHtyfQ0KR09GX00xIDwtIHNpZW5hR09GKGFuc19NMSwgSW5kZWdyZWVEaXN0cmlidXRpb24sIHZlcmJvc2UgPSBGQUxTRSwgam9pbiA9IFRSVUUsIHZhck5hbWUgPSAibmV0IikNCg0KcGxvdChHT0ZfTTEsIG1haW4gPSAiSW5kZWdyZWUgRGlzdHJpYnV0aW9uIE1vZGVsIDEiKQ0KDQpgYGANCg0KYGBge3J9DQoNCkdPRl9keWFkcyA8LSB0c19keWFkc19ldm8oc2ltTmV0cywgd2F2ZV8xKSAlPiUgZmlsdGVyKHggIT0gIk51bGwuLi5OdWxsIikgJT4lIGdyb3VwX2J5KHNpbW5ldCkgJT4lIG11dGF0ZShzdGFuZCA9IHkvc3VtKHkpKQ0KDQpPQlNfZHlhZHMgPC0gdHNfZHlhZHNfZXZvKHdhdmVfMiwgd2F2ZV8xKSAlPiUgZmlsdGVyKHggIT0gIk51bGwuLi5OdWxsIikgJT4lIG11dGF0ZShzdGFuZCA9IHkvc3VtKHkpKSAlPiUgc2VsZWN0KHgseSxzdGFuZCkNCg0KDQpHT0ZfcGxvdF9NMSA8LSBHT0ZfZHlhZHMgJT4lIGxlZnRfam9pbihPQlNfZHlhZHMsIGJ5ID0gIngiKQ0KYGBgDQoNCmBgYHtyLCBmaWcud2lkdGg9OX0NCg0KcF9NMSA8LSBnZ3Bsb3QoR09GX3Bsb3RfTTEsIGFlcyh4PXgsIHk9eS54KSApICsgDQogIGdlb21fdmlvbGluKGZpbGwgPSAiZ3JleSIsIHBvc2l0aW9uPXBvc2l0aW9uX2RvZGdlKC44KSkgKw0KICBzdGF0X3N1bW1hcnkoZnVuID0gbWVhbiwNCiAgICAgICAgICAgICAgIGdlb20gPSAiZXJyb3JiYXIiLA0KICAgICAgICAgICAgICAgZnVuLm1heCA9IGZ1bmN0aW9uKHgpIG1lYW4oeCkgKyBzZCh4KSwNCiAgICAgICAgICAgICAgIGZ1bi5taW4gPSBmdW5jdGlvbih4KSBtZWFuKHgpIC0gc2QoeCksDQogICAgICAgICAgICAgICB3aWR0aD0uMSwNCiAgICAgICAgICAgICAgIGNvbG9yPSJyZWQiLCBwb3NpdGlvbj1wb3NpdGlvbl9kb2RnZSguOCkpICsgDQogIHN0YXRfc3VtbWFyeShmdW4gPSBtZWFuLA0KICAgICAgICAgICAgICAgZ2VvbSA9ICJwb2ludCIsDQogICAgICAgICAgICAgICBjb2xvcj0icmVkIiwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArIA0KICBzdGF0X3N1bW1hcnkoIGFlcyh4PXgsIHk9eS55LCBncm91cCA9IDEpLCBmdW4gPSBtZWFuLA0KICAgICAgICAgICAgICAgIGdlb20gPSAicG9pbnQiLA0KICAgICAgICAgICAgICAgIGNvbG9yPSJncmVlbiIsIHNpemUgPSAzLCBzaGFwZT0xMCwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArIA0KICBsYWJzKHggPSAiRHlhZCBDZW5zdXMiLCB5ID0gIk4iKSArDQogICMgc2NhbGVfeF9kaXNjcmV0ZShndWlkZSA9IGd1aWRlX2F4aXMobi5kb2RnZSA9IDIpKSArDQogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNjAsICB2anVzdCA9IDAuNSkpICsgICANCiAgdGhlbWVfbWluaW1hbCgpDQoNCnBfTTENCg0KYGBgDQoNCiMjIE1vZGVsIDINCg0KTW9kZWwgMiBzaG93cyBzb21lIGluY3JlYXNlIGluIHRoZSBwLXZhbHVlIG9mIHRoZSBpbmRlZ3JlZSBkaXN0cmlidXRpb24gKHAgPSAwLjE4NCksIGluZGljYXRpbmcgdGhhdCB0aGUgR09GIGlzIGltcHJvdmluZy4gVGhpcyBpcyBtYWlubHkgdmlzaWJsZSBmb3IgYWN0b3JzIHdpdGggMiBvciBtb3JlIGluZGVncmVlcywgd2hvIGFyZSBub3QgYXMgb3ZlcmVzdGltYXRlZCBhcyBpbiB0aGUgcHJldmlvdXMgbW9kZWxzLiBUaGUgR09GIGZvciB0aGUgZHlhZCBjZW5zdXMgaXMgc2ltaWxhciB0byB0aGUgb3RoZXIgbW9kZWxzIGluIHRlcm1zIG9mIHRoZSBkaWZmZXJlbmNlcyBiZXR3ZWVuIHRoZSBvYnNlcnZlZCBhbmQgZXhwZWN0ZWQgdHJhbnNpdGlvbnMuIEhvd2V2ZXIsIHRoZSB2aW9saW4gcGxvdHMgYXJlIGdldHRpbmcgc21hbGxlciwgaW5kaWNhdGluZyB0aGVyZSB0aGVyZSBpcyBsZXNzIHZhcmlhYmlsaXR5IGJldHdlZW4gdGhlIHNpbXVsYXRpb25zLg0KDQpgYGB7cn0NCg0Kc2ltTmV0cyA8LSBsaXN0KCkNCmZvciAoaSBpbiAxOjEwMDApIHsNCiAgDQogIHNpbU5ldHNbW2ldXSA9IGdldE5ldCgxMDAsIGFuc19NMiRzaW1zW1tpXV1bWyJEYXRhMSJdXVtbIm5ldCJdXVtbIjEiXV0pDQogIA0KfQ0KDQpgYGANCg0KYGBge3J9DQpHT0ZfTTIgPC0gc2llbmFHT0YoYW5zX00yLCBJbmRlZ3JlZURpc3RyaWJ1dGlvbiwgdmVyYm9zZSA9IEZBTFNFLCBqb2luID0gVFJVRSwgdmFyTmFtZSA9ICJuZXQiKQ0KDQpwbG90KEdPRl9NMiwgbWFpbiA9ICJJbmRlZ3JlZSBEaXN0cmlidXRpb24gTW9kZWwgMiIpDQoNCmBgYA0KDQpgYGB7cn0NCg0KR09GX2R5YWRzIDwtIHRzX2R5YWRzX2V2byhzaW1OZXRzLCB3YXZlXzEpICU+JSBmaWx0ZXIoeCAhPSAiTnVsbC4uLk51bGwiKSAlPiUgZ3JvdXBfYnkoc2ltbmV0KSAlPiUgbXV0YXRlKHN0YW5kID0geS9zdW0oeSkpDQoNCk9CU19keWFkcyA8LSB0c19keWFkc19ldm8od2F2ZV8yLCB3YXZlXzEpICU+JSBmaWx0ZXIoeCAhPSAiTnVsbC4uLk51bGwiKSAlPiUgbXV0YXRlKHN0YW5kID0geS9zdW0oeSkpICU+JSBzZWxlY3QoeCx5LHN0YW5kKQ0KDQoNCkdPRl9wbG90X00yIDwtIEdPRl9keWFkcyAlPiUgbGVmdF9qb2luKE9CU19keWFkcywgYnkgPSAieCIpDQpgYGANCg0KYGBge3IsIGZpZy53aWR0aD05fQ0KDQpwX00yIDwtIGdncGxvdChHT0ZfcGxvdF9NMiwgYWVzKHg9eCwgeT15LngpICkgKyANCiAgZ2VvbV92aW9saW4oZmlsbCA9ICJncmV5IiwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArDQogIHN0YXRfc3VtbWFyeShmdW4gPSBtZWFuLA0KICAgICAgICAgICAgICAgZ2VvbSA9ICJlcnJvcmJhciIsDQogICAgICAgICAgICAgICBmdW4ubWF4ID0gZnVuY3Rpb24oeCkgbWVhbih4KSArIHNkKHgpLA0KICAgICAgICAgICAgICAgZnVuLm1pbiA9IGZ1bmN0aW9uKHgpIG1lYW4oeCkgLSBzZCh4KSwNCiAgICAgICAgICAgICAgIHdpZHRoPS4xLA0KICAgICAgICAgICAgICAgY29sb3I9InJlZCIsIHBvc2l0aW9uPXBvc2l0aW9uX2RvZGdlKC44KSkgKyANCiAgc3RhdF9zdW1tYXJ5KGZ1biA9IG1lYW4sDQogICAgICAgICAgICAgICBnZW9tID0gInBvaW50IiwNCiAgICAgICAgICAgICAgIGNvbG9yPSJyZWQiLCBwb3NpdGlvbj1wb3NpdGlvbl9kb2RnZSguOCkpICsgDQogIHN0YXRfc3VtbWFyeSggYWVzKHg9eCwgeT15LnkpLCBmdW4gPSBtZWFuLA0KICAgICAgICAgICAgICAgIGdlb20gPSAicG9pbnQiLA0KICAgICAgICAgICAgICAgIGNvbG9yPSJncmVlbiIsIHNpemUgPSAzLCBzaGFwZT0xMCwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArIA0KICBsYWJzKHggPSAiRHlhZCBDZW5zdXMiLCB5ID0gIk4iKSArDQogICMgc2NhbGVfeF9kaXNjcmV0ZShndWlkZSA9IGd1aWRlX2F4aXMobi5kb2RnZSA9IDIpKSArDQogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsICB2anVzdCA9IDAuNSwpKSArICAgDQogIHRoZW1lX21pbmltYWwoKQ0KDQpwX00yDQoNCmBgYA0KDQojIyBNb2RlbCAyLjUNCg0KQXMgc3RhdGVkIGluIHRoZSByZXN1bHQgc2VjdGlvbiwgTW9kZWwgMi41IGhhcyBhIHNpZ25pZmljYW50IGluY3JlYXNlIGluIHRoZSBHT0YsIGR1ZSB0byB0aGUgaW5kZWdyZWUgcG9wdWxhcml0eSBzcXVhcmVkIHBhcmFtZXRlciwgd2hpY2ggaXMga25vd24gdG8gaGF2ZSBhIGJldHRlciBmaXQgdGhhbiB0aGUgbm9ybWFsIHZlcnNpb24gW0ByaXBsZXkyMDExbWFudWFsXS4gVGhpcyBtb2RlbCBoYXMgYSBwLXZhbHVlIG9mIDAuODkxIGZvciB0aGUgaW5kZWdyZWUgZGlzdHJpYnV0aW9uLCB3aXRoIGFsbCBhY3RvcnMgd2l0aCAxIG9yIG1vcmUgaW5kZWdyZWVzIGJlaW5nIGVzdGltYXRlZCBjb3JyZWN0bHkgKG9yIGF0IGxlYXN0IHdpdGhpbiBRMS1RMykuIFRoZSBvbmx5IGV4Y2VwdGlvbiBhcmUgdGhlIGlzb2xhdGVzLCB3aGljaCBhcmUgc3RpbGwgdW5kZXJlc3RpbWF0ZWQuIEhvd2V2ZXIsIGl0IHNob3VsZCBiZSBub3RlZCB0aGF0IHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIG9ic2VydmVkIGFuZCBleHBlY3RlZCBpc29sYXRlcyBpcyBtdWNoIGxvd2VyIHRoYW4gdGhlIHByZXZpb3VzIG1vZGVscy5cDQomZW1zcDsgTW9kZWwgMi41IGlzIGxlc3MgYWNjdXJhdGUgd2l0aCByZWdhcmQgdG8gdGhlIEdPRiBvZiB0aGUgZHlhZCBjZW5zdXMuIEFwYXJ0IGZyb20gdGhlIHRyYW5zaXRpb24gIipBc3N5bSBcPiBBc3N5bSoiIGFuZCAiKk11dHVhbCBcPiBOdWxsKiIsIGFsbCBvYnNlcnZlZCBkeWFkaWMgdHJhbnNpdGlvbnMgYXJlIG5vdCB3aXRoaW4gMSBzdGFuZGFyZCBkZXZpYXRpb24gb2YgdGhlIHNpbXVsYXRlZCB0cmFuc2l0aW9ucy4gVGhlIG1vZGVsIGlzIHBhcnRpY3VsYXJseSBiYWQgYXQgZXN0aW1hdGluZyB0aGUgdHJhbnNpdGlvbiBmcm9tICIqQXNzeW0gXD4gTnVsbCoiIGFuZCAqIk51bGwgXD4gQXNzeW0iLCogd2hpY2ggYXJlIGJvdGggb3ZlcmVzdGltYXRlZCBjb21wYXJlZCB0byB0aGUgb2JzZXJ2ZWQgdHJhbnNpc3Rpb25zKi4qDQoNCmBgYHtyfQ0KDQpzaW1OZXRzIDwtIGxpc3QoKQ0KZm9yIChpIGluIDE6MTAwMCkgew0KICANCiAgc2ltTmV0c1tbaV1dID0gZ2V0TmV0KDEwMCwgYW5zX00yLjUkc2ltc1tbaV1dW1siRGF0YTEiXV1bWyJuZXQiXV1bWyIxIl1dKQ0KICANCn0NCg0KYGBgDQoNCmBgYHtyfQ0KR09GX00yLjUgPC0gc2llbmFHT0YoYW5zX00yLjUsIEluZGVncmVlRGlzdHJpYnV0aW9uLCB2ZXJib3NlID0gRkFMU0UsIGpvaW4gPSBUUlVFLCB2YXJOYW1lID0gIm5ldCIpDQoNCnBsb3QoR09GX00yLjUsIG1haW4gPSAiSW5kZWdyZWUgRGlzdHJpYnV0aW9uIE1vZGVsIDIuNSIpDQoNCmBgYA0KDQpgYGB7cn0NCg0KR09GX2R5YWRzIDwtIHRzX2R5YWRzX2V2byhzaW1OZXRzLCB3YXZlXzEpICU+JSBmaWx0ZXIoeCAhPSAiTnVsbC4uLk51bGwiKSAlPiUgZ3JvdXBfYnkoc2ltbmV0KSAlPiUgbXV0YXRlKHN0YW5kID0geS9zdW0oeSkpDQoNCk9CU19keWFkcyA8LSB0c19keWFkc19ldm8od2F2ZV8yLCB3YXZlXzEpICU+JSBmaWx0ZXIoeCAhPSAiTnVsbC4uLk51bGwiKSAlPiUgbXV0YXRlKHN0YW5kID0geS9zdW0oeSkpICU+JSBzZWxlY3QoeCx5LHN0YW5kKQ0KDQoNCkdPRl9wbG90X00yLjUgPC0gR09GX2R5YWRzICU+JSBsZWZ0X2pvaW4oT0JTX2R5YWRzLCBieSA9ICJ4IikNCmBgYA0KDQpgYGB7ciwgZmlnLndpZHRoPTl9DQoNCnBfTTIuNSA8LSBnZ3Bsb3QoR09GX3Bsb3RfTTIuNSwgYWVzKHg9eCwgeT15LngpICkgKyANCiAgZ2VvbV92aW9saW4oZmlsbCA9ICJncmV5IiwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArDQogIHN0YXRfc3VtbWFyeShmdW4gPSBtZWFuLA0KICAgICAgICAgICAgICAgZ2VvbSA9ICJlcnJvcmJhciIsDQogICAgICAgICAgICAgICBmdW4ubWF4ID0gZnVuY3Rpb24oeCkgbWVhbih4KSArIHNkKHgpLA0KICAgICAgICAgICAgICAgZnVuLm1pbiA9IGZ1bmN0aW9uKHgpIG1lYW4oeCkgLSBzZCh4KSwNCiAgICAgICAgICAgICAgIHdpZHRoPS4xLA0KICAgICAgICAgICAgICAgY29sb3I9InJlZCIsIHBvc2l0aW9uPXBvc2l0aW9uX2RvZGdlKC44KSkgKyANCiAgc3RhdF9zdW1tYXJ5KGZ1biA9IG1lYW4sDQogICAgICAgICAgICAgICBnZW9tID0gInBvaW50IiwNCiAgICAgICAgICAgICAgIGNvbG9yPSJyZWQiLCBwb3NpdGlvbj1wb3NpdGlvbl9kb2RnZSguOCkpICsgDQogIHN0YXRfc3VtbWFyeSggYWVzKHg9eCwgeT15LnkpLCBmdW4gPSBtZWFuLA0KICAgICAgICAgICAgICAgIGdlb20gPSAicG9pbnQiLA0KICAgICAgICAgICAgICAgIGNvbG9yPSJncmVlbiIsIHNpemUgPSAzLCBzaGFwZT0xMCwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArIA0KICBsYWJzKHggPSAiRHlhZCBDZW5zdXMiLCB5ID0gIk4iKSArDQogICMgc2NhbGVfeF9kaXNjcmV0ZShndWlkZSA9IGd1aWRlX2F4aXMobi5kb2RnZSA9IDIpKSArDQogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsICB2anVzdCA9IDAuNSwpKSArICAgDQogIHRoZW1lX21pbmltYWwoKQ0KDQpwX00yLjUNCg0KYGBgDQoNCiMjIE1vZGVsIDMNCg0KYGBge3J9DQoNCnNpbU5ldHMgPC0gbGlzdCgpDQpmb3IgKGkgaW4gMToxMDAwKSB7DQogIA0KICBzaW1OZXRzW1tpXV0gPSBnZXROZXQoMTAwLCBhbnNfTTMkc2ltc1tbaV1dW1siRGF0YTEiXV1bWyJuZXQiXV1bWyIxIl1dKQ0KICANCn0NCg0KYGBgDQoNCmBgYHtyfQ0KR09GX00zIDwtIHNpZW5hR09GKGFuc19NMywgSW5kZWdyZWVEaXN0cmlidXRpb24sIHZlcmJvc2UgPSBGQUxTRSwgam9pbiA9IFRSVUUsIHZhck5hbWUgPSAibmV0IikNCg0KcGxvdChHT0ZfTTMsIG1haW4gPSAiSW5kZWdyZWUgRGlzdHJpYnV0aW9uIE1vZGVsIDMiKQ0KDQpgYGANCg0KYGBge3J9DQoNCkdPRl9keWFkcyA8LSB0c19keWFkc19ldm8oc2ltTmV0cywgd2F2ZV8xKSAlPiUgZmlsdGVyKHggIT0gIk51bGwuLi5OdWxsIikgJT4lIGdyb3VwX2J5KHNpbW5ldCkgJT4lIG11dGF0ZShzdGFuZCA9IHkvc3VtKHkpKQ0KDQpPQlNfZHlhZHMgPC0gdHNfZHlhZHNfZXZvKHdhdmVfMiwgd2F2ZV8xKSAlPiUgZmlsdGVyKHggIT0gIk51bGwuLi5OdWxsIikgJT4lIG11dGF0ZShzdGFuZCA9IHkvc3VtKHkpKSAlPiUgc2VsZWN0KHgseSxzdGFuZCkNCg0KDQpHT0ZfcGxvdF9NMyA8LSBHT0ZfZHlhZHMgJT4lIGxlZnRfam9pbihPQlNfZHlhZHMsIGJ5ID0gIngiKQ0KYGBgDQoNCmBgYHtyLCBmaWcud2lkdGg9OX0NCg0KcF9NMyA8LSBnZ3Bsb3QoR09GX3Bsb3RfTTMsIGFlcyh4PXgsIHk9eS54KSApICsgDQogIGdlb21fdmlvbGluKGZpbGwgPSAiZ3JleSIsIHBvc2l0aW9uPXBvc2l0aW9uX2RvZGdlKC44KSkgKw0KICBzdGF0X3N1bW1hcnkoZnVuID0gbWVhbiwNCiAgICAgICAgICAgICAgIGdlb20gPSAiZXJyb3JiYXIiLA0KICAgICAgICAgICAgICAgZnVuLm1heCA9IGZ1bmN0aW9uKHgpIG1lYW4oeCkgKyBzZCh4KSwNCiAgICAgICAgICAgICAgIGZ1bi5taW4gPSBmdW5jdGlvbih4KSBtZWFuKHgpIC0gc2QoeCksDQogICAgICAgICAgICAgICB3aWR0aD0uMSwNCiAgICAgICAgICAgICAgIGNvbG9yPSJyZWQiLCBwb3NpdGlvbj1wb3NpdGlvbl9kb2RnZSguOCkpICsgDQogIHN0YXRfc3VtbWFyeShmdW4gPSBtZWFuLA0KICAgICAgICAgICAgICAgZ2VvbSA9ICJwb2ludCIsDQogICAgICAgICAgICAgICBjb2xvcj0icmVkIiwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArIA0KICBzdGF0X3N1bW1hcnkoIGFlcyh4PXgsIHk9eS55KSwgZnVuID0gbWVhbiwNCiAgICAgICAgICAgICAgICBnZW9tID0gInBvaW50IiwNCiAgICAgICAgICAgICAgICBjb2xvcj0iZ3JlZW4iLCBzaXplID0gMywgc2hhcGU9MTAsIHBvc2l0aW9uPXBvc2l0aW9uX2RvZGdlKC44KSkgKyANCiAgbGFicyh4ID0gIkR5YWQgQ2Vuc3VzIiwgeSA9ICJOIikgKw0KICAjIHNjYWxlX3hfZGlzY3JldGUoZ3VpZGUgPSBndWlkZV9heGlzKG4uZG9kZ2UgPSAyKSkgKw0KICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCB2anVzdCA9IDAuNSwpKSArDQogIHRoZW1lX21pbmltYWwoKQ0KDQpwX00zDQoNCmBgYA0KDQojIyBNb2RlbCA0DQoNCmBgYHtyfQ0KDQpzaW1OZXRzIDwtIGxpc3QoKQ0KZm9yIChpIGluIDE6MTAwMCkgew0KICANCiAgc2ltTmV0c1tbaV1dID0gZ2V0TmV0KDEwMCwgYW5zX000JHNpbXNbW2ldXVtbIkRhdGExIl1dW1sibmV0Il1dW1siMSJdXSkNCiAgDQp9DQoNCmBgYA0KDQpgYGB7cn0NCkdPRl9NNCA8LSBzaWVuYUdPRihhbnNfTTQsIEluZGVncmVlRGlzdHJpYnV0aW9uLCB2ZXJib3NlID0gRkFMU0UsIGpvaW4gPSBUUlVFLCB2YXJOYW1lID0gIm5ldCIpDQoNCnBsb3QoR09GX000LCBtYWluID0gIkluZGVncmVlIERpc3RyaWJ1dGlvbiBNb2RlbCA0IikNCg0KYGBgDQoNCmBgYHtyfQ0KDQpHT0ZfZHlhZHMgPC0gdHNfZHlhZHNfZXZvKHNpbU5ldHMsIHdhdmVfMSkgJT4lIGZpbHRlcih4ICE9ICJOdWxsLi4uTnVsbCIpICU+JSBncm91cF9ieShzaW1uZXQpICU+JSBtdXRhdGUoc3RhbmQgPSB5L3N1bSh5KSkNCg0KT0JTX2R5YWRzIDwtIHRzX2R5YWRzX2V2byh3YXZlXzIsIHdhdmVfMSkgJT4lIGZpbHRlcih4ICE9ICJOdWxsLi4uTnVsbCIpICU+JSBtdXRhdGUoc3RhbmQgPSB5L3N1bSh5KSkgJT4lIHNlbGVjdCh4LHksc3RhbmQpDQoNCg0KR09GX3Bsb3RfTTQgPC0gR09GX2R5YWRzICU+JSBsZWZ0X2pvaW4oT0JTX2R5YWRzLCBieSA9ICJ4IikNCmBgYA0KDQpgYGB7ciwgZmlnLndpZHRoPTl9DQoNCnBfTTQgPC0gZ2dwbG90KEdPRl9wbG90X000LCBhZXMoeD14LCB5PXkueCkgKSArIA0KICBnZW9tX3Zpb2xpbihmaWxsID0gImdyZXkiLCBwb3NpdGlvbj1wb3NpdGlvbl9kb2RnZSguOCkpICsNCiAgc3RhdF9zdW1tYXJ5KGZ1biA9IG1lYW4sDQogICAgICAgICAgICAgICBnZW9tID0gImVycm9yYmFyIiwNCiAgICAgICAgICAgICAgIGZ1bi5tYXggPSBmdW5jdGlvbih4KSBtZWFuKHgpICsgc2QoeCksDQogICAgICAgICAgICAgICBmdW4ubWluID0gZnVuY3Rpb24oeCkgbWVhbih4KSAtIHNkKHgpLA0KICAgICAgICAgICAgICAgd2lkdGg9LjEsDQogICAgICAgICAgICAgICBjb2xvcj0icmVkIiwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArIA0KICBzdGF0X3N1bW1hcnkoZnVuID0gbWVhbiwNCiAgICAgICAgICAgICAgIGdlb20gPSAicG9pbnQiLA0KICAgICAgICAgICAgICAgY29sb3I9InJlZCIsIHBvc2l0aW9uPXBvc2l0aW9uX2RvZGdlKC44KSkgKyANCiAgc3RhdF9zdW1tYXJ5KCBhZXMoeD14LCB5PXkueSksIGZ1biA9IG1lYW4sDQogICAgICAgICAgICAgICAgZ2VvbSA9ICJwb2ludCIsDQogICAgICAgICAgICAgICAgY29sb3I9ImdyZWVuIiwgc2l6ZSA9IDMsIHNoYXBlPTEwLCBwb3NpdGlvbj1wb3NpdGlvbl9kb2RnZSguOCkpICsgDQogIGxhYnMoeCA9ICJEeWFkIENlbnN1cyIsIHkgPSAiTiIpICsNCiAgIyBzY2FsZV94X2Rpc2NyZXRlKGd1aWRlID0gZ3VpZGVfYXhpcyhuLmRvZGdlID0gMikpICsNCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgIHZqdXN0ID0gMC41LCkpICsgICANCiAgdGhlbWVfbWluaW1hbCgpDQoNCnBfTTQNCg0KYGBgDQoNCiMjIE1vZGVsIDUNCg0KYGBge3J9DQoNCnNpbU5ldHMgPC0gbGlzdCgpDQpmb3IgKGkgaW4gMToxMDAwKSB7DQogIA0KICBzaW1OZXRzW1tpXV0gPSBnZXROZXQoMTAwLCBhbnNfTTUkc2ltc1tbaV1dW1siRGF0YTEiXV1bWyJuZXQiXV1bWyIxIl1dKQ0KICANCn0NCg0KYGBgDQoNCmBgYHtyfQ0KR09GX001IDwtIHNpZW5hR09GKGFuc19NNSwgSW5kZWdyZWVEaXN0cmlidXRpb24sIHZlcmJvc2UgPSBGQUxTRSwgam9pbiA9IFRSVUUsIHZhck5hbWUgPSAibmV0IikNCg0KcGxvdChHT0ZfTTUsIG1haW4gPSAiSW5kZWdyZWUgRGlzdHJpYnV0aW9uIE1vZGVsIDUiKQ0KDQpgYGANCg0KYGBge3J9DQoNCkdPRl9keWFkcyA8LSB0c19keWFkc19ldm8oc2ltTmV0cywgd2F2ZV8xKSAlPiUgZmlsdGVyKHggIT0gIk51bGwuLi5OdWxsIikgJT4lIGdyb3VwX2J5KHNpbW5ldCkgJT4lIG11dGF0ZShzdGFuZCA9IHkvc3VtKHkpKQ0KDQpPQlNfZHlhZHMgPC0gdHNfZHlhZHNfZXZvKHdhdmVfMiwgd2F2ZV8xKSAlPiUgZmlsdGVyKHggIT0gIk51bGwuLi5OdWxsIikgJT4lIG11dGF0ZShzdGFuZCA9IHkvc3VtKHkpKSAlPiUgc2VsZWN0KHgseSxzdGFuZCkNCg0KDQpHT0ZfcGxvdF9NNSA8LSBHT0ZfZHlhZHMgJT4lIGxlZnRfam9pbihPQlNfZHlhZHMsIGJ5ID0gIngiKQ0KYGBgDQoNCmBgYHtyLCBmaWcud2lkdGg9OX0NCg0KcF9NNSA8LSBnZ3Bsb3QoR09GX3Bsb3RfTTUsIGFlcyh4PXgsIHk9eS54KSApICsgDQogIGdlb21fdmlvbGluKGZpbGwgPSAiZ3JleSIsIHBvc2l0aW9uPXBvc2l0aW9uX2RvZGdlKC44KSkgKw0KICBzdGF0X3N1bW1hcnkoZnVuID0gbWVhbiwNCiAgICAgICAgICAgICAgIGdlb20gPSAiZXJyb3JiYXIiLA0KICAgICAgICAgICAgICAgZnVuLm1heCA9IGZ1bmN0aW9uKHgpIG1lYW4oeCkgKyBzZCh4KSwNCiAgICAgICAgICAgICAgIGZ1bi5taW4gPSBmdW5jdGlvbih4KSBtZWFuKHgpIC0gc2QoeCksDQogICAgICAgICAgICAgICB3aWR0aD0uMSwNCiAgICAgICAgICAgICAgIGNvbG9yPSJyZWQiLCBwb3NpdGlvbj1wb3NpdGlvbl9kb2RnZSguOCkpICsgDQogIHN0YXRfc3VtbWFyeShmdW4gPSBtZWFuLA0KICAgICAgICAgICAgICAgZ2VvbSA9ICJwb2ludCIsDQogICAgICAgICAgICAgICBjb2xvcj0icmVkIiwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArIA0KICBzdGF0X3N1bW1hcnkoIGFlcyh4PXgsIHk9eS55KSwgZnVuID0gbWVhbiwNCiAgICAgICAgICAgICAgICBnZW9tID0gInBvaW50IiwNCiAgICAgICAgICAgICAgICBjb2xvcj0iZ3JlZW4iLCBzaXplID0gMywgc2hhcGU9MTAsIHBvc2l0aW9uPXBvc2l0aW9uX2RvZGdlKC44KSkgKyANCiAgbGFicyh4ID0gIkR5YWQgQ2Vuc3VzIiwgeSA9ICJOIikgKw0KICAjIHNjYWxlX3hfZGlzY3JldGUoZ3VpZGUgPSBndWlkZV9heGlzKG4uZG9kZ2UgPSAyKSkgKw0KICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCAgdmp1c3QgPSAwLjUsKSkgKyAgIA0KICB0aGVtZV9taW5pbWFsKCkNCg0KcF9NNQ0KDQpgYGANCg0KYGBge3J9DQojIFRFU1QNCiMgcF9NMSA8LSBnZ3Bsb3QoR09GX3Bsb3QsIGFlcyh4PXgsIHk9eS54KSApICsgDQojICAgZ2VvbV92aW9saW4oZmlsbCA9ICJncmV5IiwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArDQojICAgc3RhdF9zdW1tYXJ5KGZ1biA9IG1lYW4sDQojICAgICAgICAgICAgICAgIGdlb20gPSAiZXJyb3JiYXIiLA0KIyAgICAgICAgICAgICAgICBmdW4ubWF4ID0gZnVuY3Rpb24oeCkgbWVhbih4KSArIHNkKHgpLA0KIyAgICAgICAgICAgICAgICBmdW4ubWluID0gZnVuY3Rpb24oeCkgbWVhbih4KSAtIHNkKHgpLA0KIyAgICAgICAgICAgICAgICB3aWR0aD0uMSwNCiMgICAgICAgICAgICAgICAgY29sb3I9InJlZCIsIHBvc2l0aW9uPXBvc2l0aW9uX2RvZGdlKC44KSkgKyANCiMgICBzdGF0X3N1bW1hcnkoIGFlcyh4PXgsIHk9eS54LCBncm91cCA9IDEpLCBmdW4gPSBtZWFuLA0KIyAgICAgICAgICAgICAgICBnZW9tID0gImxpbmUiLA0KIyAgICAgICAgICAgICAgICBjb2xvcj0icmVkIiwgcG9zaXRpb249cG9zaXRpb25fZG9kZ2UoLjgpKSArIA0KIyAgIHN0YXRfc3VtbWFyeSggYWVzKHg9eCwgeT15LnksIGdyb3VwID0gMSksIGZ1biA9IG1lYW4sDQojICAgICAgICAgICAgICAgICBnZW9tID0gImxpbmUiLA0KIyAgICAgICAgICAgICAgICAgY29sb3I9ImdyZWVuIiwgc2hhcGU9MTAsIHBvc2l0aW9uPXBvc2l0aW9uX2RvZGdlKC44KSkgKyANCiMgICBsYWJzKHggPSAiRHlhZCBDZW5zdXMiLCB5ID0gIk4iKSArDQojICAgIyBzY2FsZV94X2Rpc2NyZXRlKGd1aWRlID0gZ3VpZGVfYXhpcyhuLmRvZGdlID0gMikpICsNCiMgICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDYwLCAgdmp1c3QgPSAwLjUpKSArICAgDQojICAgdGhlbWVfbWluaW1hbCgpDQojIA0KIyBwX00xDQpgYGANCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Siena_GOF.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
