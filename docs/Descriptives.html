<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Niels Vullings" />


<title>Network Descriptives</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.26/datatables.js"></script>
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="tweaks.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Journal
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="cheat_sheet.html">Buddy's first markdown file</a>
    </li>
    <li>
      <a href="Week1.html">Week 1</a>
    </li>
    <li>
      <a href="Week2.html">Week 2</a>
    </li>
    <li>
      <a href="Week3-webscraping.html">Week 3</a>
    </li>
    <li>
      <a href="Week4.html">Week 4</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 5</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="Week5.html">Logic of SAOM</a>
        </li>
        <li>
          <a href="Week5_RSiena.html">RSiena</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="Week6.html">Week 6</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Preparation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Data_exploration.html">Data Exploration</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Data Manipulation</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="Data_preparation.html">Data Prep (Old)</a>
        </li>
        <li>
          <a href="Data_preparation_2.html">Data Prep (New)</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Paper (draft)
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Introduction2.html">Introduction</a>
    </li>
    <li>
      <a href="Theory.html">Theory</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Data</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="Data.html">Data</a>
        </li>
        <li>
          <a href="Descriptives.html">Descriptives</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-header">Results</li>
    <li class="dropdown-header">Conclusion</li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Niels-Vullings/labjournal">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Network Descriptives</h1>
<h4 class="author">Niels Vullings</h4>

</div>


<div id="load-udf" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Load UDF</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>colorize <span class="ot">&lt;-</span> <span class="cf">function</span>(x, color) {<span class="fu">sprintf</span>(<span class="st">&quot;&lt;span style=&#39;color: %s;&#39;&gt;%s&lt;/span&gt;&quot;</span>, color, x) }</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>fpackage.check <span class="ot">&lt;-</span> <span class="cf">function</span>(packages) {</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="fu">lapply</span>(packages, <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>      <span class="fu">install.packages</span>(x, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>      <span class="fu">library</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    }</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  })</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>}</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>fsave <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">file =</span> <span class="cn">NULL</span>, <span class="at">location =</span> <span class="st">&quot;./data/processed/&quot;</span>) {</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">&quot;data&quot;</span>), <span class="fu">dir.create</span>(<span class="st">&quot;data&quot;</span>), <span class="cn">FALSE</span>)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">&quot;data/processed&quot;</span>), <span class="fu">dir.create</span>(<span class="st">&quot;data/processed&quot;</span>), <span class="cn">FALSE</span>)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(file))</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>    file <span class="ot">=</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(x))</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  datename <span class="ot">&lt;-</span> <span class="fu">substr</span>(<span class="fu">gsub</span>(<span class="st">&quot;[:-]&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">Sys.time</span>()), <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  totalname <span class="ot">&lt;-</span> <span class="fu">paste</span>(location, datename, file, <span class="st">&quot;.rda&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  <span class="fu">save</span>(x, <span class="at">file =</span> totalname)  <span class="co">#need to fix if file is reloaded as input name, not as x. </span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>}</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>fload <span class="ot">&lt;-</span> <span class="cf">function</span>(filename) {</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>  <span class="fu">load</span>(filename)</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>  <span class="fu">get</span>(<span class="fu">ls</span>()[<span class="fu">ls</span>() <span class="sc">!=</span> <span class="st">&quot;filename&quot;</span>])</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>}</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>fshowdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(x, <span class="at">digits =</span> <span class="dv">2</span>, <span class="st">&quot;html&quot;</span>, ...) <span class="sc">%&gt;%</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>, <span class="at">height =</span> <span class="st">&quot;300px&quot;</span>)</span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>}</span></code></pre></div>
<div id="network-statistics-functions" class="section level2"
number="1.1">
<h2><span class="header-section-number">1.1</span> Network Statistics
functions</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#---- Jaccard Index ----</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>fjac <span class="ot">&lt;-</span> <span class="cf">function</span>(net1, net2) {</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="fu">diag</span>(net1) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="fu">diag</span>(net2) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  tj <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(net1), <span class="fu">as.numeric</span>(net2)) </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  jaccard <span class="ot">&lt;-</span> tj[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">/</span>(tj[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> tj[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> tj[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  hamming <span class="ot">&lt;-</span> tj[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> tj[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  </span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="fu">return</span>(jaccard)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>}</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#---- Hamming Distance ----</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>fham <span class="ot">&lt;-</span> <span class="cf">function</span>(net1, net2) {</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>  <span class="fu">diag</span>(net1) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>  <span class="fu">diag</span>(net2) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>  tj <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(net1), <span class="fu">as.numeric</span>(net2)) </span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>  hamming <span class="ot">&lt;-</span> tj[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> tj[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>  </span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>  <span class="fu">return</span>(hamming)</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>  </span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>}</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#---- Density ----</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>fdens <span class="ot">&lt;-</span> <span class="cf">function</span>(N, <span class="at">data =</span> net, <span class="at">directed =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>  </span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>  <span class="cf">if</span> (directed <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>    pos_tie <span class="ot">&lt;-</span> (N <span class="sc">*</span> (N <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>    pos_tie <span class="ot">&lt;-</span> (N <span class="sc">*</span> (N <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>    </span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>  }</span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>  </span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>  obs_tie <span class="ot">&lt;-</span> <span class="fu">sum</span>(sna<span class="sc">::</span><span class="fu">dyad.census</span>(data)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>  dens <span class="ot">&lt;-</span> obs_tie<span class="sc">/</span>pos_tie</span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>  </span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>  <span class="fu">return</span>(dens)</span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>}</span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a><span class="co">#---- Moran&#39;s I ----</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a>fMoran.I <span class="ot">&lt;-</span> <span class="cf">function</span>(x, weight, <span class="at">scaled =</span> <span class="cn">FALSE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">rowstandardize =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a>  <span class="cf">if</span> (rowstandardize) {</span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">dim</span>(weight)[<span class="dv">1</span>] <span class="sc">!=</span> <span class="fu">dim</span>(weight)[<span class="dv">2</span>])</span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;&#39;weight&#39; must be a square matrix&quot;</span>)</span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">dim</span>(weight)[<span class="dv">1</span>] <span class="sc">!=</span> n)</span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;&#39;weight&#39; must have as many rows as observations in &#39;x&#39;&quot;</span>)</span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a>    ei <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a>    nas <span class="ot">&lt;-</span> <span class="fu">is.na</span>(x)</span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(nas)) {</span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a>      <span class="cf">if</span> (na.rm) {</span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a>        x <span class="ot">&lt;-</span> x[<span class="sc">!</span>nas]</span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> weight[<span class="sc">!</span>nas, <span class="sc">!</span>nas]</span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="st">&quot;&#39;x&#39; has missing values: maybe you wanted to set na.rm = TRUE?&quot;</span>)</span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">observed =</span> <span class="cn">NA</span>, <span class="at">expected =</span> ei, <span class="at">sd =</span> <span class="cn">NA</span>, <span class="at">p.value =</span> <span class="cn">NA</span>))</span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a>      }</span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a>    }</span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a>    ROWSUM <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(weight)</span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a>    ROWSUM[ROWSUM <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a>    weight <span class="ot">&lt;-</span> weight<span class="sc">/</span>ROWSUM</span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">sum</span>(weight)</span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a>    y <span class="ot">&lt;-</span> x <span class="sc">-</span> m</span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a>    cv <span class="ot">&lt;-</span> <span class="fu">sum</span>(weight <span class="sc">*</span> y <span class="sc">%o%</span> y)</span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">sum</span>(y<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a>    obs <span class="ot">&lt;-</span> (n<span class="sc">/</span>s) <span class="sc">*</span> (cv<span class="sc">/</span>v)</span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a>    <span class="cf">if</span> (scaled) {</span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a>      i.max <span class="ot">&lt;-</span> (n<span class="sc">/</span>s) <span class="sc">*</span> (<span class="fu">sd</span>(<span class="fu">rowSums</span>(weight) <span class="sc">*</span> y)<span class="sc">/</span><span class="fu">sqrt</span>(v<span class="sc">/</span>(n <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb2-72"><a href="#cb2-72" tabindex="-1"></a>      obs <span class="ot">&lt;-</span> obs<span class="sc">/</span>i.max</span>
<span id="cb2-73"><a href="#cb2-73" tabindex="-1"></a>    }</span>
<span id="cb2-74"><a href="#cb2-74" tabindex="-1"></a>    S1 <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>((weight <span class="sc">+</span> <span class="fu">t</span>(weight))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-75"><a href="#cb2-75" tabindex="-1"></a>    S2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">apply</span>(weight, <span class="dv">1</span>, sum) <span class="sc">+</span> <span class="fu">apply</span>(weight, <span class="dv">2</span>, sum))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-76"><a href="#cb2-76" tabindex="-1"></a>    s.sq <span class="ot">&lt;-</span> s<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb2-77"><a href="#cb2-77" tabindex="-1"></a>    k <span class="ot">&lt;-</span> (<span class="fu">sum</span>(y<span class="sc">^</span><span class="dv">4</span>)<span class="sc">/</span>n)<span class="sc">/</span>(v<span class="sc">/</span>n)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb2-78"><a href="#cb2-78" tabindex="-1"></a>    sdi <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">*</span> ((n<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> n <span class="sc">+</span> <span class="dv">3</span>) <span class="sc">*</span> S1 <span class="sc">-</span> n <span class="sc">*</span> S2 <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> s.sq) <span class="sc">-</span> k <span class="sc">*</span> (n <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> S1 <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> n <span class="sc">*</span></span>
<span id="cb2-79"><a href="#cb2-79" tabindex="-1"></a>                                                                           S2 <span class="sc">+</span> <span class="dv">6</span> <span class="sc">*</span> s.sq))<span class="sc">/</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">3</span>) <span class="sc">*</span> s.sq) <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>((n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb2-80"><a href="#cb2-80" tabindex="-1"></a>    alternative <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(alternative, <span class="fu">c</span>(<span class="st">&quot;two.sided&quot;</span>, <span class="st">&quot;less&quot;</span>, <span class="st">&quot;greater&quot;</span>))</span>
<span id="cb2-81"><a href="#cb2-81" tabindex="-1"></a>    pv <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(obs, <span class="at">mean =</span> ei, <span class="at">sd =</span> sdi)</span>
<span id="cb2-82"><a href="#cb2-82" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb2-83"><a href="#cb2-83" tabindex="-1"></a>      pv <span class="ot">&lt;-</span> <span class="cf">if</span> (obs <span class="sc">&lt;=</span> ei)</span>
<span id="cb2-84"><a href="#cb2-84" tabindex="-1"></a>        <span class="dv">2</span> <span class="sc">*</span> pv <span class="cf">else</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pv)</span>
<span id="cb2-85"><a href="#cb2-85" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb2-86"><a href="#cb2-86" tabindex="-1"></a>      pv <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> pv</span>
<span id="cb2-87"><a href="#cb2-87" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">observed =</span> obs, <span class="at">expected =</span> ei, <span class="at">sd =</span> sdi, <span class="at">p.value =</span> pv)</span>
<span id="cb2-88"><a href="#cb2-88" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-89"><a href="#cb2-89" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">dim</span>(weight)[<span class="dv">1</span>] <span class="sc">!=</span> <span class="fu">dim</span>(weight)[<span class="dv">2</span>])</span>
<span id="cb2-90"><a href="#cb2-90" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;&#39;weight&#39; must be a square matrix&quot;</span>)</span>
<span id="cb2-91"><a href="#cb2-91" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb2-92"><a href="#cb2-92" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">dim</span>(weight)[<span class="dv">1</span>] <span class="sc">!=</span> n)</span>
<span id="cb2-93"><a href="#cb2-93" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;&#39;weight&#39; must have as many rows as observations in &#39;x&#39;&quot;</span>)</span>
<span id="cb2-94"><a href="#cb2-94" tabindex="-1"></a>    ei <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb2-95"><a href="#cb2-95" tabindex="-1"></a>    nas <span class="ot">&lt;-</span> <span class="fu">is.na</span>(x)</span>
<span id="cb2-96"><a href="#cb2-96" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(nas)) {</span>
<span id="cb2-97"><a href="#cb2-97" tabindex="-1"></a>      <span class="cf">if</span> (na.rm) {</span>
<span id="cb2-98"><a href="#cb2-98" tabindex="-1"></a>        x <span class="ot">&lt;-</span> x[<span class="sc">!</span>nas]</span>
<span id="cb2-99"><a href="#cb2-99" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb2-100"><a href="#cb2-100" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> weight[<span class="sc">!</span>nas, <span class="sc">!</span>nas]</span>
<span id="cb2-101"><a href="#cb2-101" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb2-102"><a href="#cb2-102" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="st">&quot;&#39;x&#39; has missing values: maybe you wanted to set na.rm = TRUE?&quot;</span>)</span>
<span id="cb2-103"><a href="#cb2-103" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">observed =</span> <span class="cn">NA</span>, <span class="at">expected =</span> ei, <span class="at">sd =</span> <span class="cn">NA</span>, <span class="at">p.value =</span> <span class="cn">NA</span>))</span>
<span id="cb2-104"><a href="#cb2-104" tabindex="-1"></a>      }</span>
<span id="cb2-105"><a href="#cb2-105" tabindex="-1"></a>    }</span>
<span id="cb2-106"><a href="#cb2-106" tabindex="-1"></a>    <span class="co"># ROWSUM &lt;- rowSums(weight) ROWSUM[ROWSUM == 0] &lt;- 1 weight &lt;- weight/ROWSUM</span></span>
<span id="cb2-107"><a href="#cb2-107" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">sum</span>(weight)</span>
<span id="cb2-108"><a href="#cb2-108" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb2-109"><a href="#cb2-109" tabindex="-1"></a>    y <span class="ot">&lt;-</span> x <span class="sc">-</span> m</span>
<span id="cb2-110"><a href="#cb2-110" tabindex="-1"></a>    cv <span class="ot">&lt;-</span> <span class="fu">sum</span>(weight <span class="sc">*</span> y <span class="sc">%o%</span> y)</span>
<span id="cb2-111"><a href="#cb2-111" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">sum</span>(y<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-112"><a href="#cb2-112" tabindex="-1"></a>    obs <span class="ot">&lt;-</span> (n<span class="sc">/</span>s) <span class="sc">*</span> (cv<span class="sc">/</span>v)</span>
<span id="cb2-113"><a href="#cb2-113" tabindex="-1"></a>    <span class="cf">if</span> (scaled) {</span>
<span id="cb2-114"><a href="#cb2-114" tabindex="-1"></a>      i.max <span class="ot">&lt;-</span> (n<span class="sc">/</span>s) <span class="sc">*</span> (<span class="fu">sd</span>(<span class="fu">rowSums</span>(weight) <span class="sc">*</span> y)<span class="sc">/</span><span class="fu">sqrt</span>(v<span class="sc">/</span>(n <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb2-115"><a href="#cb2-115" tabindex="-1"></a>      obs <span class="ot">&lt;-</span> obs<span class="sc">/</span>i.max</span>
<span id="cb2-116"><a href="#cb2-116" tabindex="-1"></a>    }</span>
<span id="cb2-117"><a href="#cb2-117" tabindex="-1"></a>    S1 <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>((weight <span class="sc">+</span> <span class="fu">t</span>(weight))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-118"><a href="#cb2-118" tabindex="-1"></a>    S2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">apply</span>(weight, <span class="dv">1</span>, sum) <span class="sc">+</span> <span class="fu">apply</span>(weight, <span class="dv">2</span>, sum))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-119"><a href="#cb2-119" tabindex="-1"></a>    s.sq <span class="ot">&lt;-</span> s<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb2-120"><a href="#cb2-120" tabindex="-1"></a>    k <span class="ot">&lt;-</span> (<span class="fu">sum</span>(y<span class="sc">^</span><span class="dv">4</span>)<span class="sc">/</span>n)<span class="sc">/</span>(v<span class="sc">/</span>n)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb2-121"><a href="#cb2-121" tabindex="-1"></a>    sdi <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">*</span> ((n<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> n <span class="sc">+</span> <span class="dv">3</span>) <span class="sc">*</span> S1 <span class="sc">-</span> n <span class="sc">*</span> S2 <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> s.sq) <span class="sc">-</span> k <span class="sc">*</span> (n <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> S1 <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> n <span class="sc">*</span></span>
<span id="cb2-122"><a href="#cb2-122" tabindex="-1"></a>                                                                           S2 <span class="sc">+</span> <span class="dv">6</span> <span class="sc">*</span> s.sq))<span class="sc">/</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">3</span>) <span class="sc">*</span> s.sq) <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>((n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb2-123"><a href="#cb2-123" tabindex="-1"></a>    alternative <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(alternative, <span class="fu">c</span>(<span class="st">&quot;two.sided&quot;</span>, <span class="st">&quot;less&quot;</span>, <span class="st">&quot;greater&quot;</span>))</span>
<span id="cb2-124"><a href="#cb2-124" tabindex="-1"></a>    pv <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(obs, <span class="at">mean =</span> ei, <span class="at">sd =</span> sdi)</span>
<span id="cb2-125"><a href="#cb2-125" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb2-126"><a href="#cb2-126" tabindex="-1"></a>      pv <span class="ot">&lt;-</span> <span class="cf">if</span> (obs <span class="sc">&lt;=</span> ei)</span>
<span id="cb2-127"><a href="#cb2-127" tabindex="-1"></a>        <span class="dv">2</span> <span class="sc">*</span> pv <span class="cf">else</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pv)</span>
<span id="cb2-128"><a href="#cb2-128" tabindex="-1"></a>    <span class="cf">if</span> (alternative <span class="sc">==</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb2-129"><a href="#cb2-129" tabindex="-1"></a>      pv <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> pv</span>
<span id="cb2-130"><a href="#cb2-130" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">observed =</span> obs, <span class="at">expected =</span> ei, <span class="at">sd =</span> sdi, <span class="at">p.value =</span> pv)</span>
<span id="cb2-131"><a href="#cb2-131" tabindex="-1"></a>  }</span>
<span id="cb2-132"><a href="#cb2-132" tabindex="-1"></a>  </span>
<span id="cb2-133"><a href="#cb2-133" tabindex="-1"></a>  </span>
<span id="cb2-134"><a href="#cb2-134" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="custom-dyad-triad-census-function" class="section level2"
number="1.2">
<h2><span class="header-section-number">1.2</span> Custom Dyad &amp;
Triad census function</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#---- Dyad census ----</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ts_dyads_evo <span class="ot">&lt;-</span> <span class="cf">function</span> (sims, net1, <span class="at">simtype =</span> <span class="st">&quot;notypespecified&quot;</span>, <span class="at">forplot =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.list</span>(sims) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    nsims <span class="ot">&lt;-</span> <span class="fu">length</span>(sims)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  }</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    nsims <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  }</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  df <span class="ot">&lt;-</span> foreach<span class="sc">::</span><span class="fu">foreach</span>(<span class="dv">1</span><span class="sc">:</span>nsims, <span class="at">i =</span> iterators<span class="sc">::</span><span class="fu">icount</span>(), </span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>                         <span class="at">.combine =</span> <span class="st">&quot;rbind&quot;</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>                           </span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>                           <span class="cf">if</span> (<span class="fu">is.list</span>(sims) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>                             net2 <span class="ot">&lt;-</span> sims[[i]]</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>                             </span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>                           }</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>                           <span class="cf">else</span> {</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>                             net2 <span class="ot">&lt;-</span> sims</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>                           }</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>                           </span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>                           <span class="co">#find which values in the matrix are missing</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>                           N_NA <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(net1) <span class="sc">|</span> <span class="fu">is.na</span>(net2), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) <span class="co"># Identify normal NA values</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>                           S_NA <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(<span class="fu">which</span>(net1 <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> net2 <span class="sc">==</span> <span class="dv">10</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>])) <span class="co"># Identify Structural NAs</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>                           S_NA <span class="ot">&lt;-</span> <span class="fu">which</span>(S_NA<span class="sc">$</span>Freq <span class="sc">==</span> <span class="fu">nrow</span>(net1))</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>                           NA_rows <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.vector</span>(N_NA), <span class="fu">as.vector</span>(S_NA)) <span class="co"># save all actors in 1 vector</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>                           </span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>                           <span class="cf">if</span>(<span class="fu">length</span>(NA_rows)<span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>                             </span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>                             <span class="fu">warning</span>(<span class="fu">ncol</span>(net1)<span class="sc">-</span> <span class="fu">length</span>(NA_rows),<span class="st">&quot; actors will be analysed due to missing values. Following &quot;</span>, <span class="fu">length</span>(NA_rows), <span class="st">&quot; actors have been listwise deleted: &quot;</span>,<span class="fu">paste</span>(NA_rows, <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>))</span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>                             <span class="co"># Delete both rows and columns of actors that are missing (NA)</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>                             net1 <span class="ot">&lt;-</span> net1[<span class="sc">-</span>NA_rows,<span class="sc">-</span>NA_rows]</span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>                             </span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>                             net2 <span class="ot">&lt;-</span> net2[<span class="sc">-</span>NA_rows,<span class="sc">-</span>NA_rows]</span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a>                             </span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a>                           }</span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>                           <span class="fu">diag</span>(net1) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a>                           <span class="fu">diag</span>(net2) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a>                           flips <span class="ot">&lt;-</span> net1 <span class="sc">+</span> <span class="fu">t</span>(net2) <span class="sc">-</span> net2</span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>                           jumpst1 <span class="ot">&lt;-</span> net1 <span class="sc">+</span> <span class="fu">t</span>(net1)</span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a>                           stablet1 <span class="ot">&lt;-</span> jumpst1</span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>                           jumpst1[<span class="fu">lower.tri</span>(jumpst1)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a>                           jumpst2 <span class="ot">&lt;-</span> net2 <span class="sc">+</span> <span class="fu">t</span>(net2)</span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a>                           stablet2 <span class="ot">&lt;-</span> jumpst2</span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a>                           jumpst2[<span class="fu">lower.tri</span>(jumpst2)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a>                           stable00 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(jumpst1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> jumpst2 <span class="sc">==</span> </span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a>                                                             <span class="dv">0</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a>                           stable01 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(flips <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> stablet1 <span class="sc">==</span> </span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a>                                                             <span class="dv">1</span> <span class="sc">&amp;</span> stablet2 <span class="sc">==</span> <span class="dv">1</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a>                           stable11 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(jumpst1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> jumpst2 <span class="sc">==</span> </span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a>                                                             <span class="dv">2</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a>                           Null_Assym <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(jumpst1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> stablet2 <span class="sc">==</span> </span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a>                                                               <span class="dv">1</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a>                           Assym_Null <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(flips <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> stablet1 <span class="sc">==</span> </span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a>                                                               <span class="dv">1</span> <span class="sc">&amp;</span> stablet2 <span class="sc">==</span> <span class="dv">0</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a>                           Assym_Mut <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(stablet1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> jumpst2 <span class="sc">==</span> </span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a>                                                              <span class="dv">2</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a>                           Mut_Assym <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(jumpst1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> jumpst2 <span class="sc">==</span> </span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a>                                                              <span class="dv">1</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a>                           flip <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(flips <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> stablet1 <span class="sc">!=</span> </span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a>                                                         <span class="dv">2</span> <span class="sc">&amp;</span> stablet2 <span class="sc">!=</span> <span class="dv">2</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a>                           jump02 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(jumpst1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> jumpst2 <span class="sc">==</span> </span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a>                                                           <span class="dv">2</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a>                           jump20 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(jumpst1 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> jumpst2 <span class="sc">==</span> </span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a>                                                           <span class="dv">0</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a>                           table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">nrow</span>(stable00), <span class="fu">nrow</span>(stable01), <span class="fu">nrow</span>(stable11), </span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a>                                          <span class="fu">nrow</span>(Null_Assym), <span class="fu">nrow</span>(Assym_Null), <span class="fu">nrow</span>(Assym_Mut), </span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a>                                          <span class="fu">nrow</span>(Mut_Assym), <span class="fu">nrow</span>(flip), <span class="fu">nrow</span>(jump02), <span class="fu">nrow</span>(jump20))</span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a>                           <span class="fu">colnames</span>(table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Null &gt; Null&quot;</span>, <span class="st">&quot;Assym &gt; Assym&quot;</span>, <span class="st">&quot;Mutual &gt; Mutual&quot;</span>, </span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a>                                                <span class="st">&quot;Null &gt; Assym&quot;</span>, <span class="st">&quot;Assym &gt; Null&quot;</span>, <span class="st">&quot;Assym &gt; Mutual&quot;</span>, <span class="st">&quot;Mutual &gt; Assym&quot;</span>, </span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a>                                                <span class="st">&quot;Tie flip&quot;</span>, <span class="st">&quot;Null &gt; Mutual&quot;</span>, <span class="st">&quot;Mutual &gt; Null&quot;</span>)</span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a>                           simnet <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a>                           <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">simnet =</span> i, table))</span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a>                         }</span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb3-76"><a href="#cb3-76" tabindex="-1"></a>  type <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-77"><a href="#cb3-77" tabindex="-1"></a>  df<span class="sc">$</span>type <span class="ot">&lt;-</span> simtype</span>
<span id="cb3-78"><a href="#cb3-78" tabindex="-1"></a>  <span class="cf">if</span> (forplot <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb3-79"><a href="#cb3-79" tabindex="-1"></a>    df <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(df, <span class="at">cols =</span> <span class="sc">!</span><span class="fu">c</span>(simnet, type), </span>
<span id="cb3-80"><a href="#cb3-80" tabindex="-1"></a>                              <span class="at">names_to =</span> <span class="st">&quot;x&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb3-81"><a href="#cb3-81" tabindex="-1"></a>  }</span>
<span id="cb3-82"><a href="#cb3-82" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb3-83"><a href="#cb3-83" tabindex="-1"></a>}</span>
<span id="cb3-84"><a href="#cb3-84" tabindex="-1"></a></span>
<span id="cb3-85"><a href="#cb3-85" tabindex="-1"></a><span class="co">#---- Triad census ----</span></span>
<span id="cb3-86"><a href="#cb3-86" tabindex="-1"></a>ts_triads_evo <span class="ot">&lt;-</span> <span class="cf">function</span> (sims, net1, <span class="at">simtype =</span> <span class="st">&quot;notypespecified&quot;</span>, <span class="at">forplot =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb3-87"><a href="#cb3-87" tabindex="-1"></a>  </span>
<span id="cb3-88"><a href="#cb3-88" tabindex="-1"></a>  </span>
<span id="cb3-89"><a href="#cb3-89" tabindex="-1"></a>  x <span class="ot">&lt;-</span> j <span class="ot">&lt;-</span> k <span class="ot">&lt;-</span> a1 <span class="ot">&lt;-</span> a2 <span class="ot">&lt;-</span> a3 <span class="ot">&lt;-</span> tie_change <span class="ot">&lt;-</span> Freq <span class="ot">&lt;-</span> simnet <span class="ot">&lt;-</span> type <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-90"><a href="#cb3-90" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.list</span>(sims) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb3-91"><a href="#cb3-91" tabindex="-1"></a>    nsims <span class="ot">&lt;-</span> <span class="fu">length</span>(sims)</span>
<span id="cb3-92"><a href="#cb3-92" tabindex="-1"></a>  }</span>
<span id="cb3-93"><a href="#cb3-93" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb3-94"><a href="#cb3-94" tabindex="-1"></a>    nsims <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-95"><a href="#cb3-95" tabindex="-1"></a>  }</span>
<span id="cb3-96"><a href="#cb3-96" tabindex="-1"></a>  df <span class="ot">&lt;-</span> foreach<span class="sc">::</span><span class="fu">foreach</span>(<span class="dv">1</span><span class="sc">:</span>nsims, <span class="at">x =</span> iterators<span class="sc">::</span><span class="fu">icount</span>(),<span class="at">.combine =</span> <span class="st">&quot;rbind&quot;</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb3-97"><a href="#cb3-97" tabindex="-1"></a>    </span>
<span id="cb3-98"><a href="#cb3-98" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.list</span>(sims) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb3-99"><a href="#cb3-99" tabindex="-1"></a>      net2 <span class="ot">&lt;-</span> sims[[x]]</span>
<span id="cb3-100"><a href="#cb3-100" tabindex="-1"></a>      </span>
<span id="cb3-101"><a href="#cb3-101" tabindex="-1"></a>      <span class="co">#find which values in the matrix are missing</span></span>
<span id="cb3-102"><a href="#cb3-102" tabindex="-1"></a>      N_NA <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(net1) <span class="sc">|</span> <span class="fu">is.na</span>(net2), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) <span class="co"># Identify normal NA values</span></span>
<span id="cb3-103"><a href="#cb3-103" tabindex="-1"></a>      S_NA <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(<span class="fu">which</span>(net1 <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> net2 <span class="sc">==</span> <span class="dv">10</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>])) <span class="co"># Identify Structural NAs</span></span>
<span id="cb3-104"><a href="#cb3-104" tabindex="-1"></a>      S_NA <span class="ot">&lt;-</span> <span class="fu">which</span>(S_NA<span class="sc">$</span>Freq <span class="sc">==</span> <span class="fu">nrow</span>(net1))</span>
<span id="cb3-105"><a href="#cb3-105" tabindex="-1"></a>      NA_rows <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.vector</span>(N_NA), <span class="fu">as.vector</span>(S_NA)) <span class="co"># save all actors in 1 vector</span></span>
<span id="cb3-106"><a href="#cb3-106" tabindex="-1"></a>      </span>
<span id="cb3-107"><a href="#cb3-107" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(NA_rows)<span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb3-108"><a href="#cb3-108" tabindex="-1"></a>        </span>
<span id="cb3-109"><a href="#cb3-109" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="fu">ncol</span>(net1)<span class="sc">-</span> <span class="fu">length</span>(NA_rows),<span class="st">&quot; actors will be analysed due to missing values. Following &quot;</span>, <span class="fu">length</span>(NA_rows), <span class="st">&quot; actors have been listwise deleted: &quot;</span>,<span class="fu">paste</span>(NA_rows, <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>))</span>
<span id="cb3-110"><a href="#cb3-110" tabindex="-1"></a>        <span class="co"># Delete both rows and columns of actors that are missing (NA)</span></span>
<span id="cb3-111"><a href="#cb3-111" tabindex="-1"></a>        net1 <span class="ot">&lt;-</span> net1[<span class="sc">-</span>NA_rows,<span class="sc">-</span>NA_rows]</span>
<span id="cb3-112"><a href="#cb3-112" tabindex="-1"></a>        </span>
<span id="cb3-113"><a href="#cb3-113" tabindex="-1"></a>        net2 <span class="ot">&lt;-</span> net2[<span class="sc">-</span>NA_rows,<span class="sc">-</span>NA_rows]</span>
<span id="cb3-114"><a href="#cb3-114" tabindex="-1"></a>        </span>
<span id="cb3-115"><a href="#cb3-115" tabindex="-1"></a>      }</span>
<span id="cb3-116"><a href="#cb3-116" tabindex="-1"></a>      </span>
<span id="cb3-117"><a href="#cb3-117" tabindex="-1"></a>    }</span>
<span id="cb3-118"><a href="#cb3-118" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb3-119"><a href="#cb3-119" tabindex="-1"></a>      net2 <span class="ot">&lt;-</span> sims</span>
<span id="cb3-120"><a href="#cb3-120" tabindex="-1"></a>      </span>
<span id="cb3-121"><a href="#cb3-121" tabindex="-1"></a>      <span class="co">#find which values in the matrix are missing</span></span>
<span id="cb3-122"><a href="#cb3-122" tabindex="-1"></a>      NA_row <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(net1) <span class="sc">|</span> <span class="fu">is.na</span>(net2), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) </span>
<span id="cb3-123"><a href="#cb3-123" tabindex="-1"></a>      </span>
<span id="cb3-124"><a href="#cb3-124" tabindex="-1"></a>      <span class="co">#find which values in the matrix are missing</span></span>
<span id="cb3-125"><a href="#cb3-125" tabindex="-1"></a>      N_NA <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(net1) <span class="sc">|</span> <span class="fu">is.na</span>(net2), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>]) <span class="co"># Identify normal NA values</span></span>
<span id="cb3-126"><a href="#cb3-126" tabindex="-1"></a>      S_NA <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(<span class="fu">which</span>(net1 <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> net2 <span class="sc">==</span> <span class="dv">10</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>])) <span class="co"># Identify Structural NAs</span></span>
<span id="cb3-127"><a href="#cb3-127" tabindex="-1"></a>      S_NA <span class="ot">&lt;-</span> <span class="fu">which</span>(S_NA<span class="sc">$</span>Freq <span class="sc">==</span> <span class="fu">nrow</span>(net1))</span>
<span id="cb3-128"><a href="#cb3-128" tabindex="-1"></a>      NA_rows <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.vector</span>(N_NA), <span class="fu">as.vector</span>(S_NA)) <span class="co"># save all actors in 1 vector</span></span>
<span id="cb3-129"><a href="#cb3-129" tabindex="-1"></a>      </span>
<span id="cb3-130"><a href="#cb3-130" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(NA_rows)<span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb3-131"><a href="#cb3-131" tabindex="-1"></a>        </span>
<span id="cb3-132"><a href="#cb3-132" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="fu">ncol</span>(net1)<span class="sc">-</span> <span class="fu">length</span>(NA_rows),<span class="st">&quot; actors will be analysed due to missing values. Following &quot;</span>, <span class="fu">length</span>(NA_rows), <span class="st">&quot; actors have been listwise deleted: &quot;</span>,<span class="fu">paste</span>(NA_rows, <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>))</span>
<span id="cb3-133"><a href="#cb3-133" tabindex="-1"></a>        <span class="co"># Delete both rows and columns of actors that are missing (NA)</span></span>
<span id="cb3-134"><a href="#cb3-134" tabindex="-1"></a>        net1 <span class="ot">&lt;-</span> net1[<span class="sc">-</span>NA_rows,<span class="sc">-</span>NA_rows]</span>
<span id="cb3-135"><a href="#cb3-135" tabindex="-1"></a>        </span>
<span id="cb3-136"><a href="#cb3-136" tabindex="-1"></a>        net2 <span class="ot">&lt;-</span> net2[<span class="sc">-</span>NA_rows,<span class="sc">-</span>NA_rows]</span>
<span id="cb3-137"><a href="#cb3-137" tabindex="-1"></a>        </span>
<span id="cb3-138"><a href="#cb3-138" tabindex="-1"></a>      }</span>
<span id="cb3-139"><a href="#cb3-139" tabindex="-1"></a>    }</span>
<span id="cb3-140"><a href="#cb3-140" tabindex="-1"></a>    </span>
<span id="cb3-141"><a href="#cb3-141" tabindex="-1"></a>    triads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X003&quot;</span>, <span class="st">&quot;X012&quot;</span>, <span class="st">&quot;X102&quot;</span>, <span class="st">&quot;X021D&quot;</span>, <span class="st">&quot;X021U&quot;</span>, </span>
<span id="cb3-142"><a href="#cb3-142" tabindex="-1"></a>                <span class="st">&quot;X021C&quot;</span>, <span class="st">&quot;X111D&quot;</span>, <span class="st">&quot;X111U&quot;</span>, <span class="st">&quot;X030T&quot;</span>, <span class="st">&quot;X030C&quot;</span>, <span class="st">&quot;X201&quot;</span>, </span>
<span id="cb3-143"><a href="#cb3-143" tabindex="-1"></a>                <span class="st">&quot;X120D&quot;</span>, <span class="st">&quot;X120U&quot;</span>, <span class="st">&quot;X120C&quot;</span>, <span class="st">&quot;X210&quot;</span>, <span class="st">&quot;X300&quot;</span>)</span>
<span id="cb3-144"><a href="#cb3-144" tabindex="-1"></a>    </span>
<span id="cb3-145"><a href="#cb3-145" tabindex="-1"></a>    df <span class="ot">&lt;-</span> foreach<span class="sc">::</span><span class="fu">foreach</span>(<span class="at">a1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(net1), <span class="at">i =</span> iterators<span class="sc">::</span><span class="fu">icount</span>(),<span class="at">.combine =</span> <span class="st">&quot;rbind&quot;</span>) <span class="sc">%:%</span> </span>
<span id="cb3-146"><a href="#cb3-146" tabindex="-1"></a>      foreach<span class="sc">::</span><span class="fu">foreach</span>(<span class="at">a2 =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(net1), <span class="at">j =</span> iterators<span class="sc">::</span><span class="fu">icount</span>(), <span class="at">.combine =</span> <span class="st">&quot;rbind&quot;</span>) <span class="sc">%:%</span> </span>
<span id="cb3-147"><a href="#cb3-147" tabindex="-1"></a>      foreach<span class="sc">::</span><span class="fu">foreach</span>(<span class="at">a3 =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(net1), <span class="at">k =</span> iterators<span class="sc">::</span><span class="fu">icount</span>(),<span class="at">.combine =</span> <span class="st">&quot;rbind&quot;</span>) <span class="sc">%do%</span> {</span>
<span id="cb3-148"><a href="#cb3-148" tabindex="-1"></a>        <span class="cf">if</span> (i <span class="sc">&gt;</span> j <span class="sc">&amp;</span> j <span class="sc">&gt;</span> k) {</span>
<span id="cb3-149"><a href="#cb3-149" tabindex="-1"></a>          <span class="fu">data.frame</span>(<span class="at">i =</span> i, <span class="at">j =</span> j, <span class="at">k =</span> k, </span>
<span id="cb3-150"><a href="#cb3-150" tabindex="-1"></a>                     <span class="at">t1_ij =</span> <span class="fu">as.character</span>(net1[a1,a2]), <span class="at">t1_ji =</span> <span class="fu">as.character</span>(net1[a2, a1]), </span>
<span id="cb3-151"><a href="#cb3-151" tabindex="-1"></a>                     <span class="at">t1_ik =</span> <span class="fu">as.character</span>(net1[a1,a3]), <span class="at">t1_ki =</span> <span class="fu">as.character</span>(net1[a3, a1]), </span>
<span id="cb3-152"><a href="#cb3-152" tabindex="-1"></a>                     <span class="at">t1_jk =</span> <span class="fu">as.character</span>(net1[a2,a3]), <span class="at">t1_kj =</span> <span class="fu">as.character</span>(net1[a3, a2]), </span>
<span id="cb3-153"><a href="#cb3-153" tabindex="-1"></a>                     <span class="at">typeT1 =</span> triads[<span class="fu">which</span>(sna<span class="sc">::</span><span class="fu">triad.census</span>(net1[<span class="fu">c</span>(a1,a2, a3), <span class="fu">c</span>(a1, a2, a3)]) <span class="sc">==</span> <span class="dv">1</span>)], </span>
<span id="cb3-154"><a href="#cb3-154" tabindex="-1"></a>                     <span class="at">t2_ij =</span> <span class="fu">as.character</span>(net2[a1, a2]), <span class="at">t2_ji =</span> <span class="fu">as.character</span>(net2[a2, a1]), </span>
<span id="cb3-155"><a href="#cb3-155" tabindex="-1"></a>                     <span class="at">t2_ik =</span> <span class="fu">as.character</span>(net2[a1, a3]), <span class="at">t2_ki =</span> <span class="fu">as.character</span>(net2[a3, a1]), </span>
<span id="cb3-156"><a href="#cb3-156" tabindex="-1"></a>                     <span class="at">t2_jk =</span> <span class="fu">as.character</span>(net2[a2, a3]), <span class="at">t2_kj =</span> <span class="fu">as.character</span>(net2[a3, a2]), </span>
<span id="cb3-157"><a href="#cb3-157" tabindex="-1"></a>                     <span class="at">typeT2 =</span> triads[<span class="fu">which</span>(sna<span class="sc">::</span><span class="fu">triad.census</span>(net2[<span class="fu">c</span>(a1, a2, a3), <span class="fu">c</span>(a1, a2, a3)]) <span class="sc">==</span> <span class="dv">1</span>)], </span>
<span id="cb3-158"><a href="#cb3-158" tabindex="-1"></a>                     <span class="at">tie_change =</span> <span class="fu">sum</span>(<span class="fu">c</span>(net1[a1, a2], net1[a2, a1], net1[a1, a3], net1[a3, a1], net1[a2, a3], net1[a3, a2]) <span class="sc">!=</span> <span class="fu">c</span>(net2[a1, a2], net2[a2, a1], net2[a1, a3], net2[a3, a1], net2[a2, a3], net2[a3, a2])))</span>
<span id="cb3-159"><a href="#cb3-159" tabindex="-1"></a>        }</span>
<span id="cb3-160"><a href="#cb3-160" tabindex="-1"></a>      }</span>
<span id="cb3-161"><a href="#cb3-161" tabindex="-1"></a>    </span>
<span id="cb3-162"><a href="#cb3-162" tabindex="-1"></a>    </span>
<span id="cb3-163"><a href="#cb3-163" tabindex="-1"></a>    df<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(df<span class="sc">$</span>i, <span class="st">&quot;.&quot;</span>, df<span class="sc">$</span>j, <span class="st">&quot;.&quot;</span>, df<span class="sc">$</span>k)</span>
<span id="cb3-164"><a href="#cb3-164" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">subset</span>(df, <span class="at">select =</span> <span class="fu">c</span>(tie_change))</span>
<span id="cb3-165"><a href="#cb3-165" tabindex="-1"></a>    </span>
<span id="cb3-166"><a href="#cb3-166" tabindex="-1"></a>    <span class="co">#---- !!NEW!! Assign levels to counter missing columns ----</span></span>
<span id="cb3-167"><a href="#cb3-167" tabindex="-1"></a>    df<span class="sc">$</span>tie_change <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>tie_change)</span>
<span id="cb3-168"><a href="#cb3-168" tabindex="-1"></a>    <span class="fu">levels</span>(df<span class="sc">$</span>tie_change) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>,<span class="st">&quot;6&quot;</span>)</span>
<span id="cb3-169"><a href="#cb3-169" tabindex="-1"></a>    <span class="co">#---- Fixes issues with simulated networks ----</span></span>
<span id="cb3-170"><a href="#cb3-170" tabindex="-1"></a>    </span>
<span id="cb3-171"><a href="#cb3-171" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">simnet =</span> x, <span class="fu">table</span>(df))</span>
<span id="cb3-172"><a href="#cb3-172" tabindex="-1"></a>    df <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(df, <span class="at">names_from =</span> tie_change,</span>
<span id="cb3-173"><a href="#cb3-173" tabindex="-1"></a>                             <span class="at">values_from =</span> Freq)</span>
<span id="cb3-174"><a href="#cb3-174" tabindex="-1"></a>    </span>
<span id="cb3-175"><a href="#cb3-175" tabindex="-1"></a>  }</span>
<span id="cb3-176"><a href="#cb3-176" tabindex="-1"></a>  </span>
<span id="cb3-177"><a href="#cb3-177" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb3-178"><a href="#cb3-178" tabindex="-1"></a>  df<span class="sc">$</span>type <span class="ot">&lt;-</span> simtype</span>
<span id="cb3-179"><a href="#cb3-179" tabindex="-1"></a>  </span>
<span id="cb3-180"><a href="#cb3-180" tabindex="-1"></a>  <span class="cf">if</span> (forplot <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb3-181"><a href="#cb3-181" tabindex="-1"></a>    df <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(df, <span class="at">cols =</span> <span class="sc">!</span><span class="fu">c</span>(simnet, type), </span>
<span id="cb3-182"><a href="#cb3-182" tabindex="-1"></a>                              <span class="at">names_to =</span> <span class="st">&quot;x&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb3-183"><a href="#cb3-183" tabindex="-1"></a>  }</span>
<span id="cb3-184"><a href="#cb3-184" tabindex="-1"></a>  </span>
<span id="cb3-185"><a href="#cb3-185" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb3-186"><a href="#cb3-186" tabindex="-1"></a>  </span>
<span id="cb3-187"><a href="#cb3-187" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="load-packages" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Load Packages</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;tidyverse&quot;</span>, <span class="st">&quot;sna&quot;</span>, <span class="st">&quot;igraph&quot;</span>, <span class="st">&quot;RsienaTwoStep&quot;</span>, <span class="st">&quot;ape&quot;</span>, <span class="st">&quot;iterators&quot;</span>, <span class="st">&quot;doParallel&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">fpackage.check</span>(packages)</span></code></pre></div>
<pre><code>## Loading required package: tidyverse</code></pre>
<pre><code>##  Attaching packages  tidyverse 1.3.2 
##  ggplot2 3.5.1      purrr   1.0.2
##  tibble  3.2.1      dplyr   1.1.4
##  tidyr   1.3.1      stringr 1.5.1
##  readr   2.1.2      forcats 0.5.2
##  Conflicts  tidyverse_conflicts() 
##  purrr::%||%()   masks base::%||%()
##  dplyr::filter() masks stats::filter()
##  dplyr::lag()    masks stats::lag()
## Loading required package: sna
## 
## Loading required package: statnet.common
## 
## 
## Attaching package: &#39;statnet.common&#39;
## 
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     attr, order
## 
## 
## Loading required package: network
## 
## 
## &#39;network&#39; 1.18.2 (2023-12-04), part of the Statnet Project
## * &#39;news(package=&quot;network&quot;)&#39; for changes since last version
## * &#39;citation(&quot;network&quot;)&#39; for citation information
## * &#39;https://statnet.org&#39; for help, support, and other information
## 
## 
## sna: Tools for Social Network Analysis
## Version 2.7-2 created on 2023-12-05.
## copyright (c) 2005, Carter T. Butts, University of California-Irvine
##  For citation information, type citation(&quot;sna&quot;).
##  Type help(package=&quot;sna&quot;) to get started.
## 
## 
## Loading required package: igraph
## 
## 
## Attaching package: &#39;igraph&#39;
## 
## 
## The following objects are masked from &#39;package:sna&#39;:
## 
##     betweenness, bonpow, closeness, components, degree, dyad.census, evcent, hierarchy,
##     is.connected, neighborhood, triad.census
## 
## 
## The following objects are masked from &#39;package:network&#39;:
## 
##     %c%, %s%, add.edges, add.vertices, delete.edges, delete.vertices, get.edge.attribute,
##     get.edges, get.vertex.attribute, is.bipartite, is.directed, list.edge.attributes,
##     list.vertex.attributes, set.edge.attribute, set.vertex.attribute
## 
## 
## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     as_data_frame, groups, union
## 
## 
## The following objects are masked from &#39;package:purrr&#39;:
## 
##     compose, simplify
## 
## 
## The following object is masked from &#39;package:tidyr&#39;:
## 
##     crossing
## 
## 
## The following object is masked from &#39;package:tibble&#39;:
## 
##     as_data_frame
## 
## 
## The following objects are masked from &#39;package:stats&#39;:
## 
##     decompose, spectrum
## 
## 
## The following object is masked from &#39;package:base&#39;:
## 
##     union
## 
## 
## Loading required package: RsienaTwoStep
## 
## Loading required package: foreach
## 
## 
## Attaching package: &#39;foreach&#39;
## 
## 
## The following objects are masked from &#39;package:purrr&#39;:
## 
##     accumulate, when
## 
## 
## 
## Attaching package: &#39;RsienaTwoStep&#39;
## 
## 
## The following objects are masked _by_ &#39;.GlobalEnv&#39;:
## 
##     ts_dyads_evo, ts_triads_evo
## 
## 
## Loading required package: ape
## 
## 
## Attaching package: &#39;ape&#39;
## 
## 
## The following objects are masked from &#39;package:igraph&#39;:
## 
##     degree, edges, mst, ring
## 
## 
## The following objects are masked from &#39;package:sna&#39;:
## 
##     consensus, degree
## 
## 
## The following object is masked from &#39;package:dplyr&#39;:
## 
##     where
## 
## 
## Loading required package: iterators
## 
## Loading required package: doParallel
## 
## Loading required package: parallel</code></pre>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## NULL
## 
## [[3]]
## NULL
## 
## [[4]]
## NULL
## 
## [[5]]
## NULL
## 
## [[6]]
## NULL
## 
## [[7]]
## NULL</code></pre>
</div>
<div id="set-up-parallel-cluster" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Set up parallel
cluster</h1>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>no_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>mycl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="fu">rep</span>(<span class="st">&quot;localhost&quot;</span>, no_cores))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(mycl, <span class="fu">library</span>(RsienaTwoStep))</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[2]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[3]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[4]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[5]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[6]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[7]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[8]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[9]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[10]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[11]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[12]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[13]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[14]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;         
## 
## [[15]]
## [1] &quot;RsienaTwoStep&quot; &quot;foreach&quot;       &quot;stats&quot;         &quot;graphics&quot;      &quot;grDevices&quot;     &quot;utils&quot;        
## [7] &quot;datasets&quot;      &quot;methods&quot;       &quot;base&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">registerDoParallel</span>(mycl)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># stopCluster(mycl)</span></span></code></pre></div>
</div>
<div id="load-data" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Load Data</h1>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/processed/RU_UU_ego.RData&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/processed/soc_data_raw.RData&quot;</span>)</span></code></pre></div>
<p><br></p>
<hr />
</div>
<div id="networks" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Networks</h1>
<div id="make-the-graph-object" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Make the graph
object</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co">#---- Wave 2 ----</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>graph_w1 <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  soc_data<span class="sc">$</span>nets[<span class="dv">1</span>,,], <span class="co">#now, I take the second wave</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="at">mode =</span> <span class="fu">c</span>(<span class="st">&quot;directed&quot;</span>),</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="at">weighted =</span> <span class="cn">NULL</span>,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="at">diag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="at">add.colnames =</span> <span class="cn">NULL</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#---- Wave 2 ----</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>graph_w2 <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  soc_data<span class="sc">$</span>nets[<span class="dv">2</span>,,], <span class="co">#now, I take the second wave</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>  <span class="at">mode =</span> <span class="fu">c</span>(<span class="st">&quot;directed&quot;</span>),</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>  <span class="at">weighted =</span> <span class="cn">NULL</span>,</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>  <span class="at">diag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>  <span class="at">add.colnames =</span> <span class="cn">NULL</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="network-visualisations" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Network
Visualisations</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Make a plotable gender variable to fix problems with vertex.shape</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>df_ego <span class="ot">&lt;-</span> df_ego <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">plot_gen =</span> <span class="fu">case_when</span>(perc_female <span class="sc">&gt;=</span> <span class="fl">0.80</span> <span class="sc">~</span> <span class="st">&quot;Female&quot;</span>,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>                                                 <span class="at">.default =</span> <span class="st">&quot;Male&quot;</span>))</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># df_ego %&gt;% count(plot_gen)</span></span></code></pre></div>
</div>
<div id="wave-1" class="section level2 tabset" number="5.3">
<h2 class="tabset"><span class="header-section-number">5.3</span> Wave
1</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co">#---- Full network including Isolates ----</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2345</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>l_w1 <span class="ot">&lt;-</span> <span class="fu">layout_with_mds</span>(graph_w1)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="fu">plot</span>(graph_w1, <span class="at">layout =</span> l_w1,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">ifelse</span>(df_ego<span class="sc">$</span>Universiteit1<span class="fl">.22</span> <span class="sc">==</span> <span class="st">&quot;RU&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;gold&quot;</span>), <span class="co">#now, I can use actor attributes for plotting. </span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>     <span class="at">vertex.shape =</span> <span class="fu">ifelse</span>(df_ego<span class="sc">$</span>plot_gen <span class="sc">==</span> <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;square&quot;</span>, <span class="st">&quot;circle&quot;</span>),</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>     <span class="at">vertex.size =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(graph_w1, <span class="at">mode =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">*</span> <span class="fl">1.5</span>,</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="cn">NA</span>,</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>     <span class="at">edge.width =</span> .<span class="dv">8</span>,</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>     <span class="at">edge.curved =</span> <span class="fl">0.5</span>,</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>     <span class="at">edge.arrow.size =</span><span class="fl">0.2</span>,</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Gender Distribution of Two Sociology Departments 2022&quot;</span>)</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Radboud&quot;</span>, <span class="st">&quot;Utrecht University&quot;</span>, <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">21</span>,<span class="dv">15</span>,<span class="dv">20</span>), <span class="at">col =</span> <span class="st">&quot;#777777&quot;</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;gold&quot;</span>), <span class="at">pt.cex =</span> <span class="dv">1</span>,</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="Descriptives_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co">#---- Remove Isolates ----</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">diag</span>(soc_data<span class="sc">$</span>nets[<span class="dv">1</span>,,]) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>noisolates <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(soc_data<span class="sc">$</span>nets[<span class="dv">1</span>,,], <span class="at">na.rm =</span> T) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>soc_w1_sel <span class="ot">&lt;-</span> soc_data<span class="sc">$</span>nets[<span class="dv">1</span>,,][noisolates, noisolates]</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>graph_w1_sel <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(soc_w1_sel, <span class="at">mode =</span> <span class="st">&quot;directed&quot;</span>, <span class="at">weighted =</span> <span class="cn">NULL</span>, <span class="at">diag =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>                                            <span class="at">add.colnames =</span> <span class="cn">NA</span>, <span class="at">add.rownames =</span> <span class="cn">NA</span>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>ego_iso_w1 <span class="ot">&lt;-</span> df_ego[noisolates,]</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#---- Graph without Isolates ----</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2345</span>)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>l_w1 <span class="ot">&lt;-</span> <span class="fu">layout_with_mds</span>(graph_w1_sel)</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="fu">plot</span>(graph_w1_sel, <span class="at">layout =</span> l_w1,</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">ifelse</span>(ego_iso_w1<span class="sc">$</span>Universiteit1<span class="fl">.22</span> <span class="sc">==</span> <span class="st">&quot;RU&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;gold&quot;</span>), <span class="co">#now, I can use actor attributes for plotting. </span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>     <span class="at">vertex.shape =</span> <span class="fu">ifelse</span>(ego_iso_w1<span class="sc">$</span>plot_gen <span class="sc">==</span> <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;square&quot;</span>, <span class="st">&quot;circle&quot;</span>),</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>     <span class="at">vertex.size =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(graph_w1_sel, <span class="at">mode =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">*</span> <span class="fl">1.5</span>,</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="cn">NA</span>,</span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>     <span class="at">edge.width =</span> .<span class="dv">8</span>,</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>     <span class="at">edge.curved =</span> <span class="fl">0.5</span>,</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>     <span class="at">edge.arrow.size =</span><span class="fl">0.2</span>,</span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Gender Distribution of Two Sociology Departments 2022&quot;</span>)</span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Radboud&quot;</span>, <span class="st">&quot;Utrecht University&quot;</span>, <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">21</span>,<span class="dv">15</span>,<span class="dv">20</span>), <span class="at">col =</span> <span class="st">&quot;#777777&quot;</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;gold&quot;</span>), <span class="at">pt.cex =</span> <span class="dv">1</span>,</span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="Descriptives_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
</div>
<div id="wave-2" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Wave 2</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co">#---- Full network including Isolates ----</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2345</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>l_w2 <span class="ot">&lt;-</span> <span class="fu">layout_nicely</span>(graph_w2)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="fu">plot</span>(graph_w2, <span class="at">layout =</span> l_w2,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">ifelse</span>(df_ego<span class="sc">$</span>Universiteit1<span class="fl">.24</span> <span class="sc">==</span> <span class="st">&quot;RU&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;gold&quot;</span>), <span class="co">#now, I can use actor attributes for plotting. </span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>     <span class="at">vertex.shape =</span> <span class="fu">ifelse</span>(df_ego<span class="sc">$</span>plot_gen <span class="sc">==</span> <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;square&quot;</span>, <span class="st">&quot;circle&quot;</span>),</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>     <span class="at">vertex.size =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(graph_w2, <span class="at">mode =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">*</span> <span class="fl">1.5</span>,</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="cn">NA</span>,</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>     <span class="at">edge.width =</span> <span class="fl">0.8</span>,</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>     <span class="at">edge.curved =</span> <span class="fl">0.5</span>,</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>     <span class="at">edge.arrow.size =</span><span class="fl">0.2</span>,</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Gender Distribution of Two Sociology Departments 2022&quot;</span>)</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Radboud&quot;</span>, <span class="st">&quot;Utrecht University&quot;</span>, <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">21</span>,<span class="dv">15</span>,<span class="dv">20</span>), <span class="at">col =</span> <span class="st">&quot;#777777&quot;</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;gold&quot;</span>), <span class="at">pt.cex =</span> <span class="dv">1</span>,</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="Descriptives_files/figure-html/unnamed-chunk-11-1.png" width="768" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co">#---- Remove Isolates ----</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">diag</span>(soc_data<span class="sc">$</span>nets[<span class="dv">2</span>,,]) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>noisolates <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(soc_data<span class="sc">$</span>nets[<span class="dv">2</span>,,], <span class="at">na.rm =</span> T) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>soc_w2_sel <span class="ot">&lt;-</span> soc_data<span class="sc">$</span>nets[<span class="dv">2</span>,,][noisolates, noisolates]</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>graph_w2_sel <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(soc_w2_sel, <span class="at">mode =</span> <span class="st">&quot;directed&quot;</span>, <span class="at">weighted =</span> <span class="cn">NULL</span>, <span class="at">diag =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>                                            <span class="at">add.colnames =</span> <span class="cn">NA</span>, <span class="at">add.rownames =</span> <span class="cn">NA</span>)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>ego_iso_w2 <span class="ot">&lt;-</span> df_ego[noisolates,]</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#---- Graph without Isolates ----</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2345</span>)</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>l_w2 <span class="ot">&lt;-</span> <span class="fu">layout_nicely</span>(graph_w2_sel)</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="fu">plot</span>(graph_w2_sel, <span class="at">layout =</span> l_w2,</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">ifelse</span>(ego_iso_w2<span class="sc">$</span>Universiteit1<span class="fl">.24</span> <span class="sc">==</span> <span class="st">&quot;RU&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;gold&quot;</span>), <span class="co">#now, I can use actor attributes for plotting. </span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>     <span class="at">vertex.shape =</span> <span class="fu">ifelse</span>(ego_iso_w2<span class="sc">$</span>plot_gen <span class="sc">==</span> <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;square&quot;</span>, <span class="st">&quot;circle&quot;</span>),</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>     <span class="at">vertex.size =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(graph_w2_sel, <span class="at">mode =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">*</span> <span class="fl">1.5</span>,</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="cn">NA</span>,</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>     <span class="at">edge.width =</span> <span class="fl">0.8</span>,</span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>     <span class="at">edge.curved =</span> <span class="fl">0.5</span>,</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a>     <span class="at">edge.arrow.size =</span><span class="fl">0.2</span>,</span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Gender Distribution of Two Sociology Departments 2022&quot;</span>)</span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Radboud&quot;</span>, <span class="st">&quot;Utrecht University&quot;</span>, <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">21</span>,<span class="dv">15</span>,<span class="dv">20</span>), <span class="at">col =</span> <span class="st">&quot;#777777&quot;</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;gold&quot;</span>), <span class="at">pt.cex =</span> <span class="dv">1</span>,</span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="Descriptives_files/figure-html/unnamed-chunk-11-2.png" width="768" /></p>
</div>
<div id="network-statistics" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Network
Statistics</h2>
<ul>
<li>I am working on making a nice table that adds all relevant
descriptive Network Statistics
<ul>
<li>Jaccard</li>
<li>Hamming</li>
<li>Indegrees and outdegrees</li>
<li>Morans I for Prestige ()</li>
</ul></li>
</ul>
<div id="calculate-network-statistics" class="section level3"
number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Calculate Network
Statistics</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co">#---- Extract networks ----</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>wave_1 <span class="ot">&lt;-</span> soc_data<span class="sc">$</span>nets[<span class="dv">1</span>,,]</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>wave_2 <span class="ot">&lt;-</span> soc_data<span class="sc">$</span>nets[<span class="dv">2</span>,,]</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#---- Jaccard, Hamming &amp; Density ----</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>jac <span class="ot">&lt;-</span> <span class="fu">fjac</span>(wave_1, wave_2)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>ham <span class="ot">&lt;-</span> <span class="fu">fham</span>(wave_1, wave_2)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>dens1 <span class="ot">&lt;-</span> <span class="fu">fdens</span>(<span class="fu">nrow</span>(wave_1),wave_1) </span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>dens2 <span class="ot">&lt;-</span> <span class="fu">fdens</span>(<span class="fu">nrow</span>(wave_2),wave_2)</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#---- Indegree distribution ----</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">table</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(graph_w1, <span class="at">mode =</span> <span class="st">&quot;in&quot;</span>)), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>),<span class="at">xlab=</span><span class="st">&#39;indegree&#39;</span>, <span class="at">main=</span> <span class="st">&#39;Histogram of indegree&#39;</span>)</span></code></pre></div>
<p><img src="Descriptives_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">table</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(graph_w2, <span class="at">mode =</span> <span class="st">&quot;in&quot;</span>)), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="at">xlab=</span><span class="st">&#39;indegree&#39;</span>, <span class="at">main=</span> <span class="st">&#39;Histogram of indegree&#39;</span>)</span></code></pre></div>
<p><img src="Descriptives_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co">#---- Outdegree distribution ----</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">table</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(graph_w1, <span class="at">mode =</span> <span class="st">&quot;out&quot;</span>)), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="at">xlab=</span><span class="st">&#39;outdegree&#39;</span>, <span class="at">main=</span> <span class="st">&#39;Histogram of outdegree&#39;</span>)</span></code></pre></div>
<p><img src="Descriptives_files/figure-html/unnamed-chunk-12-3.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">table</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(graph_w2, <span class="at">mode =</span> <span class="st">&quot;out&quot;</span>)), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="at">xlab=</span><span class="st">&#39;outdegree&#39;</span>, <span class="at">main=</span> <span class="st">&#39;Histogram of outdegree&#39;</span>)</span></code></pre></div>
<p><img src="Descriptives_files/figure-html/unnamed-chunk-12-4.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co">#---- Moran&#39;s I for Prestige ----</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co"># Wave 1</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>geodistances <span class="ot">&lt;-</span> <span class="fu">geodist</span>(wave_1, <span class="at">count.paths =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>geodistances <span class="ot">&lt;-</span> geodistances<span class="sc">$</span>gdist</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co"># first define a nb based on distance 1.</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>weights1 <span class="ot">&lt;-</span> geodistances <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>MI_pres_1 <span class="ot">&lt;-</span> <span class="fu">fMoran.I</span>(df_ego<span class="sc">$</span>Q1.W1, <span class="at">scaled =</span> <span class="cn">FALSE</span>, <span class="at">weight =</span> weights1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">rowstandardize =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>MI_pres_1</span></code></pre></div>
<pre><code>## $observed
## [1] 0.2113287
## 
## $expected
## [1] -0.01010101
## 
## $sd
## [1] 0.1266338
## 
## $p.value
## [1] 0.08036308</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Wave 2</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>geodistances <span class="ot">&lt;-</span> <span class="fu">geodist</span>(wave_2, <span class="at">count.paths =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>geodistances <span class="ot">&lt;-</span> geodistances<span class="sc">$</span>gdist</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co"># first define a nb based on distance 1.</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>weights1 <span class="ot">&lt;-</span> geodistances <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>MI_pres_2 <span class="ot">&lt;-</span> <span class="fu">fMoran.I</span>(df_ego<span class="sc">$</span>Q1.W2, <span class="at">scaled =</span> <span class="cn">FALSE</span>, <span class="at">weight =</span> weights1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">rowstandardize =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>MI_pres_2</span></code></pre></div>
<pre><code>## $observed
## [1] 0.0636469
## 
## $expected
## [1] -0.01010101
## 
## $sd
## [1] 0.08979694
## 
## $p.value
## [1] 0.4114901</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co">#---- Moran&#39;s I for gender ----</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="co"># Wave 1</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>geodistances <span class="ot">&lt;-</span> <span class="fu">geodist</span>(wave_1, <span class="at">count.paths =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>geodistances <span class="ot">&lt;-</span> geodistances<span class="sc">$</span>gdist</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co"># first define a nb based on distance 1.</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>weights1 <span class="ot">&lt;-</span> geodistances <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>MI_gen_1 <span class="ot">&lt;-</span> <span class="fu">fMoran.I</span>(df_ego<span class="sc">$</span>perc_female, <span class="at">scaled =</span> <span class="cn">FALSE</span>, <span class="at">weight =</span> weights1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">rowstandardize =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>MI_gen_1</span></code></pre></div>
<pre><code>## $observed
## [1] 0.2154872
## 
## $expected
## [1] -0.01010101
## 
## $sd
## [1] 0.133799
## 
## $p.value
## [1] 0.09179144</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Wave 2</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>geodistances <span class="ot">&lt;-</span> <span class="fu">geodist</span>(wave_2, <span class="at">count.paths =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>geodistances <span class="ot">&lt;-</span> geodistances<span class="sc">$</span>gdist</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co"># first define a nb based on distance 1.</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>weights1 <span class="ot">&lt;-</span> geodistances <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>MI_gen_2 <span class="ot">&lt;-</span> <span class="fu">fMoran.I</span>(df_ego<span class="sc">$</span>perc_female, <span class="at">scaled =</span> <span class="cn">FALSE</span>, <span class="at">weight =</span> weights1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">rowstandardize =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>MI_gen_2</span></code></pre></div>
<pre><code>## $observed
## [1] 0.1396191
## 
## $expected
## [1] -0.01010101
## 
## $sd
## [1] 0.09217327
## 
## $p.value
## [1] 0.1043047</code></pre>
</div>
<div id="create-df" class="section level3" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Create DF</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Network_size_W1 =</span> <span class="fu">nrow</span>(wave_1),</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>                 <span class="at">Jaccard_Index =</span> <span class="fu">round</span>(jac, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>                 <span class="at">Hamming_Distance =</span> <span class="fu">round</span>(ham, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>                 <span class="at">Density_w1 =</span> <span class="fu">round</span>(dens1, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>                 <span class="at">Density_w2 =</span> <span class="fu">round</span>(dens2, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>                 <span class="at">MoranI_pres_1 =</span> <span class="fu">round</span>(MI_pres_1[[<span class="dv">1</span>]], <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>                 <span class="at">MoranI_pres_2 =</span> <span class="fu">round</span>(MI_pres_2[[<span class="dv">1</span>]], <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>                 <span class="at">MoranI_gender_1 =</span> <span class="fu">round</span>(MI_gen_1[[<span class="dv">1</span>]], <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>                 <span class="at">MoranI_gender_2 =</span> <span class="fu">round</span>(MI_gen_2[[<span class="dv">1</span>]], <span class="at">digits =</span> <span class="dv">3</span>))</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</div>
<div id="add-data-to-appendix" class="section level3" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Add data to
appendix</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(df)</span></code></pre></div>
<div id="htmlwidget-549b2c7b016f48b1b88e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-549b2c7b016f48b1b88e">{"x":{"filter":"none","vertical":false,"data":[["1"],[100],[0.142],[151],[0.006],[0.012],[0.211],[0.064],[0.215],[0.14]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Network_size_W1<\/th>\n      <th>Jaccard_Index<\/th>\n      <th>Hamming_Distance<\/th>\n      <th>Density_w1<\/th>\n      <th>Density_w2<\/th>\n      <th>MoranI_pres_1<\/th>\n      <th>MoranI_pres_2<\/th>\n      <th>MoranI_gender_1<\/th>\n      <th>MoranI_gender_2<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">fshowdf</span>(<span class="fu">ts_dyads_evo</span>(wave_2, wave_1))</span></code></pre></div>
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
simnet
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
type
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
notypespecified
</td>
<td style="text-align:left;">
NullNull
</td>
<td style="text-align:right;">
4799
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
notypespecified
</td>
<td style="text-align:left;">
AssymAssym
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
notypespecified
</td>
<td style="text-align:left;">
MutualMutual
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
notypespecified
</td>
<td style="text-align:left;">
NullAssym
</td>
<td style="text-align:right;">
83
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
notypespecified
</td>
<td style="text-align:left;">
AssymNull
</td>
<td style="text-align:right;">
29
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
notypespecified
</td>
<td style="text-align:left;">
AssymMutual
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
notypespecified
</td>
<td style="text-align:left;">
MutualAssym
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
notypespecified
</td>
<td style="text-align:left;">
Tie.flip
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
notypespecified
</td>
<td style="text-align:left;">
NullMutual
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
notypespecified
</td>
<td style="text-align:left;">
MutualNull
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIk5ldHdvcmsgRGVzY3JpcHRpdmVzIg0KI2JpYmxpb2dyYXBoeTogcmVmZXJlbmNlcy5iaWINCmF1dGhvcjogIk5pZWxzIFZ1bGxpbmdzIg0KYmlibGlvZ3JhcGh5OiByZWZlcmVuY2VzLmJpYg0KLS0tDQoNCmBgYHtyLCBlY2hvPUZBTFNFfQ0Kcm0obGlzdCA9IGxzKCkpDQpgYGANCg0KIyBMb2FkIFVERg0KDQpgYGB7cn0NCmNvbG9yaXplIDwtIGZ1bmN0aW9uKHgsIGNvbG9yKSB7c3ByaW50ZigiPHNwYW4gc3R5bGU9J2NvbG9yOiAlczsnPiVzPC9zcGFuPiIsIGNvbG9yLCB4KSB9DQoNCmZwYWNrYWdlLmNoZWNrIDwtIGZ1bmN0aW9uKHBhY2thZ2VzKSB7DQogIGxhcHBseShwYWNrYWdlcywgRlVOID0gZnVuY3Rpb24oeCkgew0KICAgIGlmICghcmVxdWlyZSh4LCBjaGFyYWN0ZXIub25seSA9IFRSVUUpKSB7DQogICAgICBpbnN0YWxsLnBhY2thZ2VzKHgsIGRlcGVuZGVuY2llcyA9IFRSVUUpDQogICAgICBsaWJyYXJ5KHgsIGNoYXJhY3Rlci5vbmx5ID0gVFJVRSkNCiAgICB9DQogIH0pDQp9DQoNCmZzYXZlIDwtIGZ1bmN0aW9uKHgsIGZpbGUgPSBOVUxMLCBsb2NhdGlvbiA9ICIuL2RhdGEvcHJvY2Vzc2VkLyIpIHsNCiAgaWZlbHNlKCFkaXIuZXhpc3RzKCJkYXRhIiksIGRpci5jcmVhdGUoImRhdGEiKSwgRkFMU0UpDQogIGlmZWxzZSghZGlyLmV4aXN0cygiZGF0YS9wcm9jZXNzZWQiKSwgZGlyLmNyZWF0ZSgiZGF0YS9wcm9jZXNzZWQiKSwgRkFMU0UpDQogIGlmIChpcy5udWxsKGZpbGUpKQ0KICAgIGZpbGUgPSBkZXBhcnNlKHN1YnN0aXR1dGUoeCkpDQogIGRhdGVuYW1lIDwtIHN1YnN0cihnc3ViKCJbOi1dIiwgIiIsIFN5cy50aW1lKCkpLCAxLCA4KQ0KICB0b3RhbG5hbWUgPC0gcGFzdGUobG9jYXRpb24sIGRhdGVuYW1lLCBmaWxlLCAiLnJkYSIsIHNlcCA9ICIiKQ0KICBzYXZlKHgsIGZpbGUgPSB0b3RhbG5hbWUpICAjbmVlZCB0byBmaXggaWYgZmlsZSBpcyByZWxvYWRlZCBhcyBpbnB1dCBuYW1lLCBub3QgYXMgeC4gDQp9DQoNCmZsb2FkIDwtIGZ1bmN0aW9uKGZpbGVuYW1lKSB7DQogIGxvYWQoZmlsZW5hbWUpDQogIGdldChscygpW2xzKCkgIT0gImZpbGVuYW1lIl0pDQp9DQoNCmZzaG93ZGYgPC0gZnVuY3Rpb24oeCwgLi4uKSB7DQogIGtuaXRyOjprYWJsZSh4LCBkaWdpdHMgPSAyLCAiaHRtbCIsIC4uLikgJT4lDQogICAga2FibGVFeHRyYTo6a2FibGVfc3R5bGluZyhib290c3RyYXBfb3B0aW9ucyA9IGMoInN0cmlwZWQiLCAiaG92ZXIiKSkgJT4lDQogICAga2FibGVFeHRyYTo6c2Nyb2xsX2JveCh3aWR0aCA9ICIxMDAlIiwgaGVpZ2h0ID0gIjMwMHB4IikNCn0NCg0KYGBgDQoNCiMjIE5ldHdvcmsgU3RhdGlzdGljcyBmdW5jdGlvbnMNCg0KYGBge3J9DQoNCiMtLS0tIEphY2NhcmQgSW5kZXggLS0tLQ0KZmphYyA8LSBmdW5jdGlvbihuZXQxLCBuZXQyKSB7DQogIA0KICBkaWFnKG5ldDEpIDwtIE5BDQogIGRpYWcobmV0MikgPC0gTkENCiAgdGogPC0gdGFibGUoYXMubnVtZXJpYyhuZXQxKSwgYXMubnVtZXJpYyhuZXQyKSkgDQogIGphY2NhcmQgPC0gdGpbMiwyXSAvKHRqWzEsMl0gKyB0alsyLDFdICsgdGpbMiwyXSkNCiAgaGFtbWluZyA8LSB0alsyLDFdICsgdGpbMSwyXQ0KICANCiAgcmV0dXJuKGphY2NhcmQpDQogIA0KfQ0KDQojLS0tLSBIYW1taW5nIERpc3RhbmNlIC0tLS0NCmZoYW0gPC0gZnVuY3Rpb24obmV0MSwgbmV0Mikgew0KICBkaWFnKG5ldDEpIDwtIE5BDQogIGRpYWcobmV0MikgPC0gTkENCiAgdGogPC0gdGFibGUoYXMubnVtZXJpYyhuZXQxKSwgYXMubnVtZXJpYyhuZXQyKSkgDQogIGhhbW1pbmcgPC0gdGpbMiwxXSArIHRqWzEsMl0NCiAgDQogIHJldHVybihoYW1taW5nKQ0KICANCn0NCg0KIy0tLS0gRGVuc2l0eSAtLS0tDQpmZGVucyA8LSBmdW5jdGlvbihOLCBkYXRhID0gbmV0LCBkaXJlY3RlZCA9IFRSVUUpIHsNCiAgDQogIGlmIChkaXJlY3RlZCA9PSBUUlVFKSB7DQogICAgcG9zX3RpZSA8LSAoTiAqIChOIC0gMSkpDQogIH0gZWxzZSB7DQogICAgcG9zX3RpZSA8LSAoTiAqIChOIC0gMSkpLzINCiAgICANCiAgfQ0KICANCiAgb2JzX3RpZSA8LSBzdW0oc25hOjpkeWFkLmNlbnN1cyhkYXRhKVsxOjJdKQ0KICBkZW5zIDwtIG9ic190aWUvcG9zX3RpZQ0KICANCiAgcmV0dXJuKGRlbnMpDQp9DQoNCiMtLS0tIE1vcmFuJ3MgSSAtLS0tDQpmTW9yYW4uSSA8LSBmdW5jdGlvbih4LCB3ZWlnaHQsIHNjYWxlZCA9IEZBTFNFLCBuYS5ybSA9IEZBTFNFLCBhbHRlcm5hdGl2ZSA9ICJ0d28uc2lkZWQiLCByb3dzdGFuZGFyZGl6ZSA9IFRSVUUpIHsNCiAgaWYgKHJvd3N0YW5kYXJkaXplKSB7DQogICAgaWYgKGRpbSh3ZWlnaHQpWzFdICE9IGRpbSh3ZWlnaHQpWzJdKQ0KICAgICAgc3RvcCgiJ3dlaWdodCcgbXVzdCBiZSBhIHNxdWFyZSBtYXRyaXgiKQ0KICAgIG4gPC0gbGVuZ3RoKHgpDQogICAgaWYgKGRpbSh3ZWlnaHQpWzFdICE9IG4pDQogICAgICBzdG9wKCInd2VpZ2h0JyBtdXN0IGhhdmUgYXMgbWFueSByb3dzIGFzIG9ic2VydmF0aW9ucyBpbiAneCciKQ0KICAgIGVpIDwtIC0xLyhuIC0gMSkNCiAgICBuYXMgPC0gaXMubmEoeCkNCiAgICBpZiAoYW55KG5hcykpIHsNCiAgICAgIGlmIChuYS5ybSkgew0KICAgICAgICB4IDwtIHhbIW5hc10NCiAgICAgICAgbiA8LSBsZW5ndGgoeCkNCiAgICAgICAgd2VpZ2h0IDwtIHdlaWdodFshbmFzLCAhbmFzXQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgd2FybmluZygiJ3gnIGhhcyBtaXNzaW5nIHZhbHVlczogbWF5YmUgeW91IHdhbnRlZCB0byBzZXQgbmEucm0gPSBUUlVFPyIpDQogICAgICAgIHJldHVybihsaXN0KG9ic2VydmVkID0gTkEsIGV4cGVjdGVkID0gZWksIHNkID0gTkEsIHAudmFsdWUgPSBOQSkpDQogICAgICB9DQogICAgfQ0KICAgIFJPV1NVTSA8LSByb3dTdW1zKHdlaWdodCkNCiAgICBST1dTVU1bUk9XU1VNID09IDBdIDwtIDENCiAgICB3ZWlnaHQgPC0gd2VpZ2h0L1JPV1NVTQ0KICAgIHMgPC0gc3VtKHdlaWdodCkNCiAgICBtIDwtIG1lYW4oeCkNCiAgICB5IDwtIHggLSBtDQogICAgY3YgPC0gc3VtKHdlaWdodCAqIHkgJW8lIHkpDQogICAgdiA8LSBzdW0oeV4yKQ0KICAgIG9icyA8LSAobi9zKSAqIChjdi92KQ0KICAgIGlmIChzY2FsZWQpIHsNCiAgICAgIGkubWF4IDwtIChuL3MpICogKHNkKHJvd1N1bXMod2VpZ2h0KSAqIHkpL3NxcnQodi8obiAtIDEpKSkNCiAgICAgIG9icyA8LSBvYnMvaS5tYXgNCiAgICB9DQogICAgUzEgPC0gMC41ICogc3VtKCh3ZWlnaHQgKyB0KHdlaWdodCkpXjIpDQogICAgUzIgPC0gc3VtKChhcHBseSh3ZWlnaHQsIDEsIHN1bSkgKyBhcHBseSh3ZWlnaHQsIDIsIHN1bSkpXjIpDQogICAgcy5zcSA8LSBzXjINCiAgICBrIDwtIChzdW0oeV40KS9uKS8odi9uKV4yDQogICAgc2RpIDwtIHNxcnQoKG4gKiAoKG5eMiAtIDMgKiBuICsgMykgKiBTMSAtIG4gKiBTMiArIDMgKiBzLnNxKSAtIGsgKiAobiAqIChuIC0gMSkgKiBTMSAtIDIgKiBuICoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFMyICsgNiAqIHMuc3EpKS8oKG4gLSAxKSAqIChuIC0gMikgKiAobiAtIDMpICogcy5zcSkgLSAxLygobiAtIDEpXjIpKQ0KICAgIGFsdGVybmF0aXZlIDwtIG1hdGNoLmFyZyhhbHRlcm5hdGl2ZSwgYygidHdvLnNpZGVkIiwgImxlc3MiLCAiZ3JlYXRlciIpKQ0KICAgIHB2IDwtIHBub3JtKG9icywgbWVhbiA9IGVpLCBzZCA9IHNkaSkNCiAgICBpZiAoYWx0ZXJuYXRpdmUgPT0gInR3by5zaWRlZCIpDQogICAgICBwdiA8LSBpZiAob2JzIDw9IGVpKQ0KICAgICAgICAyICogcHYgZWxzZSAyICogKDEgLSBwdikNCiAgICBpZiAoYWx0ZXJuYXRpdmUgPT0gImdyZWF0ZXIiKQ0KICAgICAgcHYgPC0gMSAtIHB2DQogICAgbGlzdChvYnNlcnZlZCA9IG9icywgZXhwZWN0ZWQgPSBlaSwgc2QgPSBzZGksIHAudmFsdWUgPSBwdikNCiAgfSBlbHNlIHsNCiAgICBpZiAoZGltKHdlaWdodClbMV0gIT0gZGltKHdlaWdodClbMl0pDQogICAgICBzdG9wKCInd2VpZ2h0JyBtdXN0IGJlIGEgc3F1YXJlIG1hdHJpeCIpDQogICAgbiA8LSBsZW5ndGgoeCkNCiAgICBpZiAoZGltKHdlaWdodClbMV0gIT0gbikNCiAgICAgIHN0b3AoIid3ZWlnaHQnIG11c3QgaGF2ZSBhcyBtYW55IHJvd3MgYXMgb2JzZXJ2YXRpb25zIGluICd4JyIpDQogICAgZWkgPC0gLTEvKG4gLSAxKQ0KICAgIG5hcyA8LSBpcy5uYSh4KQ0KICAgIGlmIChhbnkobmFzKSkgew0KICAgICAgaWYgKG5hLnJtKSB7DQogICAgICAgIHggPC0geFshbmFzXQ0KICAgICAgICBuIDwtIGxlbmd0aCh4KQ0KICAgICAgICB3ZWlnaHQgPC0gd2VpZ2h0WyFuYXMsICFuYXNdDQogICAgICB9IGVsc2Ugew0KICAgICAgICB3YXJuaW5nKCIneCcgaGFzIG1pc3NpbmcgdmFsdWVzOiBtYXliZSB5b3Ugd2FudGVkIHRvIHNldCBuYS5ybSA9IFRSVUU/IikNCiAgICAgICAgcmV0dXJuKGxpc3Qob2JzZXJ2ZWQgPSBOQSwgZXhwZWN0ZWQgPSBlaSwgc2QgPSBOQSwgcC52YWx1ZSA9IE5BKSkNCiAgICAgIH0NCiAgICB9DQogICAgIyBST1dTVU0gPC0gcm93U3Vtcyh3ZWlnaHQpIFJPV1NVTVtST1dTVU0gPT0gMF0gPC0gMSB3ZWlnaHQgPC0gd2VpZ2h0L1JPV1NVTQ0KICAgIHMgPC0gc3VtKHdlaWdodCkNCiAgICBtIDwtIG1lYW4oeCkNCiAgICB5IDwtIHggLSBtDQogICAgY3YgPC0gc3VtKHdlaWdodCAqIHkgJW8lIHkpDQogICAgdiA8LSBzdW0oeV4yKQ0KICAgIG9icyA8LSAobi9zKSAqIChjdi92KQ0KICAgIGlmIChzY2FsZWQpIHsNCiAgICAgIGkubWF4IDwtIChuL3MpICogKHNkKHJvd1N1bXMod2VpZ2h0KSAqIHkpL3NxcnQodi8obiAtIDEpKSkNCiAgICAgIG9icyA8LSBvYnMvaS5tYXgNCiAgICB9DQogICAgUzEgPC0gMC41ICogc3VtKCh3ZWlnaHQgKyB0KHdlaWdodCkpXjIpDQogICAgUzIgPC0gc3VtKChhcHBseSh3ZWlnaHQsIDEsIHN1bSkgKyBhcHBseSh3ZWlnaHQsIDIsIHN1bSkpXjIpDQogICAgcy5zcSA8LSBzXjINCiAgICBrIDwtIChzdW0oeV40KS9uKS8odi9uKV4yDQogICAgc2RpIDwtIHNxcnQoKG4gKiAoKG5eMiAtIDMgKiBuICsgMykgKiBTMSAtIG4gKiBTMiArIDMgKiBzLnNxKSAtIGsgKiAobiAqIChuIC0gMSkgKiBTMSAtIDIgKiBuICoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFMyICsgNiAqIHMuc3EpKS8oKG4gLSAxKSAqIChuIC0gMikgKiAobiAtIDMpICogcy5zcSkgLSAxLygobiAtIDEpXjIpKQ0KICAgIGFsdGVybmF0aXZlIDwtIG1hdGNoLmFyZyhhbHRlcm5hdGl2ZSwgYygidHdvLnNpZGVkIiwgImxlc3MiLCAiZ3JlYXRlciIpKQ0KICAgIHB2IDwtIHBub3JtKG9icywgbWVhbiA9IGVpLCBzZCA9IHNkaSkNCiAgICBpZiAoYWx0ZXJuYXRpdmUgPT0gInR3by5zaWRlZCIpDQogICAgICBwdiA8LSBpZiAob2JzIDw9IGVpKQ0KICAgICAgICAyICogcHYgZWxzZSAyICogKDEgLSBwdikNCiAgICBpZiAoYWx0ZXJuYXRpdmUgPT0gImdyZWF0ZXIiKQ0KICAgICAgcHYgPC0gMSAtIHB2DQogICAgbGlzdChvYnNlcnZlZCA9IG9icywgZXhwZWN0ZWQgPSBlaSwgc2QgPSBzZGksIHAudmFsdWUgPSBwdikNCiAgfQ0KICANCiAgDQp9DQpgYGANCg0KIyMgQ3VzdG9tIER5YWQgJiBUcmlhZCBjZW5zdXMgZnVuY3Rpb24NCg0KYGBge3J9DQojLS0tLSBEeWFkIGNlbnN1cyAtLS0tDQp0c19keWFkc19ldm8gPC0gZnVuY3Rpb24gKHNpbXMsIG5ldDEsIHNpbXR5cGUgPSAibm90eXBlc3BlY2lmaWVkIiwgZm9ycGxvdCA9IFRSVUUpIHsNCiAgDQogIA0KICBpZiAoaXMubGlzdChzaW1zKSA9PSBUUlVFKSB7DQogICAgbnNpbXMgPC0gbGVuZ3RoKHNpbXMpDQogIH0NCiAgZWxzZSB7DQogICAgbnNpbXMgPC0gMQ0KICB9DQogIGRmIDwtIGZvcmVhY2g6OmZvcmVhY2goMTpuc2ltcywgaSA9IGl0ZXJhdG9yczo6aWNvdW50KCksIA0KICAgICAgICAgICAgICAgICAgICAgICAgIC5jb21iaW5lID0gInJiaW5kIikgJWRvcGFyJSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpcy5saXN0KHNpbXMpID09IFRSVUUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0MiA8LSBzaW1zW1tpXV0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0MiA8LSBzaW1zDQogICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICNmaW5kIHdoaWNoIHZhbHVlcyBpbiB0aGUgbWF0cml4IGFyZSBtaXNzaW5nDQogICAgICAgICAgICAgICAgICAgICAgICAgICBOX05BIDwtIHVuaXF1ZSh3aGljaChpcy5uYShuZXQxKSB8IGlzLm5hKG5ldDIpLCBhcnIuaW5kID0gVFJVRSlbLDFdKSAjIElkZW50aWZ5IG5vcm1hbCBOQSB2YWx1ZXMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIFNfTkEgPC0gYXMuZGF0YS5mcmFtZSh0YWJsZSh3aGljaChuZXQxID09IDEwIHwgbmV0MiA9PSAxMCwgYXJyLmluZCA9IFRSVUUpWywxXSkpICMgSWRlbnRpZnkgU3RydWN0dXJhbCBOQXMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIFNfTkEgPC0gd2hpY2goU19OQSRGcmVxID09IG5yb3cobmV0MSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICBOQV9yb3dzIDwtIGMoYXMudmVjdG9yKE5fTkEpLCBhcy52ZWN0b3IoU19OQSkpICMgc2F2ZSBhbGwgYWN0b3JzIGluIDEgdmVjdG9yDQogICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxlbmd0aChOQV9yb3dzKT4gMCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXJuaW5nKG5jb2wobmV0MSktIGxlbmd0aChOQV9yb3dzKSwiIGFjdG9ycyB3aWxsIGJlIGFuYWx5c2VkIGR1ZSB0byBtaXNzaW5nIHZhbHVlcy4gRm9sbG93aW5nICIsIGxlbmd0aChOQV9yb3dzKSwgIiBhY3RvcnMgaGF2ZSBiZWVuIGxpc3R3aXNlIGRlbGV0ZWQ6ICIscGFzdGUoTkFfcm93cywgY29sbGFwc2U9IiwiKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBEZWxldGUgYm90aCByb3dzIGFuZCBjb2x1bW5zIG9mIGFjdG9ycyB0aGF0IGFyZSBtaXNzaW5nIChOQSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0MSA8LSBuZXQxWy1OQV9yb3dzLC1OQV9yb3dzXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0MiA8LSBuZXQyWy1OQV9yb3dzLC1OQV9yb3dzXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWcobmV0MSkgPC0gTkENCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWcobmV0MikgPC0gTkENCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsaXBzIDwtIG5ldDEgKyB0KG5ldDIpIC0gbmV0Mg0KICAgICAgICAgICAgICAgICAgICAgICAgICAganVtcHN0MSA8LSBuZXQxICsgdChuZXQxKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhYmxldDEgPC0ganVtcHN0MQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAganVtcHN0MVtsb3dlci50cmkoanVtcHN0MSldIDwtIE5BDQogICAgICAgICAgICAgICAgICAgICAgICAgICBqdW1wc3QyIDwtIG5ldDIgKyB0KG5ldDIpDQogICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFibGV0MiA8LSBqdW1wc3QyDQogICAgICAgICAgICAgICAgICAgICAgICAgICBqdW1wc3QyW2xvd2VyLnRyaShqdW1wc3QyKV0gPC0gTkENCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWJsZTAwIDwtIGFzLmRhdGEuZnJhbWUod2hpY2goanVtcHN0MSA9PSAwICYganVtcHN0MiA9PSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwLCBhcnIuaW5kID0gVFJVRSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFibGUwMSA8LSBhcy5kYXRhLmZyYW1lKHdoaWNoKGZsaXBzID09IDAgJiBzdGFibGV0MSA9PSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxICYgc3RhYmxldDIgPT0gMSwgYXJyLmluZCA9IFRSVUUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhYmxlMTEgPC0gYXMuZGF0YS5mcmFtZSh3aGljaChqdW1wc3QxID09IDIgJiBqdW1wc3QyID09IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIsIGFyci5pbmQgPSBUUlVFKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIE51bGxfQXNzeW0gPC0gYXMuZGF0YS5mcmFtZSh3aGljaChqdW1wc3QxID09IDAgJiBzdGFibGV0MiA9PSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEsIGFyci5pbmQgPSBUUlVFKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIEFzc3ltX051bGwgPC0gYXMuZGF0YS5mcmFtZSh3aGljaChmbGlwcyA9PSAwICYgc3RhYmxldDEgPT0gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxICYgc3RhYmxldDIgPT0gMCwgYXJyLmluZCA9IFRSVUUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgQXNzeW1fTXV0IDwtIGFzLmRhdGEuZnJhbWUod2hpY2goc3RhYmxldDEgPT0gMSAmIGp1bXBzdDIgPT0gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIsIGFyci5pbmQgPSBUUlVFKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIE11dF9Bc3N5bSA8LSBhcy5kYXRhLmZyYW1lKHdoaWNoKGp1bXBzdDEgPT0gMiAmIGp1bXBzdDIgPT0gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEsIGFyci5pbmQgPSBUUlVFKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsaXAgPC0gYXMuZGF0YS5mcmFtZSh3aGljaChmbGlwcyA9PSAyICYgc3RhYmxldDEgIT0gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyICYgc3RhYmxldDIgIT0gMiwgYXJyLmluZCA9IFRSVUUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAganVtcDAyIDwtIGFzLmRhdGEuZnJhbWUod2hpY2goanVtcHN0MSA9PSAwICYganVtcHN0MiA9PSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMiwgYXJyLmluZCA9IFRSVUUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAganVtcDIwIDwtIGFzLmRhdGEuZnJhbWUod2hpY2goanVtcHN0MSA9PSAyICYganVtcHN0MiA9PSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwgYXJyLmluZCA9IFRSVUUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGUgPC0gY2JpbmQobnJvdyhzdGFibGUwMCksIG5yb3coc3RhYmxlMDEpLCBucm93KHN0YWJsZTExKSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBucm93KE51bGxfQXNzeW0pLCBucm93KEFzc3ltX051bGwpLCBucm93KEFzc3ltX011dCksIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnJvdyhNdXRfQXNzeW0pLCBucm93KGZsaXApLCBucm93KGp1bXAwMiksIG5yb3coanVtcDIwKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG5hbWVzKHRhYmxlKSA8LSBjKCJOdWxsID4gTnVsbCIsICJBc3N5bSA+IEFzc3ltIiwgIk11dHVhbCA+IE11dHVhbCIsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk51bGwgPiBBc3N5bSIsICJBc3N5bSA+IE51bGwiLCAiQXNzeW0gPiBNdXR1YWwiLCAiTXV0dWFsID4gQXNzeW0iLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUaWUgZmxpcCIsICJOdWxsID4gTXV0dWFsIiwgIk11dHVhbCA+IE51bGwiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgc2ltbmV0IDwtIE5VTEwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybihkYXRhLmZyYW1lKHNpbW5ldCA9IGksIHRhYmxlKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICB9DQogIGRmIDwtIGFzLmRhdGEuZnJhbWUoZGYpDQogIHR5cGUgPC0gTlVMTA0KICBkZiR0eXBlIDwtIHNpbXR5cGUNCiAgaWYgKGZvcnBsb3QgPT0gVFJVRSkgew0KICAgIGRmIDwtIHRpZHlyOjpwaXZvdF9sb25nZXIoZGYsIGNvbHMgPSAhYyhzaW1uZXQsIHR5cGUpLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzX3RvID0gIngiLCB2YWx1ZXNfdG8gPSAieSIpDQogIH0NCiAgcmV0dXJuKGRmKQ0KfQ0KDQojLS0tLSBUcmlhZCBjZW5zdXMgLS0tLQ0KdHNfdHJpYWRzX2V2byA8LSBmdW5jdGlvbiAoc2ltcywgbmV0MSwgc2ltdHlwZSA9ICJub3R5cGVzcGVjaWZpZWQiLCBmb3JwbG90ID0gVFJVRSkgew0KICANCiAgDQogIHggPC0gaiA8LSBrIDwtIGExIDwtIGEyIDwtIGEzIDwtIHRpZV9jaGFuZ2UgPC0gRnJlcSA8LSBzaW1uZXQgPC0gdHlwZSA8LSBOVUxMDQogIGlmIChpcy5saXN0KHNpbXMpID09IFRSVUUpIHsNCiAgICBuc2ltcyA8LSBsZW5ndGgoc2ltcykNCiAgfQ0KICBlbHNlIHsNCiAgICBuc2ltcyA8LSAxDQogIH0NCiAgZGYgPC0gZm9yZWFjaDo6Zm9yZWFjaCgxOm5zaW1zLCB4ID0gaXRlcmF0b3JzOjppY291bnQoKSwuY29tYmluZSA9ICJyYmluZCIpICVkb3BhciUgew0KICAgIA0KICAgIGlmIChpcy5saXN0KHNpbXMpID09IFRSVUUpIHsNCiAgICAgIG5ldDIgPC0gc2ltc1tbeF1dDQogICAgICANCiAgICAgICNmaW5kIHdoaWNoIHZhbHVlcyBpbiB0aGUgbWF0cml4IGFyZSBtaXNzaW5nDQogICAgICBOX05BIDwtIHVuaXF1ZSh3aGljaChpcy5uYShuZXQxKSB8IGlzLm5hKG5ldDIpLCBhcnIuaW5kID0gVFJVRSlbLDFdKSAjIElkZW50aWZ5IG5vcm1hbCBOQSB2YWx1ZXMNCiAgICAgIFNfTkEgPC0gYXMuZGF0YS5mcmFtZSh0YWJsZSh3aGljaChuZXQxID09IDEwIHwgbmV0MiA9PSAxMCwgYXJyLmluZCA9IFRSVUUpWywxXSkpICMgSWRlbnRpZnkgU3RydWN0dXJhbCBOQXMNCiAgICAgIFNfTkEgPC0gd2hpY2goU19OQSRGcmVxID09IG5yb3cobmV0MSkpDQogICAgICBOQV9yb3dzIDwtIGMoYXMudmVjdG9yKE5fTkEpLCBhcy52ZWN0b3IoU19OQSkpICMgc2F2ZSBhbGwgYWN0b3JzIGluIDEgdmVjdG9yDQogICAgICANCiAgICAgIGlmKGxlbmd0aChOQV9yb3dzKT4gMCl7DQogICAgICAgIA0KICAgICAgICB3YXJuaW5nKG5jb2wobmV0MSktIGxlbmd0aChOQV9yb3dzKSwiIGFjdG9ycyB3aWxsIGJlIGFuYWx5c2VkIGR1ZSB0byBtaXNzaW5nIHZhbHVlcy4gRm9sbG93aW5nICIsIGxlbmd0aChOQV9yb3dzKSwgIiBhY3RvcnMgaGF2ZSBiZWVuIGxpc3R3aXNlIGRlbGV0ZWQ6ICIscGFzdGUoTkFfcm93cywgY29sbGFwc2U9IiwiKSkNCiAgICAgICAgIyBEZWxldGUgYm90aCByb3dzIGFuZCBjb2x1bW5zIG9mIGFjdG9ycyB0aGF0IGFyZSBtaXNzaW5nIChOQSkNCiAgICAgICAgbmV0MSA8LSBuZXQxWy1OQV9yb3dzLC1OQV9yb3dzXQ0KICAgICAgICANCiAgICAgICAgbmV0MiA8LSBuZXQyWy1OQV9yb3dzLC1OQV9yb3dzXQ0KICAgICAgICANCiAgICAgIH0NCiAgICAgIA0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgIG5ldDIgPC0gc2ltcw0KICAgICAgDQogICAgICAjZmluZCB3aGljaCB2YWx1ZXMgaW4gdGhlIG1hdHJpeCBhcmUgbWlzc2luZw0KICAgICAgTkFfcm93IDwtIHVuaXF1ZSh3aGljaChpcy5uYShuZXQxKSB8IGlzLm5hKG5ldDIpLCBhcnIuaW5kID0gVFJVRSlbLDFdKSANCiAgICAgIA0KICAgICAgI2ZpbmQgd2hpY2ggdmFsdWVzIGluIHRoZSBtYXRyaXggYXJlIG1pc3NpbmcNCiAgICAgIE5fTkEgPC0gdW5pcXVlKHdoaWNoKGlzLm5hKG5ldDEpIHwgaXMubmEobmV0MiksIGFyci5pbmQgPSBUUlVFKVssMV0pICMgSWRlbnRpZnkgbm9ybWFsIE5BIHZhbHVlcw0KICAgICAgU19OQSA8LSBhcy5kYXRhLmZyYW1lKHRhYmxlKHdoaWNoKG5ldDEgPT0gMTAgfCBuZXQyID09IDEwLCBhcnIuaW5kID0gVFJVRSlbLDFdKSkgIyBJZGVudGlmeSBTdHJ1Y3R1cmFsIE5Bcw0KICAgICAgU19OQSA8LSB3aGljaChTX05BJEZyZXEgPT0gbnJvdyhuZXQxKSkNCiAgICAgIE5BX3Jvd3MgPC0gYyhhcy52ZWN0b3IoTl9OQSksIGFzLnZlY3RvcihTX05BKSkgIyBzYXZlIGFsbCBhY3RvcnMgaW4gMSB2ZWN0b3INCiAgICAgIA0KICAgICAgaWYobGVuZ3RoKE5BX3Jvd3MpPiAwKXsNCiAgICAgICAgDQogICAgICAgIHdhcm5pbmcobmNvbChuZXQxKS0gbGVuZ3RoKE5BX3Jvd3MpLCIgYWN0b3JzIHdpbGwgYmUgYW5hbHlzZWQgZHVlIHRvIG1pc3NpbmcgdmFsdWVzLiBGb2xsb3dpbmcgIiwgbGVuZ3RoKE5BX3Jvd3MpLCAiIGFjdG9ycyBoYXZlIGJlZW4gbGlzdHdpc2UgZGVsZXRlZDogIixwYXN0ZShOQV9yb3dzLCBjb2xsYXBzZT0iLCIpKQ0KICAgICAgICAjIERlbGV0ZSBib3RoIHJvd3MgYW5kIGNvbHVtbnMgb2YgYWN0b3JzIHRoYXQgYXJlIG1pc3NpbmcgKE5BKQ0KICAgICAgICBuZXQxIDwtIG5ldDFbLU5BX3Jvd3MsLU5BX3Jvd3NdDQogICAgICAgIA0KICAgICAgICBuZXQyIDwtIG5ldDJbLU5BX3Jvd3MsLU5BX3Jvd3NdDQogICAgICAgIA0KICAgICAgfQ0KICAgIH0NCiAgICANCiAgICB0cmlhZHMgPC0gYygiWDAwMyIsICJYMDEyIiwgIlgxMDIiLCAiWDAyMUQiLCAiWDAyMVUiLCANCiAgICAgICAgICAgICAgICAiWDAyMUMiLCAiWDExMUQiLCAiWDExMVUiLCAiWDAzMFQiLCAiWDAzMEMiLCAiWDIwMSIsIA0KICAgICAgICAgICAgICAgICJYMTIwRCIsICJYMTIwVSIsICJYMTIwQyIsICJYMjEwIiwgIlgzMDAiKQ0KICAgIA0KICAgIGRmIDwtIGZvcmVhY2g6OmZvcmVhY2goYTEgPSAxOm5yb3cobmV0MSksIGkgPSBpdGVyYXRvcnM6Omljb3VudCgpLC5jb21iaW5lID0gInJiaW5kIikgJTolIA0KICAgICAgZm9yZWFjaDo6Zm9yZWFjaChhMiA9IDE6bnJvdyhuZXQxKSwgaiA9IGl0ZXJhdG9yczo6aWNvdW50KCksIC5jb21iaW5lID0gInJiaW5kIikgJTolIA0KICAgICAgZm9yZWFjaDo6Zm9yZWFjaChhMyA9IDE6bnJvdyhuZXQxKSwgayA9IGl0ZXJhdG9yczo6aWNvdW50KCksLmNvbWJpbmUgPSAicmJpbmQiKSAlZG8lIHsNCiAgICAgICAgaWYgKGkgPiBqICYgaiA+IGspIHsNCiAgICAgICAgICBkYXRhLmZyYW1lKGkgPSBpLCBqID0gaiwgayA9IGssIA0KICAgICAgICAgICAgICAgICAgICAgdDFfaWogPSBhcy5jaGFyYWN0ZXIobmV0MVthMSxhMl0pLCB0MV9qaSA9IGFzLmNoYXJhY3RlcihuZXQxW2EyLCBhMV0pLCANCiAgICAgICAgICAgICAgICAgICAgIHQxX2lrID0gYXMuY2hhcmFjdGVyKG5ldDFbYTEsYTNdKSwgdDFfa2kgPSBhcy5jaGFyYWN0ZXIobmV0MVthMywgYTFdKSwgDQogICAgICAgICAgICAgICAgICAgICB0MV9qayA9IGFzLmNoYXJhY3RlcihuZXQxW2EyLGEzXSksIHQxX2tqID0gYXMuY2hhcmFjdGVyKG5ldDFbYTMsIGEyXSksIA0KICAgICAgICAgICAgICAgICAgICAgdHlwZVQxID0gdHJpYWRzW3doaWNoKHNuYTo6dHJpYWQuY2Vuc3VzKG5ldDFbYyhhMSxhMiwgYTMpLCBjKGExLCBhMiwgYTMpXSkgPT0gMSldLCANCiAgICAgICAgICAgICAgICAgICAgIHQyX2lqID0gYXMuY2hhcmFjdGVyKG5ldDJbYTEsIGEyXSksIHQyX2ppID0gYXMuY2hhcmFjdGVyKG5ldDJbYTIsIGExXSksIA0KICAgICAgICAgICAgICAgICAgICAgdDJfaWsgPSBhcy5jaGFyYWN0ZXIobmV0MlthMSwgYTNdKSwgdDJfa2kgPSBhcy5jaGFyYWN0ZXIobmV0MlthMywgYTFdKSwgDQogICAgICAgICAgICAgICAgICAgICB0Ml9qayA9IGFzLmNoYXJhY3RlcihuZXQyW2EyLCBhM10pLCB0Ml9raiA9IGFzLmNoYXJhY3RlcihuZXQyW2EzLCBhMl0pLCANCiAgICAgICAgICAgICAgICAgICAgIHR5cGVUMiA9IHRyaWFkc1t3aGljaChzbmE6OnRyaWFkLmNlbnN1cyhuZXQyW2MoYTEsIGEyLCBhMyksIGMoYTEsIGEyLCBhMyldKSA9PSAxKV0sIA0KICAgICAgICAgICAgICAgICAgICAgdGllX2NoYW5nZSA9IHN1bShjKG5ldDFbYTEsIGEyXSwgbmV0MVthMiwgYTFdLCBuZXQxW2ExLCBhM10sIG5ldDFbYTMsIGExXSwgbmV0MVthMiwgYTNdLCBuZXQxW2EzLCBhMl0pICE9IGMobmV0MlthMSwgYTJdLCBuZXQyW2EyLCBhMV0sIG5ldDJbYTEsIGEzXSwgbmV0MlthMywgYTFdLCBuZXQyW2EyLCBhM10sIG5ldDJbYTMsIGEyXSkpKQ0KICAgICAgICB9DQogICAgICB9DQogICAgDQogICAgDQogICAgZGYkbmFtZSA8LSBwYXN0ZTAoZGYkaSwgIi4iLCBkZiRqLCAiLiIsIGRmJGspDQogICAgZGYgPC0gc3Vic2V0KGRmLCBzZWxlY3QgPSBjKHRpZV9jaGFuZ2UpKQ0KICAgIA0KICAgICMtLS0tICEhTkVXISEgQXNzaWduIGxldmVscyB0byBjb3VudGVyIG1pc3NpbmcgY29sdW1ucyAtLS0tDQogICAgZGYkdGllX2NoYW5nZSA8LSBhcy5mYWN0b3IoZGYkdGllX2NoYW5nZSkNCiAgICBsZXZlbHMoZGYkdGllX2NoYW5nZSkgPC0gYygiMCIsICIxIiwiMiIsICIzIiwiNCIsICI1IiwiNiIpDQogICAgIy0tLS0gRml4ZXMgaXNzdWVzIHdpdGggc2ltdWxhdGVkIG5ldHdvcmtzIC0tLS0NCiAgICANCiAgICBkZiA8LSBkYXRhLmZyYW1lKHNpbW5ldCA9IHgsIHRhYmxlKGRmKSkNCiAgICBkZiA8LSB0aWR5cjo6cGl2b3Rfd2lkZXIoZGYsIG5hbWVzX2Zyb20gPSB0aWVfY2hhbmdlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNfZnJvbSA9IEZyZXEpDQogICAgDQogIH0NCiAgDQogIGRmIDwtIGFzLmRhdGEuZnJhbWUoZGYpDQogIGRmJHR5cGUgPC0gc2ltdHlwZQ0KICANCiAgaWYgKGZvcnBsb3QgPT0gVFJVRSkgew0KICAgIGRmIDwtIHRpZHlyOjpwaXZvdF9sb25nZXIoZGYsIGNvbHMgPSAhYyhzaW1uZXQsIHR5cGUpLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzX3RvID0gIngiLCB2YWx1ZXNfdG8gPSAieSIpDQogIH0NCiAgDQogIHJldHVybihkZikNCiAgDQp9DQoNCmBgYA0KDQojIExvYWQgUGFja2FnZXMNCg0KYGBge3IsIHdhcm5pbmc9RkFMU0V9DQpwYWNrYWdlcyA8LSBjKCJ0aWR5dmVyc2UiLCAic25hIiwgImlncmFwaCIsICJSc2llbmFUd29TdGVwIiwgImFwZSIsICJpdGVyYXRvcnMiLCAiZG9QYXJhbGxlbCIpDQoNCmZwYWNrYWdlLmNoZWNrKHBhY2thZ2VzKQ0KYGBgDQoNCiMgU2V0IHVwIHBhcmFsbGVsIGNsdXN0ZXINCg0KYGBge3J9DQpub19jb3JlcyA8LSBkZXRlY3RDb3JlcygpIC0gMQ0KbXljbCA8LSBtYWtlQ2x1c3RlcihyZXAoImxvY2FsaG9zdCIsIG5vX2NvcmVzKSkNCmNsdXN0ZXJFdmFsUShteWNsLCBsaWJyYXJ5KFJzaWVuYVR3b1N0ZXApKQ0KcmVnaXN0ZXJEb1BhcmFsbGVsKG15Y2wpDQojIHN0b3BDbHVzdGVyKG15Y2wpDQoNCmBgYA0KDQojIExvYWQgRGF0YQ0KDQpgYGB7cn0NCmxvYWQoImRhdGEvcHJvY2Vzc2VkL1JVX1VVX2Vnby5SRGF0YSIpDQoNCmxvYWQoImRhdGEvcHJvY2Vzc2VkL3NvY19kYXRhX3Jhdy5SRGF0YSIpDQpgYGANCg0KPGJyPg0KDQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KIyBOZXR3b3Jrcw0KDQojIyBNYWtlIHRoZSBncmFwaCBvYmplY3QNCg0KYGBge3J9DQoNCiMtLS0tIFdhdmUgMiAtLS0tDQpncmFwaF93MSA8LSBpZ3JhcGg6OmdyYXBoX2Zyb21fYWRqYWNlbmN5X21hdHJpeCgNCiAgc29jX2RhdGEkbmV0c1sxLCxdLCAjbm93LCBJIHRha2UgdGhlIHNlY29uZCB3YXZlDQogIG1vZGUgPSBjKCJkaXJlY3RlZCIpLA0KICB3ZWlnaHRlZCA9IE5VTEwsDQogIGRpYWcgPSBGQUxTRSwNCiAgYWRkLmNvbG5hbWVzID0gTlVMTA0KKQ0KDQojLS0tLSBXYXZlIDIgLS0tLQ0KZ3JhcGhfdzIgPC0gaWdyYXBoOjpncmFwaF9mcm9tX2FkamFjZW5jeV9tYXRyaXgoDQogIHNvY19kYXRhJG5ldHNbMiwsXSwgI25vdywgSSB0YWtlIHRoZSBzZWNvbmQgd2F2ZQ0KICBtb2RlID0gYygiZGlyZWN0ZWQiKSwNCiAgd2VpZ2h0ZWQgPSBOVUxMLA0KICBkaWFnID0gRkFMU0UsDQogIGFkZC5jb2xuYW1lcyA9IE5VTEwNCikNCg0KYGBgDQoNCiMjIE5ldHdvcmsgVmlzdWFsaXNhdGlvbnMNCg0KYGBge3J9DQojIE1ha2UgYSBwbG90YWJsZSBnZW5kZXIgdmFyaWFibGUgdG8gZml4IHByb2JsZW1zIHdpdGggdmVydGV4LnNoYXBlDQpkZl9lZ28gPC0gZGZfZWdvICU+JSBtdXRhdGUocGxvdF9nZW4gPSBjYXNlX3doZW4ocGVyY19mZW1hbGUgPj0gMC44MCB+ICJGZW1hbGUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kZWZhdWx0ID0gIk1hbGUiKSkNCiMgZGZfZWdvICU+JSBjb3VudChwbG90X2dlbikNCmBgYA0KDQojIyBXYXZlIDEgey50YWJzZXR9DQoNCmBgYHtyfQ0KIy0tLS0gRnVsbCBuZXR3b3JrIGluY2x1ZGluZyBJc29sYXRlcyAtLS0tDQpzZXQuc2VlZCgyMzQ1KQ0KbF93MSA8LSBsYXlvdXRfd2l0aF9tZHMoZ3JhcGhfdzEpDQoNCnBsb3QoZ3JhcGhfdzEsIGxheW91dCA9IGxfdzEsDQogICAgIHZlcnRleC5jb2xvciA9IGlmZWxzZShkZl9lZ28kVW5pdmVyc2l0ZWl0MS4yMiA9PSAiUlUiLCAicmVkIiwgImdvbGQiKSwgI25vdywgSSBjYW4gdXNlIGFjdG9yIGF0dHJpYnV0ZXMgZm9yIHBsb3R0aW5nLiANCiAgICAgdmVydGV4LnNoYXBlID0gaWZlbHNlKGRmX2VnbyRwbG90X2dlbiA9PSAiTWFsZSIsICJzcXVhcmUiLCAiY2lyY2xlIiksDQogICAgIHZlcnRleC5zaXplID0gaWdyYXBoOjpkZWdyZWUoZ3JhcGhfdzEsIG1vZGUgPSAiYWxsIikgKiAxLjUsDQogICAgIHZlcnRleC5sYWJlbCA9IE5BLA0KICAgICBlZGdlLndpZHRoID0gLjgsDQogICAgIGVkZ2UuY3VydmVkID0gMC41LA0KICAgICBlZGdlLmFycm93LnNpemUgPTAuMiwNCiAgICAgbWFpbiA9ICJHZW5kZXIgRGlzdHJpYnV0aW9uIG9mIFR3byBTb2Npb2xvZ3kgRGVwYXJ0bWVudHMgMjAyMiIpDQoNCmxlZ2VuZCgidG9wbGVmdCIsIGMoIlJhZGJvdWQiLCAiVXRyZWNodCBVbml2ZXJzaXR5IiwgIk1hbGUiLCAiRmVtYWxlIiksIHBjaCA9IGMoMjEsMjEsMTUsMjApLCBjb2wgPSAiIzc3Nzc3NyIsIHB0LmJnID0gYygicmVkIiwgImdvbGQiKSwgcHQuY2V4ID0gMSwNCiAgICAgICBjZXggPSAwLjgsIGJ0eSA9ICJuIiwgbmNvbCA9IDEpDQoNCiMtLS0tIFJlbW92ZSBJc29sYXRlcyAtLS0tDQpkaWFnKHNvY19kYXRhJG5ldHNbMSwsXSkgPC0gMA0KDQpub2lzb2xhdGVzIDwtIHJvd1N1bXMoc29jX2RhdGEkbmV0c1sxLCxdLCBuYS5ybSA9IFQpID4gMA0KDQpzb2NfdzFfc2VsIDwtIHNvY19kYXRhJG5ldHNbMSwsXVtub2lzb2xhdGVzLCBub2lzb2xhdGVzXQ0KDQpncmFwaF93MV9zZWwgPC0gZ3JhcGhfZnJvbV9hZGphY2VuY3lfbWF0cml4KHNvY193MV9zZWwsIG1vZGUgPSAiZGlyZWN0ZWQiLCB3ZWlnaHRlZCA9IE5VTEwsIGRpYWcgPSBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGQuY29sbmFtZXMgPSBOQSwgYWRkLnJvd25hbWVzID0gTkEpDQoNCmVnb19pc29fdzEgPC0gZGZfZWdvW25vaXNvbGF0ZXMsXQ0KIy0tLS0gR3JhcGggd2l0aG91dCBJc29sYXRlcyAtLS0tDQpzZXQuc2VlZCgyMzQ1KQ0KbF93MSA8LSBsYXlvdXRfd2l0aF9tZHMoZ3JhcGhfdzFfc2VsKQ0KDQpwbG90KGdyYXBoX3cxX3NlbCwgbGF5b3V0ID0gbF93MSwNCiAgICAgdmVydGV4LmNvbG9yID0gaWZlbHNlKGVnb19pc29fdzEkVW5pdmVyc2l0ZWl0MS4yMiA9PSAiUlUiLCAicmVkIiwgImdvbGQiKSwgI25vdywgSSBjYW4gdXNlIGFjdG9yIGF0dHJpYnV0ZXMgZm9yIHBsb3R0aW5nLiANCiAgICAgdmVydGV4LnNoYXBlID0gaWZlbHNlKGVnb19pc29fdzEkcGxvdF9nZW4gPT0gIk1hbGUiLCAic3F1YXJlIiwgImNpcmNsZSIpLA0KICAgICB2ZXJ0ZXguc2l6ZSA9IGlncmFwaDo6ZGVncmVlKGdyYXBoX3cxX3NlbCwgbW9kZSA9ICJhbGwiKSAqIDEuNSwNCiAgICAgdmVydGV4LmxhYmVsID0gTkEsDQogICAgIGVkZ2Uud2lkdGggPSAuOCwNCiAgICAgZWRnZS5jdXJ2ZWQgPSAwLjUsDQogICAgIGVkZ2UuYXJyb3cuc2l6ZSA9MC4yLA0KICAgICBtYWluID0gIkdlbmRlciBEaXN0cmlidXRpb24gb2YgVHdvIFNvY2lvbG9neSBEZXBhcnRtZW50cyAyMDIyIikNCg0KbGVnZW5kKCJ0b3BsZWZ0IiwgYygiUmFkYm91ZCIsICJVdHJlY2h0IFVuaXZlcnNpdHkiLCAiTWFsZSIsICJGZW1hbGUiKSwgcGNoID0gYygyMSwyMSwxNSwyMCksIGNvbCA9ICIjNzc3Nzc3IiwgcHQuYmcgPSBjKCJyZWQiLCAiZ29sZCIpLCBwdC5jZXggPSAxLA0KICAgICAgIGNleCA9IDAuOCwgYnR5ID0gIm4iLCBuY29sID0gMSkNCmBgYA0KDQojIyBXYXZlIDINCg0KYGBge3IsIGZpZy53aWR0aCA9IDh9DQojLS0tLSBGdWxsIG5ldHdvcmsgaW5jbHVkaW5nIElzb2xhdGVzIC0tLS0NCnNldC5zZWVkKDIzNDUpDQpsX3cyIDwtIGxheW91dF9uaWNlbHkoZ3JhcGhfdzIpDQoNCnBsb3QoZ3JhcGhfdzIsIGxheW91dCA9IGxfdzIsDQogICAgIHZlcnRleC5jb2xvciA9IGlmZWxzZShkZl9lZ28kVW5pdmVyc2l0ZWl0MS4yNCA9PSAiUlUiLCAicmVkIiwgImdvbGQiKSwgI25vdywgSSBjYW4gdXNlIGFjdG9yIGF0dHJpYnV0ZXMgZm9yIHBsb3R0aW5nLiANCiAgICAgdmVydGV4LnNoYXBlID0gaWZlbHNlKGRmX2VnbyRwbG90X2dlbiA9PSAiTWFsZSIsICJzcXVhcmUiLCAiY2lyY2xlIiksDQogICAgIHZlcnRleC5zaXplID0gaWdyYXBoOjpkZWdyZWUoZ3JhcGhfdzIsIG1vZGUgPSAiYWxsIikgKiAxLjUsDQogICAgIHZlcnRleC5sYWJlbCA9IE5BLA0KICAgICBlZGdlLndpZHRoID0gMC44LA0KICAgICBlZGdlLmN1cnZlZCA9IDAuNSwNCiAgICAgZWRnZS5hcnJvdy5zaXplID0wLjIsDQogICAgIG1haW4gPSAiR2VuZGVyIERpc3RyaWJ1dGlvbiBvZiBUd28gU29jaW9sb2d5IERlcGFydG1lbnRzIDIwMjIiKQ0KbGVnZW5kKCJ0b3BsZWZ0IiwgYygiUmFkYm91ZCIsICJVdHJlY2h0IFVuaXZlcnNpdHkiLCAiTWFsZSIsICJGZW1hbGUiKSwgcGNoID0gYygyMSwyMSwxNSwyMCksIGNvbCA9ICIjNzc3Nzc3IiwgcHQuYmcgPSBjKCJyZWQiLCAiZ29sZCIpLCBwdC5jZXggPSAxLA0KICAgICAgIGNleCA9IDAuOCwgYnR5ID0gIm4iLCBuY29sID0gMSkNCg0KIy0tLS0gUmVtb3ZlIElzb2xhdGVzIC0tLS0NCmRpYWcoc29jX2RhdGEkbmV0c1syLCxdKSA8LSAwDQoNCm5vaXNvbGF0ZXMgPC0gcm93U3Vtcyhzb2NfZGF0YSRuZXRzWzIsLF0sIG5hLnJtID0gVCkgPiAwDQoNCnNvY193Ml9zZWwgPC0gc29jX2RhdGEkbmV0c1syLCxdW25vaXNvbGF0ZXMsIG5vaXNvbGF0ZXNdDQoNCmdyYXBoX3cyX3NlbCA8LSBncmFwaF9mcm9tX2FkamFjZW5jeV9tYXRyaXgoc29jX3cyX3NlbCwgbW9kZSA9ICJkaXJlY3RlZCIsIHdlaWdodGVkID0gTlVMTCwgZGlhZyA9IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZC5jb2xuYW1lcyA9IE5BLCBhZGQucm93bmFtZXMgPSBOQSkNCg0KZWdvX2lzb193MiA8LSBkZl9lZ29bbm9pc29sYXRlcyxdDQoNCiMtLS0tIEdyYXBoIHdpdGhvdXQgSXNvbGF0ZXMgLS0tLQ0Kc2V0LnNlZWQoMjM0NSkNCmxfdzIgPC0gbGF5b3V0X25pY2VseShncmFwaF93Ml9zZWwpDQoNCnBsb3QoZ3JhcGhfdzJfc2VsLCBsYXlvdXQgPSBsX3cyLA0KICAgICB2ZXJ0ZXguY29sb3IgPSBpZmVsc2UoZWdvX2lzb193MiRVbml2ZXJzaXRlaXQxLjI0ID09ICJSVSIsICJyZWQiLCAiZ29sZCIpLCAjbm93LCBJIGNhbiB1c2UgYWN0b3IgYXR0cmlidXRlcyBmb3IgcGxvdHRpbmcuIA0KICAgICB2ZXJ0ZXguc2hhcGUgPSBpZmVsc2UoZWdvX2lzb193MiRwbG90X2dlbiA9PSAiTWFsZSIsICJzcXVhcmUiLCAiY2lyY2xlIiksDQogICAgIHZlcnRleC5zaXplID0gaWdyYXBoOjpkZWdyZWUoZ3JhcGhfdzJfc2VsLCBtb2RlID0gImFsbCIpICogMS41LA0KICAgICB2ZXJ0ZXgubGFiZWwgPSBOQSwNCiAgICAgZWRnZS53aWR0aCA9IDAuOCwNCiAgICAgZWRnZS5jdXJ2ZWQgPSAwLjUsDQogICAgIGVkZ2UuYXJyb3cuc2l6ZSA9MC4yLA0KICAgICBtYWluID0gIkdlbmRlciBEaXN0cmlidXRpb24gb2YgVHdvIFNvY2lvbG9neSBEZXBhcnRtZW50cyAyMDIyIikNCmxlZ2VuZCgidG9wbGVmdCIsIGMoIlJhZGJvdWQiLCAiVXRyZWNodCBVbml2ZXJzaXR5IiwgIk1hbGUiLCAiRmVtYWxlIiksIHBjaCA9IGMoMjEsMjEsMTUsMjApLCBjb2wgPSAiIzc3Nzc3NyIsIHB0LmJnID0gYygicmVkIiwgImdvbGQiKSwgcHQuY2V4ID0gMSwNCiAgICAgICBjZXggPSAwLjgsIGJ0eSA9ICJuIiwgbmNvbCA9IDEpDQpgYGANCg0KIyMgTmV0d29yayBTdGF0aXN0aWNzDQoNCi0gICBJIGFtIHdvcmtpbmcgb24gbWFraW5nIGEgbmljZSB0YWJsZSB0aGF0IGFkZHMgYWxsIHJlbGV2YW50IGRlc2NyaXB0aXZlIE5ldHdvcmsgU3RhdGlzdGljcw0KICAgIC0gICBKYWNjYXJkDQogICAgLSAgIEhhbW1pbmcNCiAgICAtICAgSW5kZWdyZWVzIGFuZCBvdXRkZWdyZWVzDQogICAgLSAgIE1vcmFuJ3MgSSBmb3IgUHJlc3RpZ2UgKCkNCg0KIyMjIENhbGN1bGF0ZSBOZXR3b3JrIFN0YXRpc3RpY3MNCg0KYGBge3J9DQojLS0tLSBFeHRyYWN0IG5ldHdvcmtzIC0tLS0NCndhdmVfMSA8LSBzb2NfZGF0YSRuZXRzWzEsLF0NCndhdmVfMiA8LSBzb2NfZGF0YSRuZXRzWzIsLF0NCg0KIy0tLS0gSmFjY2FyZCwgSGFtbWluZyAmIERlbnNpdHkgLS0tLQ0KamFjIDwtIGZqYWMod2F2ZV8xLCB3YXZlXzIpDQpoYW0gPC0gZmhhbSh3YXZlXzEsIHdhdmVfMikNCg0KZGVuczEgPC0gZmRlbnMobnJvdyh3YXZlXzEpLHdhdmVfMSkgDQpkZW5zMiA8LSBmZGVucyhucm93KHdhdmVfMiksd2F2ZV8yKQ0KDQojLS0tLSBJbmRlZ3JlZSBkaXN0cmlidXRpb24gLS0tLQ0KaGlzdCh0YWJsZShpZ3JhcGg6OmRlZ3JlZShncmFwaF93MSwgbW9kZSA9ICJpbiIpKSwgYnJlYWtzID0gc2VxKGZyb20gPSAwLCB0byA9IDEwMCwgYnkgPSA1KSx4bGFiPSdpbmRlZ3JlZScsIG1haW49ICdIaXN0b2dyYW0gb2YgaW5kZWdyZWUnKQ0KaGlzdCh0YWJsZShpZ3JhcGg6OmRlZ3JlZShncmFwaF93MiwgbW9kZSA9ICJpbiIpKSwgYnJlYWtzID0gc2VxKGZyb20gPSAwLCB0byA9IDEwMCwgYnkgPSA1KSwgeGxhYj0naW5kZWdyZWUnLCBtYWluPSAnSGlzdG9ncmFtIG9mIGluZGVncmVlJykNCg0KIy0tLS0gT3V0ZGVncmVlIGRpc3RyaWJ1dGlvbiAtLS0tDQpoaXN0KHRhYmxlKGlncmFwaDo6ZGVncmVlKGdyYXBoX3cxLCBtb2RlID0gIm91dCIpKSwgYnJlYWtzID0gc2VxKGZyb20gPSAwLCB0byA9IDEwMCwgYnkgPSAxKSwgeGxhYj0nb3V0ZGVncmVlJywgbWFpbj0gJ0hpc3RvZ3JhbSBvZiBvdXRkZWdyZWUnKQ0KaGlzdCh0YWJsZShpZ3JhcGg6OmRlZ3JlZShncmFwaF93MiwgbW9kZSA9ICJvdXQiKSksIGJyZWFrcyA9IHNlcShmcm9tID0gMCwgdG8gPSAxMDAsIGJ5ID0gMSksIHhsYWI9J291dGRlZ3JlZScsIG1haW49ICdIaXN0b2dyYW0gb2Ygb3V0ZGVncmVlJykNCg0KIy0tLS0gTW9yYW4ncyBJIGZvciBQcmVzdGlnZSAtLS0tDQojIFdhdmUgMQ0KZ2VvZGlzdGFuY2VzIDwtIGdlb2Rpc3Qod2F2ZV8xLCBjb3VudC5wYXRocyA9IFRSVUUpDQpnZW9kaXN0YW5jZXMgPC0gZ2VvZGlzdGFuY2VzJGdkaXN0DQoNCiMgZmlyc3QgZGVmaW5lIGEgbmIgYmFzZWQgb24gZGlzdGFuY2UgMS4NCndlaWdodHMxIDwtIGdlb2Rpc3RhbmNlcyA9PSAxDQoNCk1JX3ByZXNfMSA8LSBmTW9yYW4uSShkZl9lZ28kUTEuVzEsIHNjYWxlZCA9IEZBTFNFLCB3ZWlnaHQgPSB3ZWlnaHRzMSwgbmEucm0gPSBUUlVFLCByb3dzdGFuZGFyZGl6ZSA9IEZBTFNFKQ0KTUlfcHJlc18xDQoNCiMgV2F2ZSAyDQpnZW9kaXN0YW5jZXMgPC0gZ2VvZGlzdCh3YXZlXzIsIGNvdW50LnBhdGhzID0gVFJVRSkNCmdlb2Rpc3RhbmNlcyA8LSBnZW9kaXN0YW5jZXMkZ2Rpc3QNCg0KIyBmaXJzdCBkZWZpbmUgYSBuYiBiYXNlZCBvbiBkaXN0YW5jZSAxLg0Kd2VpZ2h0czEgPC0gZ2VvZGlzdGFuY2VzID09IDENCg0KTUlfcHJlc18yIDwtIGZNb3Jhbi5JKGRmX2VnbyRRMS5XMiwgc2NhbGVkID0gRkFMU0UsIHdlaWdodCA9IHdlaWdodHMxLCBuYS5ybSA9IFRSVUUsIHJvd3N0YW5kYXJkaXplID0gRkFMU0UpDQpNSV9wcmVzXzINCg0KIy0tLS0gTW9yYW4ncyBJIGZvciBnZW5kZXIgLS0tLQ0KIyBXYXZlIDENCmdlb2Rpc3RhbmNlcyA8LSBnZW9kaXN0KHdhdmVfMSwgY291bnQucGF0aHMgPSBUUlVFKQ0KZ2VvZGlzdGFuY2VzIDwtIGdlb2Rpc3RhbmNlcyRnZGlzdA0KDQojIGZpcnN0IGRlZmluZSBhIG5iIGJhc2VkIG9uIGRpc3RhbmNlIDEuDQp3ZWlnaHRzMSA8LSBnZW9kaXN0YW5jZXMgPT0gMQ0KDQpNSV9nZW5fMSA8LSBmTW9yYW4uSShkZl9lZ28kcGVyY19mZW1hbGUsIHNjYWxlZCA9IEZBTFNFLCB3ZWlnaHQgPSB3ZWlnaHRzMSwgbmEucm0gPSBUUlVFLCByb3dzdGFuZGFyZGl6ZSA9IEZBTFNFKQ0KTUlfZ2VuXzENCg0KIyBXYXZlIDINCmdlb2Rpc3RhbmNlcyA8LSBnZW9kaXN0KHdhdmVfMiwgY291bnQucGF0aHMgPSBUUlVFKQ0KZ2VvZGlzdGFuY2VzIDwtIGdlb2Rpc3RhbmNlcyRnZGlzdA0KDQojIGZpcnN0IGRlZmluZSBhIG5iIGJhc2VkIG9uIGRpc3RhbmNlIDEuDQp3ZWlnaHRzMSA8LSBnZW9kaXN0YW5jZXMgPT0gMQ0KDQpNSV9nZW5fMiA8LSBmTW9yYW4uSShkZl9lZ28kcGVyY19mZW1hbGUsIHNjYWxlZCA9IEZBTFNFLCB3ZWlnaHQgPSB3ZWlnaHRzMSwgbmEucm0gPSBUUlVFLCByb3dzdGFuZGFyZGl6ZSA9IEZBTFNFKQ0KTUlfZ2VuXzINCg0KYGBgDQoNCiMjIyBDcmVhdGUgREYNCg0KYGBge3J9DQoNCmRmIDwtIGRhdGEuZnJhbWUoTmV0d29ya19zaXplX1cxID0gbnJvdyh3YXZlXzEpLA0KICAgICAgICAgICAgICAgICBKYWNjYXJkX0luZGV4ID0gcm91bmQoamFjLCBkaWdpdHMgPSAzKSwNCiAgICAgICAgICAgICAgICAgSGFtbWluZ19EaXN0YW5jZSA9IHJvdW5kKGhhbSwgZGlnaXRzID0gMyksDQogICAgICAgICAgICAgICAgIERlbnNpdHlfdzEgPSByb3VuZChkZW5zMSwgZGlnaXRzID0gMyksDQogICAgICAgICAgICAgICAgIERlbnNpdHlfdzIgPSByb3VuZChkZW5zMiwgZGlnaXRzID0gMyksDQogICAgICAgICAgICAgICAgIE1vcmFuSV9wcmVzXzEgPSByb3VuZChNSV9wcmVzXzFbWzFdXSwgZGlnaXRzID0gMyksDQogICAgICAgICAgICAgICAgIE1vcmFuSV9wcmVzXzIgPSByb3VuZChNSV9wcmVzXzJbWzFdXSwgZGlnaXRzID0gMyksDQogICAgICAgICAgICAgICAgIE1vcmFuSV9nZW5kZXJfMSA9IHJvdW5kKE1JX2dlbl8xW1sxXV0sIGRpZ2l0cyA9IDMpLA0KICAgICAgICAgICAgICAgICBNb3JhbklfZ2VuZGVyXzIgPSByb3VuZChNSV9nZW5fMltbMV1dLCBkaWdpdHMgPSAzKSkNCg0Kcm93bmFtZXMoZGYpIDwtIE5VTEwNCg0KYGBgDQoNCiMjIyBBZGQgZGF0YSB0byBhcHBlbmRpeA0KDQpgYGB7cn0NCg0KRFQ6OmRhdGF0YWJsZShkZikNCg0KYGBgDQoNCmBgYHtyfQ0KZnNob3dkZih0c19keWFkc19ldm8od2F2ZV8yLCB3YXZlXzEpKQ0KYGBgDQo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Descriptives.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
